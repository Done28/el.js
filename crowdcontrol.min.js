(function(c){function a(b,e){if({}.hasOwnProperty.call(a.cache,b))return a.cache[b];if(typeof e=='function'){a.load(b,e);return}var d=a.resolve(b);if(!d)throw new Error('Failed to resolve module '+b);var c={id:b,require:a,filename:b,exports:{},loaded:!1,parent:null,children:[]},f=b.slice(0,b.lastIndexOf('/')+1);return a.cache[b]=c.exports,d.call(c.exports,c,c.exports,f,b),c.loaded=!0,a.cache[b]=c.exports}var b={title:'browser',browser:!0,env:{},argv:[],nextTick:function(a){setTimeout(a,0)},cwd:function(){return'/'},chdir:function(){}};a.modules={},a.cache={},a.resolve=function(b){return{}.hasOwnProperty.call(a.modules,b)?a.modules[b]:void 0},a.define=function(b,c){a.modules[b]=c},a.define('underscore/underscore',function(a,b,c,d){(function(){function K(a){function b(e,g,c,f,b,h){for(;b>=0&&b<h;b+=a){var d=f?f[b]:b;c=g(c,e[d],d,e)}return c}return function(d,h,k,l){h=j(h,l,4);var f=!e(d)&&c.keys(d),i=(f||d).length,g=a>0?0:i-1;return arguments.length<3&&(k=d[f?f[g]:g],g+=a),b(d,h,k,f,g,i)}}function O(a){return function(c,e,h){e=d(e,h);var f=g(c),b=a>0?0:f-1;for(;b>=0&&b<f;b+=a)if(e(c[b],b,c))return b;return-1}}function J(a,d,b){return function(j,k,e){var i=0,h=g(j);if(typeof e=='number')a>0?i=e>=0?e:Math.max(e+h,i):h=e>=0?Math.min(e+1,h):e+h+1;else if(b&&e&&h)return e=b(j,k),j[e]===k?e:-1;if(k!==k)return e=d(f.call(j,i,h),c.isNaN),e>=0?e+i:-1;for(e=a>0?i:h-1;e>=0&&e<h;e+=a)if(j[e]===k)return e;return-1}}function F(b,d){var e=y.length,f=b.constructor,g=c.isFunction(f)&&f.prototype||r,a='constructor';c.has(b,a)&&!c.contains(d,a)&&d.push(a);while(e--)a=y[e],a in b&&b[a]!==g[a]&&!c.contains(d,a)&&d.push(a)}var n=this,L=n._,k=Array.prototype,r=Object.prototype,E=Function.prototype,G=k.push,f=k.slice,i=r.toString,I=r.hasOwnProperty,M=Array.isArray,C=Object.keys,s=E.bind,v=Object.create,t=function(){},c=function(a){if(a instanceof c)return a;if(!(this instanceof c))return new c(a);this._wrapped=a};b!==void 0?(a!==void 0&&a.exports&&(b=a.exports=c),b._=c):n._=c,c.VERSION='1.8.3';var j=function(a,b,c){if(b===void 0)return a;switch(c==null?3:c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}},d=function(a,b,d){return a==null?c.identity:c.isFunction(a)?j(a,b,d):c.isObject(a)?c.matcher(a):c.property(a)};c.iteratee=function(a,b){return d(a,b,Infinity)};var p=function(a,b){return function(c){var g=arguments.length;if(g<2||c==null)return c;for(var d=1;d<g;d++){var h=arguments[d],i=a(h),j=i.length;for(var e=0;e<j;e++){var f=i[e];(!b||c[f]===void 0)&&(c[f]=h[f])}}return c}},z=function(a){if(!c.isObject(a))return{};if(v)return v(a);t.prototype=a;var b=new t;return t.prototype=null,b},A=function(a){return function(b){return b==null?void 0:b[a]}},H=Math.pow(2,53)-1,g=A('length'),e=function(b){var a=g(b);return typeof a=='number'&&a>=0&&a<=H};c.each=c.forEach=function(b,d,h){d=j(d,h);var a,f;if(e(b))for(a=0,f=b.length;a<f;a++)d(b[a],a,b);else{var g=c.keys(b);for(a=0,f=g.length;a<f;a++)d(b[g[a]],g[a],b)}return b},c.map=c.collect=function(b,g,k){g=d(g,k);var f=!e(b)&&c.keys(b),h=(f||b).length,i=Array(h);for(var a=0;a<h;a++){var j=f?f[a]:a;i[a]=g(b[j],j,b)}return i},c.reduce=c.foldl=c.inject=K(1),c.reduceRight=c.foldr=K(-1),c.find=c.detect=function(b,d,f){var a;return e(b)?a=c.findIndex(b,d,f):a=c.findKey(b,d,f),a!==void 0&&a!==-1?b[a]:void 0},c.filter=c.select=function(e,a,f){var b=[];return a=d(a,f),c.each(e,function(c,d,e){a(c,d,e)&&b.push(c)}),b},c.reject=function(a,b,e){return c.filter(a,c.negate(d(b)),e)},c.every=c.all=function(a,g,j){g=d(g,j);var f=!e(a)&&c.keys(a),i=(f||a).length;for(var b=0;b<i;b++){var h=f?f[b]:b;if(!g(a[h],h,a))return!1}return!0},c.some=c.any=function(a,g,j){g=d(g,j);var f=!e(a)&&c.keys(a),i=(f||a).length;for(var b=0;b<i;b++){var h=f?f[b]:b;if(g(a[h],h,a))return!0}return!1},c.contains=c.includes=c.include=function(a,d,b,f){return e(a)||(a=c.values(a)),(typeof b!='number'||f)&&(b=0),c.indexOf(a,d,b)>=0},c.invoke=function(e,a){var b=f.call(arguments,2),d=c.isFunction(a);return c.map(e,function(e){var c=d?a:e[a];return c==null?c:c.apply(e,b)})},c.pluck=function(a,b){return c.map(a,c.property(b))},c.where=function(a,b){return c.filter(a,c.matcher(b))},c.findWhere=function(a,b){return c.find(a,c.matcher(b))},c.max=function(a,f,l){var b=-Infinity,i=-Infinity,j,g;if(f==null&&a!=null){a=e(a)?a:c.values(a);for(var h=0,k=a.length;h<k;h++)j=a[h],j>b&&(b=j)}else f=d(f,l),c.each(a,function(a,c,d){g=f(a,c,d),(g>i||g===-Infinity&&b===-Infinity)&&(b=a,i=g)});return b},c.min=function(a,f,l){var b=Infinity,i=Infinity,j,g;if(f==null&&a!=null){a=e(a)?a:c.values(a);for(var h=0,k=a.length;h<k;h++)j=a[h],j<b&&(b=j)}else f=d(f,l),c.each(a,function(a,c,d){g=f(a,c,d),(g<i||g===Infinity&&b===Infinity)&&(b=a,i=g)});return b},c.shuffle=function(f){var g=e(f)?f:c.values(f),h=g.length,b=Array(h);for(var a=0,d;a<h;a++)d=c.random(0,a),d!==a&&(b[a]=b[d]),b[d]=g[a];return b},c.sample=function(a,b,d){return b==null||d?(e(a)||(a=c.values(a)),a[c.random(a.length-1)]):c.shuffle(a).slice(0,Math.max(0,b))},c.sortBy=function(b,a,e){return a=d(a,e),c.pluck(c.map(b,function(b,c,d){return{value:b,index:c,criteria:a(b,c,d)}}).sort(function(c,d){var a=c.criteria,b=d.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1}return c.index-d.index}),'value')};var o=function(a){return function(f,b,g){var e={};return b=d(b,g),c.each(f,function(c,g){var d=b(c,g,f);a(e,c,d)}),e}};c.groupBy=o(function(a,d,b){c.has(a,b)?a[b].push(d):a[b]=[d]}),c.indexBy=o(function(a,b,c){a[c]=b}),c.countBy=o(function(a,d,b){c.has(a,b)?a[b]++:a[b]=1}),c.toArray=function(a){return a?c.isArray(a)?f.call(a):e(a)?c.map(a,c.identity):c.values(a):[]},c.size=function(a){return a==null?0:e(a)?a.length:c.keys(a).length},c.partition=function(f,a,g){a=d(a,g);var b=[],e=[];return c.each(f,function(c,d,f){(a(c,d,f)?b:e).push(c)}),[b,e]},c.first=c.head=c.take=function(a,b,d){return a==null?void 0:b==null||d?a[0]:c.initial(a,a.length-b)},c.initial=function(a,b,c){return f.call(a,0,Math.max(0,a.length-(b==null||c?1:b)))},c.last=function(a,b,d){return a==null?void 0:b==null||d?a[a.length-1]:c.rest(a,Math.max(0,a.length-b))},c.rest=c.tail=c.drop=function(b,a,c){return f.call(b,a==null||c?1:a)},c.compact=function(a){return c.filter(a,c.identity)};var h=function(k,n,m,o){var b=[],f=0;for(var d=o||0,l=g(k);d<l;d++){var a=k[d];if(e(a)&&(c.isArray(a)||c.isArguments(a))){n||(a=h(a,n,m));var i=0,j=a.length;b.length+=j;while(i<j)b[f++]=a[i++]}else m||(b[f++]=a)}return b};c.flatten=function(a,b){return h(a,b,!1)},c.without=function(a){return c.difference(a,f.call(arguments,1))},c.uniq=c.unique=function(k,j,a,l){c.isBoolean(j)||(l=a,a=j,j=!1),a!=null&&(a=d(a,l));var e=[],i=[];for(var f=0,m=g(k);f<m;f++){var b=k[f],h=a?a(b,f,k):b;j?((!f||i!==h)&&e.push(b),i=h):a?c.contains(i,h)||(i.push(h),e.push(b)):c.contains(e,b)||e.push(b)}return e},c.union=function(){return c.uniq(h(arguments,!0,!0))},c.intersection=function(h){var b=[],f=arguments.length;for(var d=0,i=g(h);d<i;d++){var e=h[d];if(c.contains(b,e))continue;for(var a=1;a<f;a++)if(!c.contains(arguments[a],e))break;a===f&&b.push(e)}return b},c.difference=function(b){var a=h(arguments,!0,!0,1);return c.filter(b,function(b){return!c.contains(a,b)})},c.zip=function(){return c.unzip(arguments)},c.unzip=function(b){var d=b&&c.max(b,g).length||0,e=Array(d);for(var a=0;a<d;a++)e[a]=c.pluck(b,a);return e},c.object=function(b,d){var c={};for(var a=0,e=g(b);a<e;a++)d?c[b[a]]=d[a]:c[b[a][0]]=b[a][1];return c},c.findIndex=O(1),c.findLastIndex=O(-1),c.sortedIndex=function(f,i,b,j){b=d(b,j,1);var h=b(i),a=0,c=g(f);while(a<c){var e=Math.floor((a+c)/2);b(f[e])<h?a=e+1:c=e}return a},c.indexOf=J(1,c.findIndex,c.sortedIndex),c.lastIndexOf=J(-1,c.findLastIndex),c.range=function(a,d,b){d==null&&(d=a||0,a=0),b=b||1;var e=Math.max(Math.ceil((d-a)/b),0),f=Array(e);for(var c=0;c<e;c++,a+=b)f[c]=a;return f};var u=function(a,f,g,h,e){if(!(h instanceof f))return a.apply(g,e);var b=z(a.prototype),d=a.apply(b,e);return c.isObject(d)?d:b};c.bind=function(a,e){if(s&&a.bind===s)return s.apply(a,f.call(arguments,1));if(!c.isFunction(a))throw new TypeError('Bind must be called on a function');var d=f.call(arguments,2),b=function(){return u(a,b,e,this,d.concat(f.call(arguments)))};return b},c.partial=function(d){var a=f.call(arguments,1),b=function(){var f=0,h=a.length,g=Array(h);for(var e=0;e<h;e++)g[e]=a[e]===c?arguments[f++]:a[e];while(f<arguments.length)g.push(arguments[f++]);return u(d,b,this,this,g)};return b},c.bindAll=function(a){var b,d=arguments.length,e;if(d<=1)throw new Error('bindAll must be passed function names');for(b=1;b<d;b++)e=arguments[b],a[e]=c.bind(a[e],a);return a},c.memoize=function(d,b){var a=function(g){var e=a.cache,f=''+(b?b.apply(this,arguments):g);return c.has(e,f)||(e[f]=d.apply(this,arguments)),e[f]};return a.cache={},a},c.delay=function(b,c){var a=f.call(arguments,2);return setTimeout(function(){return b.apply(null,a)},c)},c.defer=c.partial(c.delay,c,1),c.throttle=function(h,i,d){var e,f,g,a=null,b=0;d||(d={});var j=function(){b=d.leading===!1?0:c.now(),a=null,g=h.apply(e,f),a||(e=f=null)};return function(){var k=c.now();!b&&d.leading===!1&&(b=k);var l=i-(k-b);return e=this,f=arguments,l<=0||l>i?(a&&(clearTimeout(a),a=null),b=k,g=h.apply(e,f),a||(e=f=null)):!a&&d.trailing!==!1&&(a=setTimeout(j,l)),g}},c.debounce=function(h,e,i){var a,b,d,j,f,g=function(){var k=c.now()-j;k<e&&k>=0?a=setTimeout(g,e-k):(a=null,i||(f=h.apply(d,b),a||(d=b=null)))};return function(){d=this,b=arguments,j=c.now();var k=i&&!a;return a||(a=setTimeout(g,e)),k&&(f=h.apply(d,b),d=b=null),f}},c.wrap=function(a,b){return c.partial(b,a)},c.negate=function(a){return function(){return!a.apply(this,arguments)}},c.compose=function(){var a=arguments,b=a.length-1;return function(){var d=b,c=a[b].apply(this,arguments);while(d--)c=a[d].call(this,c);return c}},c.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},c.before=function(a,b){var c;return function(){return--a>0&&(c=b.apply(this,arguments)),a<=1&&(b=null),c}},c.once=c.partial(c.before,2);var B=!{toString:null}.propertyIsEnumerable('toString'),y=['valueOf','isPrototypeOf','toString','propertyIsEnumerable','hasOwnProperty','toLocaleString'];c.keys=function(a){if(!c.isObject(a))return[];if(C)return C(a);var b=[];for(var d in a)c.has(a,d)&&b.push(d);return B&&F(a,b),b},c.allKeys=function(b){if(!c.isObject(b))return[];var a=[];for(var d in b)a.push(d);return B&&F(b,a),a},c.values=function(f){var b=c.keys(f),d=b.length,e=Array(d);for(var a=0;a<d;a++)e[a]=f[b[a]];return e},c.mapObject=function(e,f,j){f=d(f,j);var g=c.keys(e),i=g.length,h={},a;for(var b=0;b<i;b++)a=g[b],h[a]=f(e[a],a,e);return h},c.pairs=function(f){var b=c.keys(f),d=b.length,e=Array(d);for(var a=0;a<d;a++)e[a]=[b[a],f[b[a]]];return e},c.invert=function(e){var d={},b=c.keys(e);for(var a=0,f=b.length;a<f;a++)d[e[b[a]]]=b[a];return d},c.functions=c.methods=function(d){var a=[];for(var b in d)c.isFunction(d[b])&&a.push(b);return a.sort()},c.extend=p(c.allKeys),c.extendOwn=c.assign=p(c.keys),c.findKey=function(e,f,i){f=d(f,i);var g=c.keys(e),a;for(var b=0,h=g.length;b<h;b++)if(a=g[b],f(e[a],a,e))return a},c.pick=function(m,l,n){var e={},a=m,g,f;if(a==null)return e;c.isFunction(l)?(f=c.allKeys(a),g=j(l,n)):(f=h(arguments,!1,!1,1),g=function(c,a,b){return a in b},a=Object(a));for(var d=0,k=f.length;d<k;d++){var b=f[d],i=a[b];g(i,b,a)&&(e[b]=i)}return e},c.omit=function(d,a,e){if(c.isFunction(a))a=c.negate(a);else{var b=c.map(h(arguments,!1,!1,1),String);a=function(d,a){return!c.contains(b,a)}}return c.pick(d,a,e)},c.defaults=p(c.allKeys,!0),c.create=function(d,b){var a=z(d);return b&&c.extendOwn(a,b),a},c.clone=function(a){return c.isObject(a)?c.isArray(a)?a.slice():c.extend({},a):a},c.tap=function(a,b){return b(a),a},c.isMatch=function(g,h){var d=c.keys(h),e=d.length;if(g==null)return!e;var f=Object(g);for(var a=0;a<e;a++){var b=d[a];if(h[b]!==f[b]||!(b in f))return!1}return!0};var l=function(a,b,e,f){if(a===b)return a!==0||1/a===1/b;if(a==null||b==null)return a===b;a instanceof c&&(a=a._wrapped),b instanceof c&&(b=b._wrapped);var k=i.call(a);if(k!==i.call(b))return!1;switch(k){case'[object RegExp]':case'[object String]':return''+a===''+b;case'[object Number]':return+a!==+a?+b!==+b:+a===0?1/+a===1/b:+a===+b;case'[object Date]':case'[object Boolean]':return+a===+b}var m=k==='[object Array]';if(!m){if(typeof a!='object'||typeof b!='object')return!1;var g=a.constructor,h=b.constructor;if(g!==h&&!(c.isFunction(g)&&g instanceof g&&c.isFunction(h)&&h instanceof h)&&'constructor'in a&&'constructor'in b)return!1}e=e||[],f=f||[];var d=e.length;while(d--)if(e[d]===a)return f[d]===b;if(e.push(a),f.push(b),m){if(d=a.length,d!==b.length)return!1;while(d--)if(!l(a[d],b[d],e,f))return!1}else{var n=c.keys(a),j;if(d=n.length,c.keys(b).length!==d)return!1;while(d--)if(j=n[d],!(c.has(b,j)&&l(a[j],b[j],e,f)))return!1}return e.pop(),f.pop(),!0};c.isEqual=function(a,b){return l(a,b)},c.isEmpty=function(a){return a==null?!0:e(a)&&(c.isArray(a)||c.isString(a)||c.isArguments(a))?a.length===0:c.keys(a).length===0},c.isElement=function(a){return!!(a&&a.nodeType===1)},c.isArray=M||function(a){return i.call(a)==='[object Array]'},c.isObject=function(b){var a=typeof b;return a==='function'||a==='object'&&!!b},c.each(['Arguments','Function','String','Number','Date','RegExp','Error'],function(a){c['is'+a]=function(b){return i.call(b)==='[object '+a+']'}}),c.isArguments(arguments)||(c.isArguments=function(a){return c.has(a,'callee')}),typeof/./!='function'&&typeof Int8Array!='object'&&(c.isFunction=function(a){return typeof a=='function'||!1}),c.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},c.isNaN=function(a){return c.isNumber(a)&&a!==+a},c.isBoolean=function(a){return a===!0||a===!1||i.call(a)==='[object Boolean]'},c.isNull=function(a){return a===null},c.isUndefined=function(a){return a===void 0},c.has=function(a,b){return a!=null&&I.call(a,b)},c.noConflict=function(){return n._=L,this},c.identity=function(a){return a},c.constant=function(a){return function(){return a}},c.noop=function(){},c.property=A,c.propertyOf=function(a){return a==null?function(){}:function(b){return a[b]}},c.matcher=c.matches=function(a){return a=c.extendOwn({},a),function(b){return c.isMatch(b,a)}},c.times=function(d,b,e){var c=Array(Math.max(0,d));b=j(b,e,1);for(var a=0;a<d;a++)c[a]=b(a);return c},c.random=function(a,b){return b==null&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},c.now=Date.now||function(){return new Date().getTime()};var x={'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#x27;','`':'&#x60;'},D=c.invert(x),w=function(b){var d=function(a){return b[a]},a='(?:'+c.keys(b).join('|')+')',e=RegExp(a),f=RegExp(a,'g');return function(a){return a=a==null?'':''+a,e.test(a)?a.replace(f,d):a}};c.escape=w(x),c.unescape=w(D),c.result=function(b,d,e){var a=b==null?void 0:b[d];return a===void 0&&(a=e),c.isFunction(a)?a.call(b):a};var N=0;c.uniqueId=function(b){var a=++N+'';return b?b+a:a},c.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,P={"'":"'",'\\':'\\','\r':'r','\n':'n','\u2028':'u2028','\u2029':'u2029'},Q=/\\|'|\r|\n|\u2028|\u2029/g,R=function(a){return'\\'+P[a]};c.template=function(f,b,g){!b&&g&&(b=g),b=c.defaults({},b,c.templateSettings);var h=RegExp([(b.escape||q).source,(b.interpolate||q).source,(b.evaluate||q).source].join('|')+'|$','g'),d=0,a="__p+='";f.replace(h,function(b,c,e,g,h){return a+=f.slice(d,h).replace(Q,R),d=h+b.length,c?a+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":e?a+="'+\n((__t=("+e+"))==null?'':__t)+\n'":g&&(a+="';\n"+g+"\n__p+='"),b}),a+="';\n",b.variable||(a='with(obj||{}){\n'+a+'}\n'),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+'return __p;\n';try{var i=new Function(b.variable||'obj','_',a)}catch(b){throw b.source=a,b}var e=function(a){return i.call(this,a,c)},j=b.variable||'obj';return e.source='function('+j+'){\n'+a+'}',e},c.chain=function(b){var a=c(b);return a._chain=!0,a};var m=function(b,a){return b._chain?c(a).chain():a};c.mixin=function(a){c.each(c.functions(a),function(b){var d=c[b]=a[b];c.prototype[b]=function(){var a=[this._wrapped];return G.apply(a,arguments),m(this,d.apply(c,a))}})},c.mixin(c),c.each(['pop','push','reverse','shift','sort','splice','unshift'],function(a){var b=k[a];c.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),(a==='shift'||a==='splice')&&c.length===0&&delete c[0],m(this,c)}}),c.each(['concat','join','slice'],function(a){var b=k[a];c.prototype[a]=function(){return m(this,b.apply(this._wrapped,arguments))}}),c.prototype.value=function(){return this._wrapped},c.prototype.valueOf=c.prototype.toJSON=c.prototype.value,c.prototype.toString=function(){return''+this._wrapped},typeof define==='function'&&define.amd&&define('underscore',[],function(){return c})}.call(this))}),a.define('./data',function(c,d,e,f){var b;b=a('./data/policy'),c.exports={Api:a('./data/api'),Source:a('./data/source'),Policy:b.Policy,TabularRestfulStreamingPolicy:b.TabularRestfulStreamingPolicy}}),a.define('./data/policy',function(a,b,c,d){}),a.define('./data/api',function(k,o,m,n){var i,e,b,f,g,h,l,j,d,c;f=a('underscore/underscore'),d=a('./utils'),l=d.shim.promise,c=d.shim.xhr,h=d.log,j=d.shim.requestAnimationFrame,b={every:'every',once:'once'},e=function(){function a(a,b,c){this.type=a,this.fn=b,this.millis=c,this.scheduledTime=f.now()+this.millis,this.kill=!1}return a.prototype.cancel=function(){return this.kill=!0},a}(),g={},i=function(){function a(b,c){var a;this.url=b!=null?b:'',this.token=c!=null?c:'',this.scheduledTasks=[],a=this.url,a[a.length-1]==='/'&&(this.url=a.substring(0,a.length-1))}return a.prototype.scheduledTasks=null,a.prototype.url='',a.prototype.token='',a.get=function(a){return a==null&&(a=''),g[a]},a.prototype.register=function(a){return a==null&&(a=''),g[a]=this},a.prototype.get=function(d,e,a){var b;return a==null&&(a={}),this.token&&(a.Authorization=this.token),b=d,b[0]!=='/'&&(b='/'+d),c({method:'GET',contentType:'application/json',headers:a,url:this.url+b,data:JSON.stringify(e)})},a.prototype.post=function(d,e,a){var b;return a==null&&(a={}),this.token&&(a.Authorization=this.token),b=d,b[0]!=='/'&&(b='/'+d),c({method:'POST',contentType:'application/json',headers:a,url:this.url+b,data:JSON.stringify(e)})},a.prototype.put=function(d,e,a){var b;return a==null&&(a={}),this.token&&(a.Authorization=this.token),b=d,b[0]!=='/'&&(b='/'+d),c({method:'PUT',contentType:'application/json',headers:a,url:this.url+b,data:JSON.stringify(e)})},a.prototype.patch=function(d,e,a){var b;return a==null&&(a={}),this.token&&(a.Authorization=this.token),b=d,b[0]!=='/'&&(b='/'+d),c({method:'PATCH',contentType:'application/json',headers:a,url:this.url+b,data:JSON.stringify(e)})},a.prototype['delete']=function(d,e,a){var b;return a==null&&(a={}),this.token&&(a.Authorization=this.token),b=d,b[0]!=='/'&&(b='/'+d),c({method:'DELETE',contentType:'application/json',headers:a,url:this.url+b,data:JSON.stringify(e)})},a.prototype.scheduleOnce=function(c,d){var a;return a=new e(b.once,c,d),this.scheduledTasks.push(a),this.scheduledTasks.length===1&&this.loop(),a},a.prototype.scheduleEvery=function(d,f,c){var a;return c==null&&(c=!1),a=new e(b.every,d,f),this.scheduledTasks.push(a),this.scheduledTasks.length===1&&this.loop(),c&&(h('API: scheduling for immediate execution'),a=new e(b.once,d,0),this.scheduledTasks.push(a)),a},a.prototype.loop=function(){return this.scheduledTasks.length>0?(h('API: starting loop'),j(function(a){return function(){var e,d,g,c;g=f.now(),e=0,d=a.scheduledTasks.length;while(e<d)c=a.scheduledTasks[e],c.scheduledTime<=g?(c.kill||c.fn(g),c.kill||c.type===b.once?(d--,a.scheduledTasks[e]=a.scheduledTasks[d]):c.type===b.every&&(c.scheduledTime+=c.millis)):e++;return a.scheduledTasks.length=d,d>0?a.loop():void 0}}(this))):void 0},a}(),k.exports=i}),a.define('./utils',function(b,c,d,e){b.exports={shim:a('./utils/shim'),log:a('./utils/log'),mediator:a('./utils/mediator')}}),a.define('./utils/shim',function(d,e,f,g){var b,c;b=a('bluebird/js/browser/bluebird'),c=a('xhr-promise'),Function.prototype.property=function(a,b){return Object.defineProperty(this.prototype,a,b)},b['new']=function(a){return new b(a)},d.exports={observable:function(a){return this.riot.observable(a)},requestAnimationFrame:a('raf'),riot:typeof window!=='undefined'&&window!==null&&window.riot!=null?window.riot:void 0,xhr:function(b){var a;return a=new c,a.send.apply(a,arguments)},promise:b}}),a.define('bluebird/js/browser/bluebird',function(a,d,e,f){!function(e,b){'object'==typeof d&&void 0!==a?a.exports=e():'function'==typeof define&&define.amd?define([],e):('undefined'!=typeof window?b=window:void 0!==c?b=c:'undefined'!=typeof self&&(b=self),b.Promise=e())}(function(){return function a(b,c,e){function f(d,k){if(!c[d]){if(!b[d]){var i=typeof _dereq_=='function'&&_dereq_;if(!k&&i)return i(d,!0);if(g)return g(d,!0);var j=new Error("Cannot find module '"+d+"'");throw j.code='MODULE_NOT_FOUND',j}var h=c[d]={exports:{}};b[d][0].call(h.exports,function(c){var a=b[d][1][c];return f(a?a:c)},h,h.exports,a,b,c,e)}return c[d].exports}var g=typeof _dereq_=='function'&&_dereq_;for(var d=0;d<e.length;d++)f(e[d]);return f}({1:[function(b,a,c){'use strict';a.exports=function(a){function b(d){var a=new c(d),b=a.promise();return a.setHowMany(1),a.setUnwrap(),a.init(),b}var c=a._SomePromiseArray;a.any=function(a){return b(a)},a.prototype.any=function(){return b(this)}}},{}],2:[function(e,f,k){'use strict';function a(){this._isTickUsed=!1,this._lateQueue=new d(16),this._normalQueue=new d(16),this._trampolineEnabled=!0;var a=this;this.drainQueues=function(){a._drainQueues()},this._schedule=b.isStatic?b(this.drainQueues):b}function i(a,b,c){this._lateQueue.push(a,b,c),this._queueTick()}function j(a,b,c){this._normalQueue.push(a,b,c),this._queueTick()}function h(a){this._normalQueue._pushOne(a),this._queueTick()}var g;try{throw new Error}catch(a){g=a}var b=e('./schedule.js'),d=e('./queue.js'),c=e('./util.js');a.prototype.disableTrampolineIfNecessary=function(){c.hasDevTools&&(this._trampolineEnabled=!1)},a.prototype.enableTrampoline=function(){this._trampolineEnabled||(this._trampolineEnabled=!0,this._schedule=function(a){setTimeout(a,0)})},a.prototype.haveItemsQueued=function(){return this._normalQueue.length()>0},a.prototype.throwLater=function(a,b){if(arguments.length===1&&(b=a,a=function(){throw b}),typeof setTimeout!=='undefined')setTimeout(function(){a(b)},0);else try{this._schedule(function(){a(b)})}catch(a){throw new Error('No async scheduler available\n\n    See http://goo.gl/m3OTXk\n')}},c.hasDevTools,b.isStatic&&(b=function(a){setTimeout(a,0)}),a.prototype.invokeLater=function(a,b,c){this._trampolineEnabled?i.call(this,a,b,c):this._schedule(function(){setTimeout(function(){a.call(b,c)},100)})},a.prototype.invoke=function(a,b,c){this._trampolineEnabled?j.call(this,a,b,c):this._schedule(function(){a.call(b,c)})},a.prototype.settlePromises=function(a){this._trampolineEnabled?h.call(this,a):this._schedule(function(){a._settlePromises()})},a.prototype.invokeFirst=function(a,b,c){this._normalQueue.unshift(a,b,c),this._queueTick()},a.prototype._drainQueue=function(a){while(a.length()>0){var b=a.shift();if(typeof b!=='function'){b._settlePromises();continue}var c=a.shift(),d=a.shift();b.call(c,d)}},a.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._drainQueue(this._lateQueue)},a.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},a.prototype._reset=function(){this._isTickUsed=!1},f.exports=new a,f.exports.firstLineError=g},{'./queue.js':28,'./schedule.js':31,'./util.js':38}],3:[function(b,a,c){'use strict';a.exports=function(a,b,d){var c=function(b,a){this._reject(a)},e=function(b,a){a.promiseRejectionQueued=!0,a.bindingPromise._then(c,c,null,this,b)},f=function(b,a){this._isPending()&&this._resolveCallback(a.target)},g=function(a,b){b.promiseRejectionQueued||this._reject(a)};a.prototype.bind=function(k){var h=d(k),c=new a(b);c._propagateFrom(this,1);var i=this._target();if(c._setBoundTo(h),h instanceof a){var j={promiseRejectionQueued:!1,promise:c,target:i,bindingPromise:h};i._then(b,e,c._progress,c,j),h._then(f,g,c._progress,c,j)}else c._resolveCallback(i);return c},a.prototype._setBoundTo=function(a){a!==undefined?(this._bitField=this._bitField|131072,this._boundTo=a):this._bitField=this._bitField&-131073},a.prototype._isBound=function(){return(this._bitField&131072)===131072},a.bind=function(g,f){var e=d(g),c=new a(b);return c._setBoundTo(e),e instanceof a?e._then(function(){c._resolveCallback(f)},c._reject,c._progress,c,null):c._resolveCallback(f),c}}},{}],4:[function(c,d,f){'use strict';function e(){try{Promise===a&&(Promise=b)}catch(a){}return a}var b;typeof Promise!=='undefined'&&(b=Promise);var a=c('./promise.js')();a.noConflict=e,d.exports=a},{'./promise.js':23}],5:[function(d,e,f){'use strict';var a=Object.create;if(a){var b=a(null),c=a(null);b[' size']=c[' size']=0}e.exports=function(b){function f(c,e){var d;if(c!=null&&(d=c[e]),typeof d!=='function'){var f='Object '+a.classString(c)+" has no method '"+a.toString(e)+"'";throw new b.TypeError(f)}return d}function g(a){var b=this.pop(),c=f(a,b);return c.apply(a,this)}function c(a){return a[this]}function h(b){var a=+this;return a<0&&(a=Math.max(0,a+b.length)),b[a]}var a=d('./util.js'),e=a.canEvaluate,i=a.isIdentifier,j;b.prototype.call=function(d){var c=arguments.length,b=new Array(c-1);for(var a=1;a<c;++a)b[a-1]=arguments[a];return b.push(d),this._then(g,undefined,undefined,b,undefined)},b.prototype.get=function(b){var f=typeof b==='number',a;if(!f)if(e){var d=j(b);a=d!==null?d:c}else a=c;else a=h;return this._then(a,undefined,undefined,b,undefined)}}},{'./util.js':38}],6:[function(a,b,c){'use strict';b.exports=function(b){var d=a('./errors.js'),c=a('./async.js'),e=d.CancellationError;b.prototype._cancel=function(c){if(!this.isCancellable())return this;var b,a=this;while((b=a._cancellationParent)!==undefined&&b.isCancellable())a=b;this._unsetCancellable(),a._target()._rejectCallback(c,!1,!0)},b.prototype.cancel=function(a){return this.isCancellable()?(a===undefined&&(a=new e),c.invokeLater(this._cancel,this,a),this):this},b.prototype.cancellable=function(){return this._cancellable()?this:(c.enableTrampoline(),this._setCancellable(),this._cancellationParent=undefined,this)},b.prototype.uncancellable=function(){var a=this.then();return a._unsetCancellable(),a},b.prototype.fork=function(b,c,d){var a=this._then(b,c,d,undefined,undefined);return a._setCancellable(),a._cancellationParent=undefined,a}}},{'./async.js':2,'./errors.js':13}],7:[function(a,c,d){'use strict';c.exports=function(){function c(a){this._parent=a;var b=this._length=a===undefined?1:1+a._length;m(this,c),b>32&&this.uncycle()}function w(c,b){for(var a=0;a<b.length-1;++a)b[a].push('From previous event:'),b[a]=b[a].join('\n');return a<b.length&&(b[a]=b[a].join('\n')),c+'\n'+b.join('\n')}function v(b){for(var a=0;a<b.length;++a)(b[a].length===0||a+1<b.length&&b[a][0]===b[a+1][0])&&(b.splice(a,1),a--)}function u(f){var b=f[0];for(var d=1;d<f.length;++d){var c=f[d],e=b.length-1,h=b[e],g=-1;for(var a=c.length-1;a>=0;--a)if(c[a]===h){g=a;break}for(var a=g;a>=0;--a){var i=c[a];if(b[e]===i)b.pop(),e--;else break}b=c}}function p(e){var c=[];for(var b=0;b<e.length;++b){var a=e[b],d=f.test(a)||'    (No stack trace)'===a,g=d&&h(a);d&&!g&&(n&&a.charAt(0)!==' '&&(a='    '+a),c.push(a))}return c}function t(d){var a=d.stack.replace(/\s+$/g,'').split('\n');for(var b=0;b<a.length;++b){var c=a[b];if('    (No stack trace)'===c||f.test(c))break}return b>0&&(a=a.slice(b)),a}function r(b){var a;if(typeof b==='function')a='[function '+(b.name||'anonymous')+']';else{a=b.toString();var c=/\[object [a-zA-Z0-9$_]+\]/;if(c.test(a))try{var d=JSON.stringify(b);a=d}catch(a){}a.length===0&&(a='(empty array)')}return'(<'+s(a)+'>, no stack trace)'}function s(a){var b=41;return a.length<b?a:a.substr(0,b-3)+'...'}function l(b){var a=b.match(o);return a?{fileName:a[1],line:parseInt(a[2],10)}:void 0}var i=a('./async.js'),d=a('./util.js'),k=/[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/,f=null,e=null,n=!1,g;d.inherits(c,Error),c.prototype.uncycle=function(){var e=this._length;if(e<2)return;var b=[],h={};for(var a=0,f=this;f!==undefined;++a)b.push(f),f=f._parent;e=this._length=a;for(var a=e-1;a>=0;--a){var i=b[a].stack;h[i]===undefined&&(h[i]=a)}for(var a=0;a<e;++a){var k=b[a].stack,c=h[k];if(c!==undefined&&c!==a){c>0&&(b[c-1]._parent=undefined,b[c-1]._length=1),b[a]._parent=undefined,b[a]._length=1;var d=a>0?b[a-1]:this;c<e-1?(d._parent=b[c+1],d._parent.uncycle(),d._length=d._parent._length+1):(d._parent=undefined,d._length=1);var j=d._length+1;for(var g=a-2;g>=0;--g)b[g]._length=j,j++;return}}},c.prototype.parent=function(){return this._parent},c.prototype.hasParent=function(){return this._parent!==undefined},c.prototype.attachExtraTrace=function(e){if(e.__stackCleaned__)return;this.uncycle();var f=c.parseStackAndMessage(e),g=f.message,a=[f.stack],b=this;while(b!==undefined)a.push(p(b.stack.split('\n'))),b=b._parent;u(a),v(a),d.notEnumerableProp(e,'stack',w(g,a)),d.notEnumerableProp(e,'__stackCleaned__',!0)},c.parseStackAndMessage=function(b){var a=b.stack,c=b.toString();return a=typeof a==='string'&&a.length>0?t(b):['    (No stack trace)'],{message:c,stack:p(a)}},c.formatAndLogError=function(a,c){if(typeof console!=='undefined'){var b;if(typeof a==='object'||typeof a==='function'){var d=a.stack;b=c+e(d,a)}else b=c+String(a);typeof g==='function'?g(b):(typeof console.log==='function'||typeof console.log==='object')&&console.log(b)}},c.unhandledRejection=function(a){c.formatAndLogError(a,'^--- With additional stack trace: ')},c.isSupported=function(){return typeof m==='function'},c.fireRejectionEvent=function(a,g,b,d){var h=!1;try{typeof g==='function'&&(h=!0,a==='rejectionHandled'?g(d):g(b,d))}catch(a){i.throwLater(a)}var e=!1;try{e=q(a,b,d)}catch(a){e=!0,i.throwLater(a)}var f=!1;if(j)try{f=j(a.toLowerCase(),{reason:b,promise:d})}catch(a){f=!0,i.throwLater(a)}!(e||h||f)&&a==='unhandledRejection'&&c.formatAndLogError(b,'Unhandled rejection ')};var h=function(){return!1},o=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;c.setBounds=function(m,n){if(!c.isSupported())return;var i=m.stack.split('\n'),g=n.stack.split('\n'),d=-1,e=-1,f,j;for(var b=0;b<i.length;++b){var a=l(i[b]);if(a){f=a.fileName,d=a.line;break}}for(var b=0;b<g.length;++b){var a=l(g[b]);if(a){j=a.fileName,e=a.line;break}}if(d<0||e<0||!f||!j||f!==j||d>=e)return;h=function(b){if(k.test(b))return!0;var a=l(b);return a&&a.fileName===f&&d<=a.line&&a.line<=e?!0:!1}};var m=function a(){var d=/^\s*at\s*/,b=function(b,a){return typeof b==='string'?b:a.name!==undefined&&a.message!==undefined?a.toString():r(a)};if(typeof Error.stackTraceLimit==='number'&&typeof Error.captureStackTrace==='function'){Error.stackTraceLimit=Error.stackTraceLimit+6,f=d,e=b;var g=Error.captureStackTrace;return h=function(a){return k.test(a)},function(a,b){Error.stackTraceLimit=Error.stackTraceLimit+6,g(a,b),Error.stackTraceLimit=Error.stackTraceLimit-6}}var c=new Error;if(typeof c.stack==='string'&&c.stack.split('\n')[0].indexOf('stackDetection@')>=0)return f=/@/,e=b,n=!0,function a(b){b.stack=new Error().stack};var i;try{throw new Error}catch(a){i='stack'in a}return!('stack'in c)&&i&&typeof Error.stackTraceLimit==='number'?(f=d,e=b,function a(b){Error.stackTraceLimit=Error.stackTraceLimit+6;try{throw new Error}catch(a){b.stack=a.stack}}):(e=function(b,a){return typeof b==='string'?b:(typeof a==='object'||typeof a==='function')&&a.name!==undefined&&a.message!==undefined?a.toString():r(a)},null)}([]),j,q=function(a,e,g,f,c){if(d.isNode)return function(a,d,c){return a==='rejectionHandled'?b.emit(a,c):b.emit(a,d,c)};else{a=!1,e=!0;try{g=new self.CustomEvent('test'),a=g instanceof CustomEvent}catch(a){}if(!a)try{f=document.createEvent('CustomEvent'),f.initCustomEvent('testingtheevent',!1,!0,{}),self.dispatchEvent(f)}catch(a){e=!1}return e&&(j=function(c,d){var b;return a?b=new self.CustomEvent(c,{detail:d,bubbles:!1,cancelable:!0}):self.dispatchEvent&&(b=document.createEvent('CustomEvent'),b.initCustomEvent(c,!1,!0,d)),b?!self.dispatchEvent(b):!1}),c={},c.unhandledRejection='onunhandledRejection'.toLowerCase(),c.rejectionHandled='onrejectionHandled'.toLowerCase(),function(b,f,d){var e=c[b],a=self[e];return a?(b==='rejectionHandled'?a.call(self,d):a.call(self,f,d),!0):!1}}}();return typeof console!=='undefined'&&console.warn!==void 0&&(g=function(a){console.warn(a)},d.isNode&&b.stderr.isTTY?g=function(a){b.stderr.write('[31m'+a+'[39m\n')}:!d.isNode&&typeof new Error().stack==='string'&&(g=function(a){console.warn('%c'+a,'color: red')})),c}},{'./async.js':2,'./util.js':38}],8:[function(a,b,c){'use strict';b.exports=function(c){function f(a,b,c){this._instances=a,this._callback=b,this._promise=c}function j(f,g){var c={},a=d(f).call(c,g);if(a===b)return a;var e=h(c);return e.length?(b.e=new i('Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n'),b):a}var e=a('./util.js'),g=a('./errors.js'),d=e.tryCatch,b=e.errorObj,h=a('./es5.js').keys,i=g.TypeError;return f.prototype.doFilter=function(f){var i=this._callback,n=this._promise,h=n._boundValue();for(var g=0,m=this._instances.length;g<m;++g){var e=this._instances[g],k=e===Error||e!=null&&e.prototype instanceof Error;if(k&&f instanceof e){var a=d(i).call(h,f);return a===b?(c.e=a.e,c):a}if(typeof e==='function'&&!k){var l=j(e,f);if(l===b){f=b.e;break}if(l){var a=d(i).call(h,f);return a===b?(c.e=a.e,c):a}}}return c.e=f,c},f}},{'./errors.js':13,'./es5.js':14,'./util.js':38}],9:[function(b,a,c){'use strict';a.exports=function(c,f,d){function a(){this._trace=new f(e())}function g(){return d()?new a:void 0}function e(){var a=b.length-1;return a>=0?b[a]:undefined}var b=[];return a.prototype._pushContext=function(){if(!d())return;this._trace!==undefined&&b.push(this._trace)},a.prototype._popContext=function(){if(!d())return;this._trace!==undefined&&b.pop()},c.prototype._peekContext=e,c.prototype._pushContext=a.prototype._pushContext,c.prototype._popContext=a.prototype._popContext,g}},{}],10:[function(a,c,d){'use strict';c.exports=function(c,e){var h=c._getDomain,f=a('./async.js'),i=a('./errors.js').Warning,g=a('./util.js'),j=g.canAttachTrace,k,l,d=g.isNode&&(!!b.env.BLUEBIRD_DEBUG||b.env.NODE_ENV==='development');return d&&f.disableTrampolineIfNecessary(),c.prototype._ignoreRejections=function(){this._unsetRejectionIsUnhandled(),this._bitField=this._bitField|16777216},c.prototype._ensurePossibleRejectionHandled=function(){if((this._bitField&16777216)!==0)return;this._setRejectionIsUnhandled(),f.invokeLater(this._notifyUnhandledRejection,this,undefined)},c.prototype._notifyUnhandledRejectionIsHandled=function(){e.fireRejectionEvent('rejectionHandled',k,undefined,this)},c.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var a=this._getCarriedStackTrace()||this._settledValue;this._setUnhandledRejectionIsNotified(),e.fireRejectionEvent('unhandledRejection',l,a,this)}},c.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=this._bitField|524288},c.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-524289},c.prototype._isUnhandledRejectionNotified=function(){return(this._bitField&524288)>0},c.prototype._setRejectionIsUnhandled=function(){this._bitField=this._bitField|2097152},c.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&-2097153,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},c.prototype._isRejectionUnhandled=function(){return(this._bitField&2097152)>0},c.prototype._setCarriedStackTrace=function(a){this._bitField=this._bitField|1048576,this._fulfillmentHandler0=a},c.prototype._isCarryingStackTrace=function(){return(this._bitField&1048576)>0},c.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:undefined},c.prototype._captureStackTrace=function(){return d&&(this._trace=new e(this._peekContext())),this},c.prototype._attachExtraTrace=function(a,f){if(d&&j(a)){var b=this._trace;if(b!==undefined&&f&&(b=b._parent),b!==undefined)b.attachExtraTrace(a);else if(!a.__stackCleaned__){var c=e.parseStackAndMessage(a);g.notEnumerableProp(a,'stack',c.message+'\n'+c.stack.join('\n')),g.notEnumerableProp(a,'__stackCleaned__',!0)}}},c.prototype._warn=function(d){var a=new i(d),b=this._peekContext();if(b)b.attachExtraTrace(a);else{var c=e.parseStackAndMessage(a);a.stack=c.message+'\n'+c.stack.join('\n')}e.formatAndLogError(a,'')},c.onPossiblyUnhandledRejection=function(a){var b=h();l=typeof a==='function'?b===null?a:b.bind(a):undefined},c.onUnhandledRejectionHandled=function(a){var b=h();k=typeof a==='function'?b===null?a:b.bind(a):undefined},c.longStackTraces=function(){if(f.haveItemsQueued()&&d===!1)throw new Error('cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/DT1qyG\n');d=e.isSupported(),d&&f.disableTrampolineIfNecessary()},c.hasLongStackTraces=function(){return d&&e.isSupported()},e.isSupported()||(c.longStackTraces=function(){},d=!1),function(){return d}}},{'./async.js':2,'./errors.js':13,'./util.js':38}],11:[function(c,d,e){'use strict';var b=c('./util.js'),a=b.isPrimitive;d.exports=function(b){var d=function(){return this},e=function(){throw this},f=function(){},g=function(){throw undefined},c=function(a,b){return b===1?function(){throw a}:b===2?function(){return a}:void 0};b.prototype['return']=b.prototype.thenReturn=function(b){return b===undefined?this.then(f):a(b)?this._then(c(b,2),undefined,undefined,undefined,undefined):this._then(d,undefined,undefined,b,undefined)},b.prototype['throw']=b.prototype.thenThrow=function(b){return b===undefined?this.then(g):a(b)?this._then(c(b,1),undefined,undefined,undefined,undefined):this._then(e,undefined,undefined,b,undefined)}}},{'./util.js':38}],12:[function(b,a,c){'use strict';a.exports=function(a,c){var b=a.reduce;a.prototype.each=function(a){return b(this,a,null,c)},a.each=function(a,d){return b(a,d,null,c)}}},{}],13:[function(n,s,t){'use strict';function e(c,d){function b(e){if(!(this instanceof b))return new b(e);a(this,'message',typeof e==='string'?e:d),a(this,'name',c),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return i(b,Error),b}function h(b){if(!(this instanceof h))return new h(b);a(this,'name','OperationalError'),a(this,'message',b),this.cause=b,this.isOperational=!0,b instanceof Error?(a(this,'message',b.message),a(this,'stack',b.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}var l=n('./es5.js'),r=l.freeze,j=n('./util.js'),i=j.inherits,a=j.notEnumerableProp,m,k,o=e('Warning','warning'),p=e('CancellationError','cancellation error'),q=e('TimeoutError','timeout error'),d=e('AggregateError','aggregate error');try{m=TypeError,k=RangeError}catch(a){m=e('TypeError','type error'),k=e('RangeError','range error')}var f='join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse'.split(' ');for(var c=0;c<f.length;++c)typeof Array.prototype[f[c]]==='function'&&(d.prototype[f[c]]=Array.prototype[f[c]]);l.defineProperty(d.prototype,'length',{value:0,configurable:!1,writable:!0,enumerable:!0}),d.prototype.isOperational=!0;var g=0;d.prototype.toString=function(){var d=Array(g*4+1).join(' '),f='\n'+d+'AggregateError of:'+'\n';g++,d=Array(g*4+1).join(' ');for(var a=0;a<this.length;++a){var e=this[a]===this?'[Circular AggregateError]':this[a]+'',b=e.split('\n');for(var c=0;c<b.length;++c)b[c]=d+b[c];e=b.join('\n'),f+=e+'\n'}return g--,f},i(h,Error);var b=Error.__BluebirdErrorTypes__;b||(b=r({CancellationError:p,TimeoutError:q,OperationalError:h,RejectionError:h,AggregateError:d}),a(Error,'__BluebirdErrorTypes__',b)),s.exports={Error:Error,TypeError:m,RangeError:k,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:o}},{'./es5.js':14,'./util.js':38}],14:[function(l,i,m){var a=function(){'use strict';return this===undefined}();if(a)i.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:a,propertyIsWritable:function(b,c){var a=Object.getOwnPropertyDescriptor(b,c);return!!(!a||a.writable||a.set)}};else{var f={}.hasOwnProperty,g={}.toString,c={}.constructor.prototype,b=function(c){var a=[];for(var b in c)f.call(c,b)&&a.push(b);return a},j=function(a,b){return{value:a[b]}},k=function(a,b,c){return a[b]=c.value,a},h=function(a){return a},d=function(a){try{return Object(a).constructor.prototype}catch(a){return c}},e=function(a){try{return g.call(a)==='[object Array]'}catch(a){return!1}};i.exports={isArray:e,keys:b,names:b,defineProperty:k,getDescriptor:j,freeze:h,getPrototypeOf:d,isES5:a,propertyIsWritable:function(){return!0}}}},{}],15:[function(b,a,c){'use strict';a.exports=function(a,c){var b=a.map;a.prototype.filter=function(a,d){return b(this,a,d,c)},a.filter=function(a,d,e){return b(a,d,e,c)}}},{}],16:[function(a,b,c){'use strict';b.exports=function(b,e,f){function j(){return this}function k(){throw this}function m(a){return function(){return a}}function n(a){return function(){throw a}}function g(e,a,c){var b;return i(a)?b=c?m(a):n(a):b=c?j:k,e._then(b,d,undefined,a,undefined)}function h(d){var a=this.promise,h=this.handler,i=a._isBound()?h.call(a._boundValue()):h();if(i!==undefined){var c=f(i,a);if(c instanceof b)return c=c._target(),g(c,d,a.isFulfilled())}return a.isRejected()?(e.e=d,e):d}function l(c){var d=this.promise,e=this.handler,h=d._isBound()?e.call(d._boundValue(),c):e(c);if(h!==undefined){var a=f(h,d);if(a instanceof b)return a=a._target(),g(a,c,!0)}return c}var c=a('./util.js'),i=c.isPrimitive,d=c.thrower;b.prototype._passThroughHandler=function(a,b){if(typeof a!=='function')return this.then();var c={promise:this,handler:a};return this._then(b?h:l,b?h:undefined,undefined,c,undefined)},b.prototype.lastly=b.prototype['finally']=function(a){return this._passThroughHandler(a,!0)},b.prototype.tap=function(a){return this._passThroughHandler(a,!1)}}},{'./util.js':38}],17:[function(a,b,c){'use strict';b.exports=function(b,m,l,j){function k(k,h,a){for(var c=0;c<h.length;++c){a._pushContext();var f=d(h[c])(k);if(a._popContext(),f===e){a._pushContext();var i=b.reject(e.e);return a._popContext(),i}var g=j(f,a);if(g instanceof b)return g}return null}function c(d,e,a,f){var c=this._promise=new b(l);c._captureStackTrace(),this._stack=f,this._generatorFunction=d,this._receiver=e,this._generator=undefined,this._yieldHandlers=typeof a==='function'?[a].concat(g):g}var i=a('./errors.js'),f=i.TypeError,h=a('./util.js'),e=h.errorObj,d=h.tryCatch,g=[];c.prototype.promise=function(){return this._promise},c.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=undefined,this._next(undefined)},c.prototype._continue=function(c){if(c===e)return this._promise._rejectCallback(c.e,!1,!0);var d=c.value;if(c.done===!0)this._promise._resolveCallback(d);else{var a=j(d,this._promise);if(!(a instanceof b)&&(a=k(a,this._yieldHandlers,this._promise),a===null)){this._throw(new f('A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/4Y4pDk\n\n'.replace('%s',d)+'From coroutine:\n'+this._stack.split('\n').slice(1,-7).join('\n')));return}a._then(this._next,this._throw,undefined,this,null)}},c.prototype._throw=function(a){this._promise._attachExtraTrace(a),this._promise._pushContext();var b=d(this._generator['throw']).call(this._generator,a);this._promise._popContext(),this._continue(b)},c.prototype._next=function(b){this._promise._pushContext();var a=d(this._generator.next).call(this._generator,b);this._promise._popContext(),this._continue(a)},b.coroutine=function(a,g){if(typeof a!=='function')throw new f('generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n');var b=Object(g).yieldHandler,d=c,e=new Error().stack;return function(){var f=a.apply(this,arguments),c=new d(undefined,undefined,b,e);return c._generator=f,c._next(undefined),c.promise()}},b.coroutine.addYieldHandler=function(a){if(typeof a!=='function')throw new f('fn must be a function\n\n    See http://goo.gl/916lJJ\n');g.push(a)},b.spawn=function(d){if(typeof d!=='function')return m('generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n');var a=new c(d,this),e=a.promise();return a._run(b.spawn),e}}},{'./errors.js':13,'./util.js':38}],18:[function(a,b,c){'use strict';b.exports=function(c,d,i,j){var b=a('./util.js'),e=b.canEvaluate,f=b.tryCatch,g=b.errorObj,h,h;c.join=function(){var b=arguments.length-1,c,e;b>0&&typeof arguments[b]==='function'&&(c=arguments[b],!1);var g=arguments.length,f=new Array(g);for(var a=0;a<g;++a)f[a]=arguments[a];c&&f.pop();var e=new d(f).promise();return c!==undefined?e.spread(c):e}}},{'./util.js':38}],19:[function(a,b,c){'use strict';b.exports=function(d,p,i,o,n){function b(d,b,c,e){this.constructor$(d),this._promise._captureStackTrace();var a=k();this._callback=a===null?b:a.bind(b),this._preservedValues=e===n?new Array(this.length()):null,this._limit=c,this._inFlight=0,this._queue=c>=1?[]:h,l.invoke(m,this,undefined)}function m(){this._init$(undefined,-2)}function f(d,e,c,f){var a=typeof c==='object'&&c!==null?c.concurrency:0;return a=typeof a==='number'&&isFinite(a)&&a>=1?a:0,new b(d,e,a,f)}var k=d._getDomain,l=a('./async.js'),c=a('./util.js'),g=c.tryCatch,j=c.errorObj,e={},h=[];c.inherits(b,p),b.prototype._init=function(){},b.prototype._promiseFulfilled=function(k,a){var c=this._values,l=this.length(),i=this._preservedValues,h=this._limit;if(c[a]===e){if(c[a]=k,h>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return}else{if(h>=1&&this._inFlight>=h){c[a]=k,this._queue.push(a);return}i!==null&&(i[a]=k);var p=this._callback,m=this._promise._boundValue();this._promise._pushContext();var f=g(p).call(m,k,a,l);if(this._promise._popContext(),f===j)return this._reject(f.e);var b=o(f,this._promise);if(b instanceof d){if(b=b._target(),b._isPending())return h>=1&&this._inFlight++,c[a]=e,b._proxyPromiseArray(this,a);if(!b._isFulfilled())return this._reject(b._reason());f=b._value()}c[a]=f}var n=++this._totalResolved;n>=l&&(i!==null?this._filter(c,i):this._resolve(c))},b.prototype._drainQueue=function(){var a=this._queue,c=this._limit,d=this._values;while(a.length>0&&this._inFlight<c){if(this._isResolved())return;var b=a.pop();this._promiseFulfilled(d[b],b)}},b.prototype._filter=function(f,e){var c=e.length,b=new Array(c),d=0;for(var a=0;a<c;++a)f[a]&&(b[d++]=e[a]);b.length=d,this._resolve(b)},b.prototype.preservedValues=function(){return this._preservedValues},d.prototype.map=function(a,b){return typeof a!=='function'?i('fn must be a function\n\n    See http://goo.gl/916lJJ\n'):f(this,a,b,null).promise()},d.map=function(b,a,c,d){return typeof a!=='function'?i('fn must be a function\n\n    See http://goo.gl/916lJJ\n'):f(b,a,c,d).promise()}}},{'./async.js':2,'./util.js':38}],20:[function(a,b,c){'use strict';b.exports=function(b,e,g,f){var c=a('./util.js'),d=c.tryCatch;b.method=function(a){if(typeof a!=='function')throw new b.TypeError('fn must be a function\n\n    See http://goo.gl/916lJJ\n');return function(){var c=new b(e);c._captureStackTrace(),c._pushContext();var f=d(a).apply(this,arguments);return c._popContext(),c._resolveFromSyncValue(f),c}},b.attempt=b['try']=function(g,h,i){if(typeof g!=='function')return f('fn must be a function\n\n    See http://goo.gl/916lJJ\n');var a=new b(e);a._captureStackTrace(),a._pushContext();var j=c.isArray(h)?d(g).apply(i,h):d(g).call(i,h);return a._popContext(),a._resolveFromSyncValue(j),a},b.prototype._resolveFromSyncValue=function(a){a===c.errorObj?this._rejectCallback(a.e,!1,!0):this._resolveCallback(a,!0)}}},{'./util.js':38}],21:[function(a,b,c){'use strict';b.exports=function(f){function h(a,i){var f=this;if(!c.isArray(a))return g.call(f,a,i);var h=b(i).apply(f._boundValue(),[null].concat(a));h===e&&d.throwLater(h.e)}function g(f,g){var h=this,a=h._boundValue(),c=f===undefined?b(g).call(a,null):b(g).call(a,null,f);c===e&&d.throwLater(c.e)}function i(a,i){var c=this;if(!a){var h=c._target(),f=h._getCarriedStackTrace();f.cause=a,a=f}var g=b(i).call(c._boundValue(),a);g===e&&d.throwLater(g.e)}var c=a('./util.js'),d=a('./async.js'),b=c.tryCatch,e=c.errorObj;f.prototype.asCallback=f.prototype.nodeify=function(b,c){if(typeof b=='function'){var a=g;c!==undefined&&Object(c).spread&&(a=h),this._then(a,i,undefined,this,b)}return this}}},{'./async.js':2,'./util.js':38}],22:[function(a,b,c){'use strict';b.exports=function(b,g){var c=a('./util.js'),d=a('./async.js'),e=c.tryCatch,f=c.errorObj;b.prototype.progressed=function(a){return this._then(undefined,undefined,a,undefined,undefined)},b.prototype._progress=function(a){if(this._isFollowingOrFulfilledOrRejected())return;this._target()._progressUnchecked(a)},b.prototype._progressHandlerAt=function(a){return a===0?this._progressHandler0:this[(a<<2)+a-5+2]},b.prototype._doProgressWith=function(g){var h=g.value,i=g.handler,d=g.promise,j=g.receiver,a=e(i).call(j,h);if(a===f){if(a.e!=null&&a.e.name!=='StopProgressPropagation'){var k=c.canAttachTrace(a.e)?a.e:new Error(c.toString(a.e));d._attachExtraTrace(k),d._progress(a.e)}}else a instanceof b?a._then(d._progress,null,null,d,undefined):d._progress(a)},b.prototype._progressUnchecked=function(h){var i=this._length(),j=this._progress;for(var a=0;a<i;a++){var e=this._progressHandlerAt(a),c=this._promiseAt(a);if(!(c instanceof b)){var f=this._receiverAt(a);typeof e==='function'?e.call(f,h,c):f instanceof g&&!f._isResolved()&&f._promiseProgressed(h,c);continue}typeof e==='function'?d.invoke(this._doProgressWith,this,{handler:e,promise:c,receiver:this._receiverAt(a),value:h}):d.invoke(j,c,h)}}}},{'./async.js':2,'./util.js':38}],23:[function(a,c,d){'use strict';c.exports=function(){function c(a){if(typeof a!=='function')throw new l('the promise constructor requires a resolver function\n\n    See http://goo.gl/EC22Yn\n');if(this.constructor!==c)throw new l('the promise constructor cannot be invoked directly\n\n    See http://goo.gl/KsIlge\n');this._bitField=0,this._fulfillmentHandler0=undefined,this._rejectionHandler0=undefined,this._progressHandler0=undefined,this._promise0=undefined,this._receiver0=undefined,this._settledValue=undefined,a!==d&&this._resolveFromResolver(a)}function k(b){var a=new c(d);a._fulfillmentHandler0=b,a._rejectionHandler0=b,a._progressHandler0=b,a._promise0=b,a._receiver0=b,a._settledValue=b}var m=function(){return new l('circular promise resolution chain\n\n    See http://goo.gl/LhFpo0\n')},s=function(){return new c.PromiseInspection(this._target())},h=function(a){return c.reject(new l(a))},e=a('./util.js'),q;e.isNode?q=function(){var a=b.domain;return a===undefined&&(a=null),a}:q=function(){return null},e.notEnumerableProp(c,'_getDomain',q);var i=a('./async.js'),j=a('./errors.js'),l=c.TypeError=j.TypeError;c.RangeError=j.RangeError,c.CancellationError=j.CancellationError,c.TimeoutError=j.TimeoutError,c.OperationalError=j.OperationalError,c.RejectionError=j.OperationalError,c.AggregateError=j.AggregateError;var d=function(){},u={},p={e:null},f=a('./thenables.js')(c,d),g=a('./promise_array.js')(c,d,f,h),n=a('./captured_trace.js')(),t=a('./debuggability.js')(c,n),y=a('./context.js')(c,n,t),w=a('./catch_filter.js')(p),v=a('./promise_resolver.js'),x=v._nodebackForPromise,r=e.errorObj,o=e.tryCatch;return c.prototype.toString=function(){return'[object Promise]'},c.prototype.caught=c.prototype['catch']=function(e){var b=arguments.length;if(b>1){var d=new Array(b-1),f=0,a;for(a=0;a<b-1;++a){var g=arguments[a];if(!(typeof g==='function'))return c.reject(new l('Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n'));d[f++]=g}d.length=f,e=arguments[a];var h=new w(d,e,this);return this._then(undefined,h.doFilter,undefined,h,undefined)}return this._then(undefined,e,undefined,undefined,undefined)},c.prototype.reflect=function(){return this._then(s,s,undefined,this,undefined)},c.prototype.then=function(a,b,d){if(t()&&arguments.length>0&&typeof a!=='function'&&typeof b!=='function'){var c='.then() only accepts functions but was passed: '+e.classString(a);arguments.length>1&&(c+=', '+e.classString(b)),this._warn(c)}return this._then(a,b,d,undefined,undefined)},c.prototype.done=function(b,c,d){var a=this._then(b,c,d,undefined,undefined);a._setIsFinal()},c.prototype.spread=function(a,b){return this.all()._then(a,b,undefined,u,undefined)},c.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},c.prototype.toJSON=function(){var a={isFulfilled:!1,isRejected:!1,fulfillmentValue:undefined,rejectionReason:undefined};return this.isFulfilled()?(a.fulfillmentValue=this.value(),a.isFulfilled=!0):this.isRejected()&&(a.rejectionReason=this.reason(),a.isRejected=!0),a},c.prototype.all=function(){return new g(this).promise()},c.prototype.error=function(a){return this.caught(e.originatesFromRejection,a)},c.is=function(a){return a instanceof c},c.fromNode=function(e){var a=new c(d),b=o(e)(x(a));return b===r&&a._rejectCallback(b.e,!0,!0),a},c.all=function(a){return new g(a).promise()},c.defer=c.pending=function(){var a=new c(d);return new v(a)},c.cast=function(e){var a=f(e);if(!(a instanceof c)){var b=a;a=new c(d),a._fulfillUnchecked(b)}return a},c.resolve=c.fulfilled=c.cast,c.reject=c.rejected=function(b){var a=new c(d);return a._captureStackTrace(),a._rejectCallback(b,!0),a},c.setScheduler=function(a){if(typeof a!=='function')throw new l('fn must be a function\n\n    See http://goo.gl/916lJJ\n');var b=i._schedule;return i._schedule=a,b},c.prototype._then=function(j,k,l,f,g){var e=g!==undefined,b=e?g:new c(d);e||(b._propagateFrom(this,5),b._captureStackTrace());var a=this._target();a!==this&&(f===undefined&&(f=this._boundTo),e||b._setIsMigrated());var h=a._addCallbacks(j,k,l,b,f,q());return a._isResolved()&&!a._isSettlePromisesQueued()&&i.invoke(a._settlePromiseAtPostResolution,a,h),b},c.prototype._settlePromiseAtPostResolution=function(a){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),this._settlePromiseAt(a)},c.prototype._length=function(){return this._bitField&131071},c.prototype._isFollowingOrFulfilledOrRejected=function(){return(this._bitField&939524096)>0},c.prototype._isFollowing=function(){return(this._bitField&536870912)===536870912},c.prototype._setLength=function(a){this._bitField=this._bitField&-131072|a&131071},c.prototype._setFulfilled=function(){this._bitField=this._bitField|268435456},c.prototype._setRejected=function(){this._bitField=this._bitField|134217728},c.prototype._setFollowing=function(){this._bitField=this._bitField|536870912},c.prototype._setIsFinal=function(){this._bitField=this._bitField|33554432},c.prototype._isFinal=function(){return(this._bitField&33554432)>0},c.prototype._cancellable=function(){return(this._bitField&67108864)>0},c.prototype._setCancellable=function(){this._bitField=this._bitField|67108864},c.prototype._unsetCancellable=function(){this._bitField=this._bitField&-67108865},c.prototype._setIsMigrated=function(){this._bitField=this._bitField|4194304},c.prototype._unsetIsMigrated=function(){this._bitField=this._bitField&-4194305},c.prototype._isMigrated=function(){return(this._bitField&4194304)>0},c.prototype._receiverAt=function(b){var a=b===0?this._receiver0:this[b*5-5+4];return a===undefined&&this._isBound()?this._boundValue():a},c.prototype._promiseAt=function(a){return a===0?this._promise0:this[a*5-5+3]},c.prototype._fulfillmentHandlerAt=function(a){return a===0?this._fulfillmentHandler0:this[a*5-5+0]},c.prototype._rejectionHandlerAt=function(a){return a===0?this._rejectionHandler0:this[a*5-5+1]},c.prototype._boundValue=function(){var a=this._boundTo;return a!==undefined&&a instanceof c?a.isFulfilled()?a.value():undefined:a},c.prototype._migrateCallbacks=function(a,b){var e=a._fulfillmentHandlerAt(b),f=a._rejectionHandlerAt(b),g=a._progressHandlerAt(b),d=a._promiseAt(b),h=a._receiverAt(b);d instanceof c&&d._setIsMigrated(),this._addCallbacks(e,f,g,d,h,null)},c.prototype._addCallbacks=function(c,d,e,h,g,a){var b=this._length();if(b>=131066&&(b=0,this._setLength(0)),b===0)this._promise0=h,g!==undefined&&(this._receiver0=g),typeof c==='function'&&!this._isCarryingStackTrace()&&(this._fulfillmentHandler0=a===null?c:a.bind(c)),typeof d==='function'&&(this._rejectionHandler0=a===null?d:a.bind(d)),typeof e==='function'&&(this._progressHandler0=a===null?e:a.bind(e));else{var f=b*5-5;this[f+3]=h,this[f+4]=g,typeof c==='function'&&(this[f+0]=a===null?c:a.bind(c)),typeof d==='function'&&(this[f+1]=a===null?d:a.bind(d)),typeof e==='function'&&(this[f+2]=a===null?e:a.bind(e))}return this._setLength(b+1),b},c.prototype._setProxyHandlers=function(c,d){var a=this._length();if(a>=131066&&(a=0,this._setLength(0)),a===0)this._promise0=d,this._receiver0=c;else{var b=a*5-5;this[b+3]=d,this[b+4]=c}this._setLength(a+1)},c.prototype._proxyPromiseArray=function(a,b){this._setProxyHandlers(a,b)},c.prototype._resolveCallback=function(e,i){if(this._isFollowingOrFulfilledOrRejected())return;if(e===this)return this._rejectCallback(m(),!1,!0);var b=f(e,this);if(!(b instanceof c))return this._fulfill(e);var g=i?5:1;this._propagateFrom(b,g);var a=b._target();if(a._isPending()){var h=this._length();for(var d=0;d<h;++d)a._migrateCallbacks(this,d);this._setFollowing(),this._setLength(0),this._setFollowee(a)}else a._isFulfilled()?this._fulfillUnchecked(a._value()):this._rejectUnchecked(a._reason(),a._getCarriedStackTrace())},c.prototype._rejectCallback=function(a,d,f){f||e.markAsOriginatingFromRejection(a);var b=e.ensureErrorObject(a),c=b===a;this._attachExtraTrace(b,d?c:!1),this._reject(a,c?undefined:b)},c.prototype._resolveFromResolver=function(d){var a=this;this._captureStackTrace(),this._pushContext();var c=!0,b=o(d)(function(b){if(a===null)return;a._resolveCallback(b),a=null},function(b){if(a===null)return;a._rejectCallback(b,c),a=null});c=!1,this._popContext(),b!==undefined&&b===r&&a!==null&&(a._rejectCallback(b.e,!0,!0),a=null)},c.prototype._settlePromiseFromHandler=function(c,d,e,b){if(b._isRejected())return;b._pushContext();var a;if(d===u&&!this._isRejected()?a=o(c).apply(this._boundValue(),e):a=o(c).call(d,e),b._popContext(),a===r||a===b||a===p){var f=a===b?m():a.e;b._rejectCallback(f,!1,!0)}else b._resolveCallback(a)},c.prototype._target=function(){var a=this;while(a._isFollowing())a=a._followee();return a},c.prototype._followee=function(){return this._rejectionHandler0},c.prototype._setFollowee=function(a){this._rejectionHandler0=a},c.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=undefined)},c.prototype._propagateFrom=function(a,b){(b&1)>0&&a._cancellable()&&(this._setCancellable(),this._cancellationParent=a),(b&4)>0&&a._isBound()&&this._setBoundTo(a._boundTo)},c.prototype._fulfill=function(a){if(this._isFollowingOrFulfilledOrRejected())return;this._fulfillUnchecked(a)},c.prototype._reject=function(a,b){if(this._isFollowingOrFulfilledOrRejected())return;this._rejectUnchecked(a,b)},c.prototype._settlePromiseAt=function(b){var a=this._promiseAt(b),f=a instanceof c;if(f&&a._isMigrated())return a._unsetIsMigrated(),i.invoke(this._settlePromiseAt,this,b);var h=this._isFulfilled()?this._fulfillmentHandlerAt(b):this._rejectionHandlerAt(b),j=this._isCarryingStackTrace()?this._getCarriedStackTrace():undefined,d=this._settledValue,e=this._receiverAt(b);this._clearCallbackDataAtIndex(b),typeof h==='function'?f?this._settlePromiseFromHandler(h,e,d,a):h.call(e,d,a):e instanceof g?e._isResolved()||(this._isFulfilled()?e._promiseFulfilled(d,a):e._promiseRejected(d,a)):f&&(this._isFulfilled()?a._fulfill(d):a._reject(d,j)),b>=4&&(b&31)===4&&i.invokeLater(this._setLength,this,0)},c.prototype._clearCallbackDataAtIndex=function(b){if(b===0)this._isCarryingStackTrace()||(this._fulfillmentHandler0=undefined),this._rejectionHandler0=this._progressHandler0=this._receiver0=this._promise0=undefined;else{var a=b*5-5;this[a+3]=this[a+4]=this[a+0]=this[a+1]=this[a+2]=undefined}},c.prototype._isSettlePromisesQueued=function(){return(this._bitField&-1073741824)===-1073741824},c.prototype._setSettlePromisesQueued=function(){this._bitField=this._bitField|-1073741824},c.prototype._unsetSettlePromisesQueued=function(){this._bitField=this._bitField&1073741823},c.prototype._queueSettlePromises=function(){i.settlePromises(this),this._setSettlePromisesQueued()},c.prototype._fulfillUnchecked=function(b){if(b===this){var a=m();return this._attachExtraTrace(a),this._rejectUnchecked(a,undefined)}this._setFulfilled(),this._settledValue=b,this._cleanValues(),this._length()>0&&this._queueSettlePromises()},c.prototype._rejectUncheckedCheckError=function(a){var b=e.ensureErrorObject(a);this._rejectUnchecked(a,b===a?undefined:b)},c.prototype._rejectUnchecked=function(b,a){if(b===this){var c=m();return this._attachExtraTrace(c),this._rejectUnchecked(c)}if(this._setRejected(),this._settledValue=b,this._cleanValues(),this._isFinal()){i.throwLater(function(a){throw'stack'in a&&i.invokeFirst(n.unhandledRejection,undefined,a),a},a===undefined?b:a);return}a!==undefined&&a!==b&&this._setCarriedStackTrace(a),this._length()>0?this._queueSettlePromises():this._ensurePossibleRejectionHandled()},c.prototype._settlePromises=function(){this._unsetSettlePromisesQueued();var b=this._length();for(var a=0;a<b;a++)this._settlePromiseAt(a)},e.notEnumerableProp(c,'_makeSelfResolutionError',m),a('./progress.js')(c,g),a('./method.js')(c,d,f,h),a('./bind.js')(c,d,f),a('./finally.js')(c,p,f),a('./direct_resolve.js')(c),a('./synchronous_inspection.js')(c),a('./join.js')(c,g,f,d),c.Promise=c,a('./map.js')(c,g,h,f,d),a('./cancel.js')(c),a('./using.js')(c,h,f,y),a('./generators.js')(c,h,d,f),a('./nodeify.js')(c),a('./call_get.js')(c),a('./props.js')(c,g,f,h),a('./race.js')(c,d,f,h),a('./reduce.js')(c,g,h,f,d),a('./settle.js')(c,g),a('./some.js')(c,g,h),a('./promisify.js')(c,d),a('./any.js')(c),a('./each.js')(c,d),a('./timers.js')(c,d),a('./filter.js')(c,d),e.toFastProperties(c),e.toFastProperties(c.prototype),k({a:1}),k({b:2}),k({c:3}),k(1),k(function(){}),k(undefined),k(!1),k(new c(d)),n.setBounds(i.firstLineError,e.lastLineError),c}},{'./any.js':1,'./async.js':2,'./bind.js':3,'./call_get.js':5,'./cancel.js':6,'./captured_trace.js':7,'./catch_filter.js':8,'./context.js':9,'./debuggability.js':10,'./direct_resolve.js':11,'./each.js':12,'./errors.js':13,'./filter.js':15,'./finally.js':16,'./generators.js':17,'./join.js':18,'./map.js':19,'./method.js':20,'./nodeify.js':21,'./progress.js':22,'./promise_array.js':24,'./promise_resolver.js':25,'./promisify.js':26,'./props.js':27,'./race.js':29,'./reduce.js':30,'./settle.js':32,'./some.js':33,'./synchronous_inspection.js':34,'./thenables.js':35,'./timers.js':36,'./using.js':37,'./util.js':38}],24:[function(a,b,c){'use strict';b.exports=function(c,g,e,h){function i(a){switch(a){case-2:return[];case-3:return{}}}function b(a){var b=this._promise=new c(g),d;a instanceof c&&(d=a,b._propagateFrom(d,5)),this._values=a,this._length=0,this._totalResolved=0,this._init(undefined,-2)}var f=a('./util.js'),d=f.isArray;return b.prototype.length=function(){return this._length},b.prototype.promise=function(){return this._promise},b.prototype._init=function a(o,k){var b=e(this._values,this._promise);if(b instanceof c){if(b=b._target(),this._values=b,!b._isFulfilled())if(b._isPending()){b._then(a,this._reject,undefined,this,k);return}else{this._reject(b._reason());return}if(b=b._value(),!d(b)){var m=new c.TypeError('expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n');this.__hardReject__(m);return}}else if(!d(b)){this._promise._reject(h('expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n')._reason());return}if(b.length===0){k===-5?this._resolveEmptyArray():this._resolve(i(k));return}var j=this.getActualLength(b.length);this._length=j,this._values=this.shouldCopyValues()?new Array(j):this._values;var n=this._promise;for(var g=0;g<j;++g){var l=this._isResolved(),f=e(b[g],n);f instanceof c?(f=f._target(),l?f._ignoreRejections():f._isPending()?f._proxyPromiseArray(this,g):f._isFulfilled()?this._promiseFulfilled(f._value(),g):this._promiseRejected(f._reason(),g)):l||this._promiseFulfilled(f,g)}},b.prototype._isResolved=function(){return this._values===null},b.prototype._resolve=function(a){this._values=null,this._promise._fulfill(a)},b.prototype.__hardReject__=b.prototype._reject=function(a){this._values=null,this._promise._rejectCallback(a,!1,!0)},b.prototype._promiseProgressed=function(a,b){this._promise._progress({index:b,value:a})},b.prototype._promiseFulfilled=function(b,c){this._values[c]=b;var a=++this._totalResolved;a>=this._length&&this._resolve(this._values)},b.prototype._promiseRejected=function(a,b){this._totalResolved++,this._reject(a)},b.prototype.shouldCopyValues=function(){return!0},b.prototype.getActualLength=function(a){return a},b}},{'./util.js':38}],25:[function(g,o,p){'use strict';function n(a){return a instanceof Error&&b.getPrototypeOf(a)===Error.prototype}function m(a){var d;if(n(a)){d=new l(a),d.name=a.name,d.message=a.message,d.stack=a.stack;var g=b.keys(a);for(var e=0;e<g.length;++e){var f=g[e];j.test(f)||(d[f]=a[f])}return d}return c.markAsOriginatingFromRejection(a),a}function f(a){return function(f,g){if(a===null)return;if(f){var c=m(i(f));a._attachExtraTrace(c),a._reject(c)}else if(arguments.length>2){var d=arguments.length,e=new Array(d-1);for(var b=1;b<d;++b)e[b-1]=arguments[b];a._fulfill(e)}else a._fulfill(g);a=null}}var c=g('./util.js'),i=c.maybeWrapAsError,h=g('./errors.js'),k=h.TimeoutError,l=h.OperationalError,e=c.haveGetters,b=g('./es5.js'),j=/^(?:name|message|stack|cause)$/,a;if(e?a=function(a){this.promise=a}:a=function(a){this.promise=a,this.asCallback=f(a),this.callback=this.asCallback},e){var d={get:function(){return f(this.promise)}};b.defineProperty(a.prototype,'asCallback',d),b.defineProperty(a.prototype,'callback',d)}a._nodebackForPromise=f,a.prototype.toString=function(){return'[object PromiseResolver]'},a.prototype.resolve=a.prototype.fulfill=function(b){if(!(this instanceof a))throw new TypeError('Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n');this.promise._resolveCallback(b)},a.prototype.reject=function(b){if(!(this instanceof a))throw new TypeError('Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n');this.promise._rejectCallback(b)},a.prototype.progress=function(b){if(!(this instanceof a))throw new TypeError('Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n');this.promise._progress(b)},a.prototype.cancel=function(a){this.promise.cancel(a)},a.prototype.timeout=function(){this.reject(new k('timeout'))},a.prototype.isResolved=function(){return this.promise.isResolved()},a.prototype.toJSON=function(){return this.promise.toJSON()},o.exports=a},{'./errors.js':13,'./es5.js':14,'./util.js':38}],26:[function(a,b,c){'use strict';b.exports=function(i,y){function x(a){return!m.test(a)}function g(a){try{return a.__isPromisified__===!0}catch(a){return!1}}function w(c,d,e){var a=b.getDataPropertyOrDefault(c,d+e,o);return a?g(a):!1}function v(a,h,e){for(var b=0;b<a.length;b+=2){var d=a[b];if(e.test(d)){var g=d.replace(e,'');for(var c=0;c<a.length;c+=2)if(a[c]===g)throw new f("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/iWrZbw\n".replace('%s',h))}}}function u(d,l,m,k){var i=b.inheritedDataKeys(d),f=[];for(var h=0;h<i.length;++h){var c=i[h],a=d[c],j=k===e?!0:e(c,a,d);typeof a==='function'&&!g(a)&&!w(d,c,l)&&k(c,a,d,j)&&f.push(c,a)}return v(f,l,m),f}function t(c,e,j,h){function f(){var f=e;e===d&&(f=this);var b=new i(y);b._captureStackTrace();var h=typeof a==='string'&&this!==g?this[a]:c,j=k(b);try{h.apply(f,p(arguments,j))}catch(a){b._rejectCallback(q(a),!0,!0)}return b}var g=function(){return this}(),a=c;return typeof a==='string'&&(c=h),b.notEnumerableProp(f,'__isPromisified__',!0),f}function h(i,e,o,k){var n=new RegExp(l(e)+'$'),g=u(i,e,n,o);for(var f=0,m=g.length;f<m;f+=2){var a=g[f],h=g[f+1],j=a+e;i[j]=k===c?c(a,d,a,h,e):k(h,function(){return c(a,d,a,h,e)})}return b.toFastProperties(i),i}function s(a,b){return c(a,b,undefined,a)}var d={},b=a('./util.js'),k=a('./promise_resolver.js')._nodebackForPromise,p=b.withAppended,q=b.maybeWrapAsError,r=b.canEvaluate,f=a('./errors').TypeError,j='Async',o={__isPromisified__:!0},n=['arity','length','name','arguments','caller','callee','prototype','__isPromisified__'],m=new RegExp('^(?:'+n.join('|')+')$'),e=function(a){return b.isIdentifier(a)&&a.charAt(0)!=='_'&&a!=='constructor'},l=function(a){return a.replace(/([$])/,'\\$')},z,c=r?z:t;i.promisify=function(a,e){if(typeof a!=='function')throw new f('fn must be a function\n\n    See http://goo.gl/916lJJ\n');if(g(a))return a;var c=s(a,arguments.length<2?d:e);return b.copyDescriptors(a,c,x),c},i.promisifyAll=function(i,k){if(typeof i!=='function'&&typeof i!=='object')throw new f('the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/9ITlV0\n');k=Object(k);var a=k.suffix;typeof a!=='string'&&(a=j);var d=k.filter;typeof d!=='function'&&(d=e);var g=k.promisifier;if(typeof g!=='function'&&(g=c),!b.isIdentifier(a))throw new RangeError('suffix must be a valid identifier\n\n    See http://goo.gl/8FZo5V\n');var m=b.inheritedDataKeys(i);for(var l=0;l<m.length;++l){var n=i[m[l]];m[l]!=='constructor'&&b.isClass(n)&&(h(n.prototype,a,d,g),h(n,a,d,g))}return h(i,a,d,g)}}},{'./errors':13,'./promise_resolver.js':25,'./util.js':38}],27:[function(a,b,c){'use strict';b.exports=function(c,h,i,j){function b(f){var d=g.keys(f),b=d.length,c=new Array(b*2);for(var a=0;a<b;++a){var e=d[a];c[a]=f[e],c[a+b]=e}this.constructor$(c)}function e(e){var d,a=i(e);return f(a)?(a instanceof c?d=a._then(c.props,undefined,undefined,undefined,undefined):d=new b(a).promise(),a instanceof c&&d._propagateFrom(a,4),d):j('cannot await properties of a non-object\n\n    See http://goo.gl/OsFKC8\n')}var d=a('./util.js'),f=d.isObject,g=a('./es5.js');d.inherits(b,h),b.prototype._init=function(){this._init$(undefined,-3)},b.prototype._promiseFulfilled=function(f,g){this._values[g]=f;var c=++this._totalResolved;if(c>=this._length){var b={},d=this.length();for(var a=0,e=this.length();a<e;++a)b[this._values[a+d]]=this._values[a];this._resolve(b)}},b.prototype._promiseProgressed=function(a,b){this._promise._progress({key:this._values[b+this.length()],value:a})},b.prototype.shouldCopyValues=function(){return!1},b.prototype.getActualLength=function(a){return a>>1},c.prototype.props=function(){return e(this)},c.props=function(a){return e(a)}}},{'./es5.js':14,'./util.js':38}],28:[function(d,b,e){'use strict';function c(b,c,d,e,f){for(var a=0;a<f;++a)d[a+e]=b[a+c],b[a+c]=void 0}function a(a){this._capacity=a,this._length=0,this._front=0}a.prototype._willBeOverCapacity=function(a){return this._capacity<a},a.prototype._pushOne=function(c){var a=this.length();this._checkCapacity(a+1);var b=this._front+a&this._capacity-1;this[b]=c,this._length=a+1},a.prototype._unshiftOne=function(d){var a=this._capacity;this._checkCapacity(this.length()+1);var c=this._front,b=(c-1&a-1^a)-a;this[b]=d,this._front=b,this._length=this.length()+1},a.prototype.unshift=function(a,b,c){this._unshiftOne(c),this._unshiftOne(b),this._unshiftOne(a)},a.prototype.push=function(d,e,f){var a=this.length()+3;if(this._willBeOverCapacity(a)){this._pushOne(d),this._pushOne(e),this._pushOne(f);return}var b=this._front+a-3;this._checkCapacity(a);var c=this._capacity-1;this[b+0&c]=d,this[b+1&c]=e,this[b+2&c]=f,this._length=a},a.prototype.shift=function(){var a=this._front,b=this[a];return this[a]=undefined,this._front=a+1&this._capacity-1,this._length--,b},a.prototype.length=function(){return this._length},a.prototype._checkCapacity=function(a){this._capacity<a&&this._resizeTo(this._capacity<<1)},a.prototype._resizeTo=function(f){var a=this._capacity;this._capacity=f;var b=this._front,d=this._length,e=b+d&a-1;c(this,0,this,a,e)},b.exports=a},{}],29:[function(a,b,c){'use strict';b.exports=function(b,f,g,h){function c(c,l){var j=g(c);if(j instanceof b)return e(j);if(!d(c))return h('expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n');var a=new b(f);l!==undefined&&a._propagateFrom(l,5);var m=a._fulfill,n=a._reject;for(var i=0,o=c.length;i<o;++i){var k=c[i];if(k===undefined&&!(i in c))continue;b.cast(k)._then(m,n,undefined,a,null)}return a}var d=a('./util.js').isArray,e=function(a){return a.then(function(b){return c(b,a)})};b.race=function(a){return c(a,undefined)},b.prototype.race=function(){return c(this,undefined)}}},{'./util.js':38}],30:[function(a,b,c){'use strict';b.exports=function(c,l,m,g,k){function b(l,h,b,m){this.constructor$(l),this._promise._captureStackTrace(),this._preservedValues=m===k?[]:null,this._zerothIsAccum=b===undefined,this._gotAccum=!1,this._reducingIndex=this._zerothIsAccum?1:0,this._valuesPhase=undefined;var a=g(b,this._promise),d=!1,e=a instanceof c;e&&(a=a._target(),a._isPending()?a._proxyPromiseArray(this,-1):a._isFulfilled()?(b=a._value(),this._gotAccum=!0):(this._reject(a._reason()),d=!0)),e||this._zerothIsAccum||(this._gotAccum=!0);var f=i();this._callback=f===null?h:f.bind(h),this._accum=b,d||j.invoke(n,this,undefined)}function n(){this._init$(undefined,-5)}function h(d,a,e,f){if(typeof a!=='function')return m('fn must be a function\n\n    See http://goo.gl/916lJJ\n');var c=new b(d,a,e,f);return c.promise()}var i=c._getDomain,j=a('./async.js'),d=a('./util.js'),e=d.tryCatch,f=d.errorObj;d.inherits(b,l),b.prototype._init=function(){},b.prototype._resolveEmptyArray=function(){(this._gotAccum||this._zerothIsAccum)&&this._resolve(this._preservedValues!==null?[]:this._accum)},b.prototype._promiseFulfilled=function(i,j){var r=this._values;r[j]=i;var l=this.length(),n=this._preservedValues,q=n!==null,m=this._gotAccum,b=this._valuesPhase,d;if(!b)for(b=this._valuesPhase=new Array(l),d=0;d<l;++d)b[d]=0;if(d=b[j],j===0&&this._zerothIsAccum?(this._accum=i,this._gotAccum=m=!0,b[j]=d===0?1:2):j===-1?(this._accum=i,this._gotAccum=m=!0):d===0?b[j]=1:(b[j]=2,this._accum=i),!m)return;var o=this._callback,p=this._promise._boundValue(),k;for(var a=this._reducingIndex;a<l;++a){if(d=b[a],d===2){this._reducingIndex=a+1;continue}if(d!==1)return;if(i=r[a],this._promise._pushContext(),q?(n.push(i),k=e(o).call(p,i,a,l)):k=e(o).call(p,this._accum,i,a,l),this._promise._popContext(),k===f)return this._reject(k.e);var h=g(k,this._promise);if(h instanceof c){if(h=h._target(),h._isPending())return b[a]=4,h._proxyPromiseArray(this,a);if(!h._isFulfilled())return this._reject(h._reason());k=h._value()}this._reducingIndex=a+1,this._accum=k}this._resolve(q?n:this._accum)},c.prototype.reduce=function(a,b){return h(this,a,b,null)},c.reduce=function(a,b,c,d){return h(a,b,c,d)}}},{'./async.js':2,'./util.js':38}],31:[function(h,i,j){'use strict';var a,d=h('./util'),e=function(){throw new Error('No async scheduler available\n\n    See http://goo.gl/m3OTXk\n')};if(d.isNode&&typeof MutationObserver==='undefined'){var f=c.setImmediate,g=b.nextTick;a=d.isRecentNode?function(a){f.call(c,a)}:function(a){g.call(b,a)}}else typeof MutationObserver!=='undefined'&&!(typeof window!=='undefined'&&window.navigator&&window.navigator.standalone)?(a=function(c){var a=document.createElement('div'),b=new MutationObserver(c);return b.observe(a,{attributes:!0}),function(){a.classList.toggle('foo')}},a.isStatic=!0):typeof setImmediate!=='undefined'?a=function(a){setImmediate(a)}:typeof setTimeout!=='undefined'?a=function(a){setTimeout(a,0)}:a=e;i.exports=a},{'./util':38}],32:[function(a,b,c){'use strict';b.exports=function(c,f){function b(a){this.constructor$(a)}var d=c.PromiseInspection,e=a('./util.js');e.inherits(b,f),b.prototype._promiseResolved=function(b,c){this._values[b]=c;var a=++this._totalResolved;a>=this._length&&this._resolve(this._values)},b.prototype._promiseFulfilled=function(b,c){var a=new d;a._bitField=268435456,a._settledValue=b,this._promiseResolved(c,a)},b.prototype._promiseRejected=function(b,c){var a=new d;a._bitField=134217728,a._settledValue=b,this._promiseResolved(c,a)},c.settle=function(a){return new b(a).promise()},c.prototype.settle=function(){return new b(this).promise()}}},{'./util.js':38}],33:[function(a,b,c){'use strict';b.exports=function(c,i,j){function b(a){this.constructor$(a),this._howMany=0,this._unwrap=!1,this._initialized=!1}function e(e,a){if((a|0)!==a||a<0)return j('expecting a positive integer\n\n    See http://goo.gl/1wAmHx\n');var c=new b(e),d=c.promise();return c.setHowMany(a),c.init(),d}var d=a('./util.js'),f=a('./errors.js').RangeError,g=a('./errors.js').AggregateError,h=d.isArray;d.inherits(b,i),b.prototype._init=function(){if(!this._initialized)return;if(this._howMany===0){this._resolve([]);return}this._init$(undefined,-5);var a=h(this._values);!this._isResolved()&&a&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))},b.prototype.init=function(){this._initialized=!0,this._init()},b.prototype.setUnwrap=function(){this._unwrap=!0},b.prototype.howMany=function(){return this._howMany},b.prototype.setHowMany=function(a){this._howMany=a},b.prototype._promiseFulfilled=function(a){this._addFulfilled(a),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),this.howMany()===1&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values))},b.prototype._promiseRejected=function(c){if(this._addRejected(c),this.howMany()>this._canPossiblyFulfill()){var b=new g;for(var a=this.length();a<this._values.length;++a)b.push(this._values[a]);this._reject(b)}},b.prototype._fulfilled=function(){return this._totalResolved},b.prototype._rejected=function(){return this._values.length-this.length()},b.prototype._addRejected=function(a){this._values.push(a)},b.prototype._addFulfilled=function(a){this._values[this._totalResolved++]=a},b.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},b.prototype._getRangeError=function(b){var a='Input array must contain at least '+this._howMany+' items but contains only '+b+' items';return new f(a)},b.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},c.some=function(a,b){return e(a,b)},c.prototype.some=function(a){return e(this,a)},c._SomePromiseArray=b}},{'./errors.js':13,'./util.js':38}],34:[function(b,a,c){'use strict';a.exports=function(a){function b(a){a!==undefined?(a=a._target(),this._bitField=a._bitField,this._settledValue=a._settledValue):(this._bitField=0,this._settledValue=undefined)}b.prototype.value=function(){if(!this.isFulfilled())throw new TypeError('cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n');return this._settledValue},b.prototype.error=b.prototype.reason=function(){if(!this.isRejected())throw new TypeError('cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n');return this._settledValue},b.prototype.isFulfilled=a.prototype._isFulfilled=function(){return(this._bitField&268435456)>0},b.prototype.isRejected=a.prototype._isRejected=function(){return(this._bitField&134217728)>0},b.prototype.isPending=a.prototype._isPending=function(){return(this._bitField&402653184)===0},b.prototype.isResolved=a.prototype._isResolved=function(){return(this._bitField&402653184)>0},a.prototype.isPending=function(){return this._target()._isPending()},a.prototype.isRejected=function(){return this._target()._isRejected()},a.prototype.isFulfilled=function(){return this._target()._isFulfilled()},a.prototype.isResolved=function(){return this._target()._isResolved()},a.prototype._value=function(){return this._settledValue},a.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue},a.prototype.value=function(){var a=this._target();if(!a.isFulfilled())throw new TypeError('cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n');return a._settledValue},a.prototype.reason=function(){var a=this._target();if(!a.isRejected())throw new TypeError('cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n');return a._unsetRejectionIsUnhandled(),a._settledValue},a.PromiseInspection=b}},{}],35:[function(a,b,c){'use strict';b.exports=function(c,f){function i(e,i){if(g(e)){if(e instanceof c)return e;if(k(e)){var a=new c(f);return e._then(a._fulfillUnchecked,a._rejectUncheckedCheckError,a._progressUnchecked,a,null),a}var l=b.tryCatch(j)(e);if(l===d){i&&i._pushContext();var a=c.reject(l.e);return i&&i._popContext(),a}if(typeof l==='function')return h(e,l,i)}return e}function j(a){return a.then}function k(a){return e.call(a,'_promise0')}function h(j,l,e){function n(b){if(!a)return;a._resolveCallback(b),a=null}function m(b){if(!a)return;a._rejectCallback(b,h,!0),a=null}function k(b){if(!a)return;typeof a._progress==='function'&&a._progress(b)}var a=new c(f),i=a;e&&e._pushContext(),a._captureStackTrace(),e&&e._popContext();var h=!0,g=b.tryCatch(l).call(j,n,m,k);return h=!1,a&&g===d&&(a._rejectCallback(g.e,!0,!0),a=null),i}var b=a('./util.js'),d=b.errorObj,g=b.isObject,e={}.hasOwnProperty;return i}},{'./util.js':38}],36:[function(a,b,c){'use strict';b.exports=function(b,h){function i(b){var a=this;return a instanceof Number&&(a=+a),clearTimeout(a),b}function j(b){var a=this;throw a instanceof Number&&(a=+a),clearTimeout(a),b}var d=a('./util.js'),e=b.TimeoutError,f=function(b,c){if(!b.isPending())return;typeof c!=='string'&&(c='operation timed out');var a=new e(c);d.markAsOriginatingFromRejection(a),b._attachExtraTrace(a),b._cancel(a)},g=function(a){return c(+this).thenReturn(a)},c=b.delay=function(c,a){if(a===undefined){a=c,c=undefined;var d=new b(h);return setTimeout(function(){d._fulfill()},a),d}return a=+a,b.resolve(c)._then(g,null,null,a,undefined)};b.prototype.delay=function(a){return c(this,a)},b.prototype.timeout=function(b,d){b=+b;var a=this.then().cancellable();a._cancellationParent=this;var c=setTimeout(function b(){f(a,d)},b);return a._then(i,j,undefined,c,undefined)}}},{'./util.js':38}],37:[function(a,b,c){'use strict';b.exports=function(b,i,e,q){function p(c){var e=c.length;for(var a=0;a<e;++a){var d=c[a];if(d.isRejected())return b.reject(d.error());c[a]=d._settledValue}return c}function h(a){setTimeout(function(){throw a},0)}function n(a){var b=e(a);return b!==a&&typeof a._isDisposable==='function'&&typeof a._getDisposer==='function'&&a._isDisposable()&&b._setDisposable(a._getDisposer()),b}function j(a,i){function c(){if(d>=g)return f.resolve();var j=n(a[d++]);if(j instanceof b&&j._isDisposable()){try{j=e(j._getDisposer().tryDispose(i),a.promise)}catch(a){return h(a)}if(j instanceof b)return j._then(c,h,null,null,null)}c()}var d=0,g=a.length,f=b.defer();return c(),f.promise}function m(b){var a=new d;return a._settledValue=b,a._bitField=268435456,j(this,a).thenReturn(b)}function l(b){var a=new d;return a._settledValue=b,a._bitField=134217728,j(this,a).thenThrow(b)}function c(a,b,c){this._data=a,this._promise=b,this._context=c}function f(a,b,c){this.constructor$(a,b,c)}function o(a){return c.isDisposer(a)?(this.resources[this.index]._setDisposable(a),a.promise()):a}var g=a('./errors.js').TypeError,k=a('./util.js').inherits,d=b.PromiseInspection;c.prototype.data=function(){return this._data},c.prototype.promise=function(){return this._promise},c.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},c.prototype.tryDispose=function(d){var b=this.resource(),a=this._context;a!==undefined&&a._pushContext();var c=b!==null?this.doDispose(b,d):null;return a!==undefined&&a._popContext(),this._promise._unsetDisposable(),this._data=null,c},c.isDisposer=function(a){return a!=null&&typeof a.resource==='function'&&typeof a.tryDispose==='function'},k(f,c),f.prototype.doDispose=function(a,c){var b=this.data();return b.call(a,a,c)},b.using=function(){var d=arguments.length;if(d<2)return i('you must pass at least 2 arguments to Promise.using');var j=arguments[d-1];if(typeof j!=='function')return i('fn must be a function\n\n    See http://goo.gl/916lJJ\n');d--;var f=new Array(d);for(var g=0;g<d;++g){var a=arguments[g];if(c.isDisposer(a)){var n=a;a=a.promise(),a._setDisposable(n)}else{var k=e(a);k instanceof b&&(a=k._then(o,null,null,{resources:f,index:g},undefined))}f[g]=a}var h=b.settle(f).then(p).then(function(b){h._pushContext();var a;try{a=j.apply(undefined,b)}finally{h._popContext()}return a})._then(m,l,undefined,f,undefined);return f.promise=h,h},b.prototype._setDisposable=function(a){this._bitField=this._bitField|262144,this._disposer=a},b.prototype._isDisposable=function(){return(this._bitField&262144)>0},b.prototype._getDisposer=function(){return this._disposer},b.prototype._unsetDisposable=function(){this._bitField=this._bitField&-262145,this._disposer=undefined},b.prototype.disposer=function(a){if(typeof a==='function')return new f(a,this,q());throw new g}}},{'./errors.js':13,'./util.js':38}],38:[function(s,G,H){'use strict';function u(){try{var a=h;return h=null,a.apply(this,arguments)}catch(a){return d.e=a,d}}function A(a){return h=a,u}function f(a){return a==null||a===!0||a===!1||typeof a==='string'||typeof a==='number'}function v(a){return!f(a)}function w(a){return f(a)?new Error(e(a)):a}function y(d,e){var c=d.length,b=new Array(c+1),a;for(a=0;a<c;++a)b[a]=d[a];return b[a]=e,b}function z(c,d,e){if(!a.isES5)return{}.hasOwnProperty.call(c,d)?c[d]:undefined;var b=Object.getOwnPropertyDescriptor(c,d);return b!=null?b.get==null&&b.set==null?b.value:e:void 0}function m(b,d,e){if(f(b))return b;var c={value:e,configurable:!0,enumerable:!1,writable:!0};return a.defineProperty(b,d,c),b}function B(a){throw a}function C(c){try{if(typeof c==='function'){var b=a.names(c.prototype),d=a.isES5&&b.length>1,e=b.length>0&&!(b.length===1&&b[0]==='constructor'),f=o.test(c+'')&&a.names(c).length>0;if(d||e||f)return!0}return!1}catch(a){return!1}}function D(a){function b(){}b.prototype=a;var c=8;while(c--)new b;return a}function E(a){return n.test(a)}function F(c,d,e){var b=new Array(c);for(var a=0;a<c;++a)b[a]=d+a+e;return b}function e(a){try{return a+''}catch(a){return'[no string representation]'}}function t(a){try{m(a,'isOperational',!0)}catch(a){}}function r(a){return a==null?!1:a instanceof Error.__BluebirdErrorTypes__.OperationalError||a.isOperational===!0}function g(b){return b instanceof Error&&a.propertyIsWritable(b,'stack')}function j(a){return{}.toString.call(a)}function x(e,f,g){var d=a.names(e);for(var b=0;b<d.length;++b){var c=d[b];if(g(c))try{a.defineProperty(f,c,a.getDescriptor(e,c))}catch(a){}}}var a=s('./es5.js'),l=typeof navigator=='undefined',i=function(b){try{return b={},a.defineProperty(b,'f',{get:function(){return 3}}),b.f===3}catch(a){return!1}}(),d={e:{}},h,p=function(b,a){function c(){this.constructor=b,this.constructor$=a;for(var c in a.prototype)d.call(a.prototype,c)&&c.charAt(c.length-1)!=='$'&&(this[c+'$']=a.prototype[c])}var d={}.hasOwnProperty;return c.prototype=a.prototype,b.prototype=new c,b.prototype},q=function(b,c,e,d){return b=[Array.prototype,Object.prototype,Function.prototype],c=function(c){for(var a=0;a<b.length;++a)if(b[a]===c)return!0;return!1},a.isES5?(e=Object.getOwnPropertyNames,function(b){var f=[],i=Object.create(null);while(b!=null&&!c(b)){var j;try{j=e(b)}catch(a){return f}for(var g=0;g<j.length;++g){var d=j[g];if(i[d])continue;i[d]=!0;var h=Object.getOwnPropertyDescriptor(b,d);h!=null&&h.get==null&&h.set==null&&f.push(d)}b=a.getPrototypeOf(b)}return f}):(d={}.hasOwnProperty,function(g){if(c(g))return[];var e=[];a:for(var a in g)if(d.call(g,a))e.push(a);else{for(var f=0;f<b.length;++f)if(d.call(b[f],a))continue a;e.push(a)}return e})}(),o=/this\s*\.\s*\S+\s*=/,n=/^[a-z$_][a-z$_0-9]*$/i,k=function(){return'stack'in new Error?function(a){return g(a)?a:new Error(e(a))}:function(a){if(g(a))return a;try{throw new Error(e(a))}catch(a){return a}}}(),c={isClass:C,isIdentifier:E,inheritedDataKeys:q,getDataPropertyOrDefault:z,thrower:B,isArray:a.isArray,haveGetters:i,notEnumerableProp:m,isPrimitive:f,isObject:v,canEvaluate:l,errorObj:d,tryCatch:A,inherits:p,withAppended:y,maybeWrapAsError:w,toFastProperties:D,filledRange:F,toString:e,canAttachTrace:g,ensureErrorObject:k,originatesFromRejection:r,markAsOriginatingFromRejection:t,classString:j,copyDescriptors:x,hasDevTools:typeof chrome!=='undefined'&&chrome&&typeof chrome.loadTimes==='function',isNode:b!==void 0&&j(b).toLowerCase()==='[object process]'};c.isRecentNode=c.isNode&&function(a){return a=b.versions.node.split('.').map(Number),a[0]===0&&a[1]>10||a[0]>0}(),c.isNode&&c.toFastProperties(b);try{throw new Error}catch(a){c.lastLineError=a}},{'./es5.js':14}]},{},[4])(4)}),typeof window!=='undefined'&&window!==null?window.P=window.Promise:typeof self!=='undefined'&&self!==null&&(self.P=self.Promise)}),a.define('xhr-promise',function(b,c,d,e){b.exports=a('xhr-promise/lib/xhr-promise')}),a.define('xhr-promise/lib/xhr-promise',function(e,g,h,i){var b,c,f,d;c=a('xhr-promise/node_modules/bluebird/js/browser/bluebird'),d=a('xhr-promise/node_modules/extend'),b=a('xhr-promise/node_modules/parse-headers/parse-headers'),e.exports=f=function(){function a(){}return a.DEFAULT_CONTENT_TYPE='application/x-www-form-urlencoded; charset=UTF-8',a.prototype.send=function(a){var b;return a==null&&(a={}),b={method:'GET',data:null,headers:{},async:!0,username:null,password:null},a=d({},b,a),new c(function(b){return function(i,d){var g,e,f,h,c;if(!XMLHttpRequest){b._handleError('browser',d,null,"browser doesn't support XMLHttpRequest");return}if(typeof a.url!=='string'||a.url.length===0){b._handleError('url',d,null,'URL is a required parameter');return}b._xhr=c=new XMLHttpRequest,c.onload=function(){var a;b._detachWindowUnload();try{a=b._getResponseText()}catch(a){b._handleError('parse',d,null,'invalid JSON response');return}return i({url:b._getResponseUrl(),status:c.status,statusText:c.statusText,responseText:a,headers:b._getHeaders(),xhr:c})},c.onerror=function(){return b._handleError('error',d)},c.ontimeout=function(){return b._handleError('timeout',d)},c.onabort=function(){return b._handleError('abort',d)},b._attachWindowUnload(),c.open(a.method,a.url,a.async,a.username,a.password),a.data!=null&&!a.headers['Content-Type']&&(a.headers['Content-Type']=b.constructor.DEFAULT_CONTENT_TYPE),f=a.headers;for(e in f)h=f[e],c.setRequestHeader(e,h);try{return c.send(a.data)}catch(a){return g=a,b._handleError('send',d,null,g.toString())}}}(this))},a.prototype.getXHR=function(){return this._xhr},a.prototype._attachWindowUnload=function(){return this._unloadHandler=this._handleWindowUnload.bind(this),window.attachEvent?window.attachEvent('onunload',this._unloadHandler):void 0},a.prototype._detachWindowUnload=function(){return window.detachEvent?window.detachEvent('onunload',this._unloadHandler):void 0},a.prototype._getHeaders=function(){return b(this._xhr.getAllResponseHeaders())},a.prototype._getResponseText=function(){var a;a=typeof this._xhr.responseText==='string'?this._xhr.responseText:'';switch(this._xhr.getResponseHeader('Content-Type')){case'application/json':case'text/javascript':a=JSON.parse(a+'')}return a},a.prototype._getResponseUrl=function(){return this._xhr.responseURL!=null?this._xhr.responseURL:/^X-Request-URL:/m.test(this._xhr.getAllResponseHeaders())?this._xhr.getResponseHeader('X-Request-URL'):''},a.prototype._handleError=function(a,b,c,d){return this._detachWindowUnload(),b({reason:a,status:c||this._xhr.status,statusText:d||this._xhr.statusText,xhr:this._xhr})},a.prototype._handleWindowUnload=function(){return this._xhr.abort()},a}()}),a.define('xhr-promise/node_modules/bluebird/js/browser/bluebird',function(a,d,e,f){!function(e,b){'object'==typeof d&&void 0!==a?a.exports=e():'function'==typeof define&&define.amd?define([],e):('undefined'!=typeof window?b=window:void 0!==c?b=c:'undefined'!=typeof self&&(b=self),b.Promise=e())}(function(){return function a(b,c,e){function f(d,k){if(!c[d]){if(!b[d]){var i=typeof _dereq_=='function'&&_dereq_;if(!k&&i)return i(d,!0);if(g)return g(d,!0);var j=new Error("Cannot find module '"+d+"'");throw j.code='MODULE_NOT_FOUND',j}var h=c[d]={exports:{}};b[d][0].call(h.exports,function(c){var a=b[d][1][c];return f(a?a:c)},h,h.exports,a,b,c,e)}return c[d].exports}var g=typeof _dereq_=='function'&&_dereq_;for(var d=0;d<e.length;d++)f(e[d]);return f}({1:[function(b,a,c){'use strict';a.exports=function(a){function b(d){var a=new c(d),b=a.promise();return a.setHowMany(1),a.setUnwrap(),a.init(),b}var c=a._SomePromiseArray;a.any=function(a){return b(a)},a.prototype.any=function(){return b(this)}}},{}],2:[function(e,j,k){'use strict';function a(){this._isTickUsed=!1,this._lateQueue=new d(16),this._normalQueue=new d(16),this._trampolineEnabled=!0;var a=this;this.drainQueues=function(){a._drainQueues()},this._schedule=b.isStatic?b(this.drainQueues):b}function f(a,c,d){var b=this._getDomain();b!==undefined&&(a=b.bind(a)),this._lateQueue.push(a,c,d),this._queueTick()}function g(a,c,d){var b=this._getDomain();b!==undefined&&(a=b.bind(a)),this._normalQueue.push(a,c,d),this._queueTick()}function h(a){var b=this._getDomain();if(b!==undefined){var c=b.bind(a._settlePromises);this._normalQueue.push(c,a,undefined)}else this._normalQueue._pushOne(a);this._queueTick()}var i;try{throw new Error}catch(a){i=a}var b=e('./schedule.js'),d=e('./queue.js'),c=e('./util.js');a.prototype.disableTrampolineIfNecessary=function(){c.hasDevTools&&(this._trampolineEnabled=!1)},a.prototype.enableTrampoline=function(){this._trampolineEnabled||(this._trampolineEnabled=!0,this._schedule=function(a){setTimeout(a,0)})},a.prototype.haveItemsQueued=function(){return this._normalQueue.length()>0},a.prototype.throwLater=function(a,b){arguments.length===1&&(b=a,a=function(){throw b});var c=this._getDomain();if(c!==undefined&&(a=c.bind(a)),typeof setTimeout!=='undefined')setTimeout(function(){a(b)},0);else try{this._schedule(function(){a(b)})}catch(a){throw new Error('No async scheduler available\n\n    See http://goo.gl/m3OTXk\n')}},a.prototype._getDomain=function(){},c.hasDevTools||(a.prototype.invokeLater=f,a.prototype.invoke=g,a.prototype.settlePromises=h),b.isStatic&&(b=function(a){setTimeout(a,0)}),a.prototype.invokeLater=function(a,b,c){this._trampolineEnabled?f.call(this,a,b,c):this._schedule(function(){setTimeout(function(){a.call(b,c)},100)})},a.prototype.invoke=function(a,b,c){this._trampolineEnabled?g.call(this,a,b,c):this._schedule(function(){a.call(b,c)})},a.prototype.settlePromises=function(a){this._trampolineEnabled?h.call(this,a):this._schedule(function(){a._settlePromises()})},a.prototype.invokeFirst=function(a,c,d){var b=this._getDomain();b!==undefined&&(a=b.bind(a)),this._normalQueue.unshift(a,c,d),this._queueTick()},a.prototype._drainQueue=function(a){while(a.length()>0){var b=a.shift();if(typeof b!=='function'){b._settlePromises();continue}var c=a.shift(),d=a.shift();b.call(c,d)}},a.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._drainQueue(this._lateQueue)},a.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},a.prototype._reset=function(){this._isTickUsed=!1},j.exports=new a,j.exports.firstLineError=i},{'./queue.js':28,'./schedule.js':31,'./util.js':38,events:39}],3:[function(b,a,c){'use strict';a.exports=function(a,b,d){var c=function(b,a){this._reject(a)},e=function(b,a){a.promiseRejectionQueued=!0,a.bindingPromise._then(c,c,null,this,b)},f=function(a,b){this._setBoundTo(a),this._isPending()&&this._resolveCallback(b.target)},g=function(a,b){b.promiseRejectionQueued||this._reject(a)};a.prototype.bind=function(k){var h=d(k),c=new a(b);c._propagateFrom(this,1);var i=this._target();if(h instanceof a){var j={promiseRejectionQueued:!1,promise:c,target:i,bindingPromise:h};i._then(b,e,c._progress,c,j),h._then(f,g,c._progress,c,j)}else c._setBoundTo(k),c._resolveCallback(i);return c},a.prototype._setBoundTo=function(a){a!==undefined?(this._bitField=this._bitField|131072,this._boundTo=a):this._bitField=this._bitField&-131073},a.prototype._isBound=function(){return(this._bitField&131072)===131072},a.bind=function(f,g){var e=d(f),c=new a(b);return e instanceof a?e._then(function(a){c._setBoundTo(a),c._resolveCallback(g)},c._reject,c._progress,c,null):(c._setBoundTo(f),c._resolveCallback(g)),c}}},{}],4:[function(c,d,f){'use strict';function e(){try{Promise===a&&(Promise=b)}catch(a){}return a}var b;typeof Promise!=='undefined'&&(b=Promise);var a=c('./promise.js')();a.noConflict=e,d.exports=a},{'./promise.js':23}],5:[function(d,e,f){'use strict';var a=Object.create;if(a){var b=a(null),c=a(null);b[' size']=c[' size']=0}e.exports=function(b){function f(c,e){var d;if(c!=null&&(d=c[e]),typeof d!=='function'){var f='Object '+a.classString(c)+" has no method '"+a.toString(e)+"'";throw new b.TypeError(f)}return d}function g(a){var b=this.pop(),c=f(a,b);return c.apply(a,this)}function c(a){return a[this]}function h(b){var a=+this;return a<0&&(a=Math.max(0,a+b.length)),b[a]}var a=d('./util.js'),e=a.canEvaluate,i=a.isIdentifier,j;b.prototype.call=function(d){var c=arguments.length,b=new Array(c-1);for(var a=1;a<c;++a)b[a-1]=arguments[a];return b.push(d),this._then(g,undefined,undefined,b,undefined)},b.prototype.get=function(b){var f=typeof b==='number',a;if(!f)if(e){var d=j(b);a=d!==null?d:c}else a=c;else a=h;return this._then(a,undefined,undefined,b,undefined)}}},{'./util.js':38}],6:[function(a,b,c){'use strict';b.exports=function(b){var d=a('./errors.js'),c=a('./async.js'),e=d.CancellationError;b.prototype._cancel=function(c){if(!this.isCancellable())return this;var b,a=this;while((b=a._cancellationParent)!==undefined&&b.isCancellable())a=b;this._unsetCancellable(),a._target()._rejectCallback(c,!1,!0)},b.prototype.cancel=function(a){return this.isCancellable()?(a===undefined&&(a=new e),c.invokeLater(this._cancel,this,a),this):this},b.prototype.cancellable=function(){return this._cancellable()?this:(c.enableTrampoline(),this._setCancellable(),this._cancellationParent=undefined,this)},b.prototype.uncancellable=function(){var a=this.then();return a._unsetCancellable(),a},b.prototype.fork=function(b,c,d){var a=this._then(b,c,d,undefined,undefined);return a._setCancellable(),a._cancellationParent=undefined,a}}},{'./async.js':2,'./errors.js':13}],7:[function(a,c,d){'use strict';c.exports=function(){function c(a){this._parent=a;var b=this._length=a===undefined?1:1+a._length;m(this,c),b>32&&this.uncycle()}function w(c,b){for(var a=0;a<b.length-1;++a)b[a].push('From previous event:'),b[a]=b[a].join('\n');return a<b.length&&(b[a]=b[a].join('\n')),c+'\n'+b.join('\n')}function v(b){for(var a=0;a<b.length;++a)(b[a].length===0||a+1<b.length&&b[a][0]===b[a+1][0])&&(b.splice(a,1),a--)}function u(f){var b=f[0];for(var d=1;d<f.length;++d){var c=f[d],e=b.length-1,h=b[e],g=-1;for(var a=c.length-1;a>=0;--a)if(c[a]===h){g=a;break}for(var a=g;a>=0;--a){var i=c[a];if(b[e]===i)b.pop(),e--;else break}b=c}}function p(e){var c=[];for(var b=0;b<e.length;++b){var a=e[b],d=f.test(a)||'    (No stack trace)'===a,g=d&&h(a);d&&!g&&(n&&a.charAt(0)!==' '&&(a='    '+a),c.push(a))}return c}function t(d){var a=d.stack.replace(/\s+$/g,'').split('\n');for(var b=0;b<a.length;++b){var c=a[b];if('    (No stack trace)'===c||f.test(c))break}return b>0&&(a=a.slice(b)),a}function r(b){var a;if(typeof b==='function')a='[function '+(b.name||'anonymous')+']';else{a=b.toString();var c=/\[object [a-zA-Z0-9$_]+\]/;if(c.test(a))try{var d=JSON.stringify(b);a=d}catch(a){}a.length===0&&(a='(empty array)')}return'(<'+s(a)+'>, no stack trace)'}function s(a){var b=41;return a.length<b?a:a.substr(0,b-3)+'...'}function l(b){var a=b.match(o);return a?{fileName:a[1],line:parseInt(a[2],10)}:void 0}var i=a('./async.js'),d=a('./util.js'),k=/[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/,f=null,e=null,n=!1,g;d.inherits(c,Error),c.prototype.uncycle=function(){var e=this._length;if(e<2)return;var b=[],h={};for(var a=0,f=this;f!==undefined;++a)b.push(f),f=f._parent;e=this._length=a;for(var a=e-1;a>=0;--a){var i=b[a].stack;h[i]===undefined&&(h[i]=a)}for(var a=0;a<e;++a){var k=b[a].stack,c=h[k];if(c!==undefined&&c!==a){c>0&&(b[c-1]._parent=undefined,b[c-1]._length=1),b[a]._parent=undefined,b[a]._length=1;var d=a>0?b[a-1]:this;c<e-1?(d._parent=b[c+1],d._parent.uncycle(),d._length=d._parent._length+1):(d._parent=undefined,d._length=1);var j=d._length+1;for(var g=a-2;g>=0;--g)b[g]._length=j,j++;return}}},c.prototype.parent=function(){return this._parent},c.prototype.hasParent=function(){return this._parent!==undefined},c.prototype.attachExtraTrace=function(e){if(e.__stackCleaned__)return;this.uncycle();var f=c.parseStackAndMessage(e),g=f.message,a=[f.stack],b=this;while(b!==undefined)a.push(p(b.stack.split('\n'))),b=b._parent;u(a),v(a),d.notEnumerableProp(e,'stack',w(g,a)),d.notEnumerableProp(e,'__stackCleaned__',!0)},c.parseStackAndMessage=function(b){var a=b.stack,c=b.toString();return a=typeof a==='string'&&a.length>0?t(b):['    (No stack trace)'],{message:c,stack:p(a)}},c.formatAndLogError=function(a,c){if(typeof console!=='undefined'){var b;if(typeof a==='object'||typeof a==='function'){var d=a.stack;b=c+e(d,a)}else b=c+String(a);typeof g==='function'?g(b):(typeof console.log==='function'||typeof console.log==='object')&&console.log(b)}},c.unhandledRejection=function(a){c.formatAndLogError(a,'^--- With additional stack trace: ')},c.isSupported=function(){return typeof m==='function'},c.fireRejectionEvent=function(a,g,b,d){var h=!1;try{typeof g==='function'&&(h=!0,a==='rejectionHandled'?g(d):g(b,d))}catch(a){i.throwLater(a)}var e=!1;try{e=q(a,b,d)}catch(a){e=!0,i.throwLater(a)}var f=!1;if(j)try{f=j(a.toLowerCase(),{reason:b,promise:d})}catch(a){f=!0,i.throwLater(a)}!(e||h||f)&&a==='unhandledRejection'&&c.formatAndLogError(b,'Unhandled rejection ')};var h=function(){return!1},o=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;c.setBounds=function(m,n){if(!c.isSupported())return;var i=m.stack.split('\n'),g=n.stack.split('\n'),d=-1,e=-1,f,j;for(var b=0;b<i.length;++b){var a=l(i[b]);if(a){f=a.fileName,d=a.line;break}}for(var b=0;b<g.length;++b){var a=l(g[b]);if(a){j=a.fileName,e=a.line;break}}if(d<0||e<0||!f||!j||f!==j||d>=e)return;h=function(b){if(k.test(b))return!0;var a=l(b);return a&&a.fileName===f&&d<=a.line&&a.line<=e?!0:!1}};var m=function a(){var d=/^\s*at\s*/,b=function(b,a){return typeof b==='string'?b:a.name!==undefined&&a.message!==undefined?a.toString():r(a)};if(typeof Error.stackTraceLimit==='number'&&typeof Error.captureStackTrace==='function'){Error.stackTraceLimit=Error.stackTraceLimit+6,f=d,e=b;var g=Error.captureStackTrace;return h=function(a){return k.test(a)},function(a,b){Error.stackTraceLimit=Error.stackTraceLimit+6,g(a,b),Error.stackTraceLimit=Error.stackTraceLimit-6}}var c=new Error;if(typeof c.stack==='string'&&c.stack.split('\n')[0].indexOf('stackDetection@')>=0)return f=/@/,e=b,n=!0,function a(b){b.stack=new Error().stack};var i;try{throw new Error}catch(a){i='stack'in a}return!('stack'in c)&&i?(f=d,e=b,function a(b){Error.stackTraceLimit=Error.stackTraceLimit+6;try{throw new Error}catch(a){b.stack=a.stack}}):(e=function(b,a){return typeof b==='string'?b:(typeof a==='object'||typeof a==='function')&&a.name!==undefined&&a.message!==undefined?a.toString():r(a)},null)}([]),j,q=function(a,e,g,f,c){if(d.isNode)return function(a,d,c){return a==='rejectionHandled'?b.emit(a,c):b.emit(a,d,c)};else{a=!1,e=!0;try{g=new self.CustomEvent('test'),a=g instanceof CustomEvent}catch(a){}if(!a)try{f=document.createEvent('CustomEvent'),f.initCustomEvent('testingtheevent',!1,!0,{}),self.dispatchEvent(f)}catch(a){e=!1}return e&&(j=function(c,d){var b;return a?b=new self.CustomEvent(c,{detail:d,bubbles:!1,cancelable:!0}):self.dispatchEvent&&(b=document.createEvent('CustomEvent'),b.initCustomEvent(c,!1,!0,d)),b?!self.dispatchEvent(b):!1}),c={},c.unhandledRejection='onunhandledRejection'.toLowerCase(),c.rejectionHandled='onrejectionHandled'.toLowerCase(),function(b,f,d){var e=c[b],a=self[e];return a?(b==='rejectionHandled'?a.call(self,d):a.call(self,f,d),!0):!1}}}();return typeof console!=='undefined'&&console.warn!==void 0&&(g=function(a){console.warn(a)},d.isNode&&b.stderr.isTTY?g=function(a){b.stderr.write('[31m'+a+'[39m\n')}:!d.isNode&&typeof new Error().stack==='string'&&(g=function(a){console.warn('%c'+a,'color: red')})),c}},{'./async.js':2,'./util.js':38}],8:[function(a,b,c){'use strict';b.exports=function(c){function f(a,b,c){this._instances=a,this._callback=b,this._promise=c}function j(f,g){var c={},a=d(f).call(c,g);if(a===b)return a;var e=h(c);return e.length?(b.e=new i('Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n'),b):a}var e=a('./util.js'),g=a('./errors.js'),d=e.tryCatch,b=e.errorObj,h=a('./es5.js').keys,i=g.TypeError;return f.prototype.doFilter=function(f){var i=this._callback,n=this._promise,h=n._boundTo;for(var g=0,m=this._instances.length;g<m;++g){var e=this._instances[g],k=e===Error||e!=null&&e.prototype instanceof Error;if(k&&f instanceof e){var a=d(i).call(h,f);return a===b?(c.e=a.e,c):a}if(typeof e==='function'&&!k){var l=j(e,f);if(l===b){f=b.e;break}if(l){var a=d(i).call(h,f);return a===b?(c.e=a.e,c):a}}}return c.e=f,c},f}},{'./errors.js':13,'./es5.js':14,'./util.js':38}],9:[function(b,a,c){'use strict';a.exports=function(c,f,d){function a(){this._trace=new f(e())}function g(){return d()?new a:void 0}function e(){var a=b.length-1;return a>=0?b[a]:undefined}var b=[];return a.prototype._pushContext=function(){if(!d())return;this._trace!==undefined&&b.push(this._trace)},a.prototype._popContext=function(){if(!d())return;this._trace!==undefined&&b.pop()},c.prototype._peekContext=e,c.prototype._pushContext=a.prototype._pushContext,c.prototype._popContext=a.prototype._popContext,g}},{}],10:[function(a,c,d){'use strict';c.exports=function(c,e){var f=a('./async.js'),h=a('./errors.js').Warning,g=a('./util.js'),i=g.canAttachTrace,j,k,d=g.isNode&&(!!b.env.BLUEBIRD_DEBUG||b.env.NODE_ENV==='development');return d&&f.disableTrampolineIfNecessary(),c.prototype._ignoreRejections=function(){this._unsetRejectionIsUnhandled(),this._bitField=this._bitField|16777216},c.prototype._ensurePossibleRejectionHandled=function(){if((this._bitField&16777216)!==0)return;this._setRejectionIsUnhandled(),f.invokeLater(this._notifyUnhandledRejection,this,undefined)},c.prototype._notifyUnhandledRejectionIsHandled=function(){e.fireRejectionEvent('rejectionHandled',j,undefined,this)},c.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var a=this._getCarriedStackTrace()||this._settledValue;this._setUnhandledRejectionIsNotified(),e.fireRejectionEvent('unhandledRejection',k,a,this)}},c.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=this._bitField|524288},c.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-524289},c.prototype._isUnhandledRejectionNotified=function(){return(this._bitField&524288)>0},c.prototype._setRejectionIsUnhandled=function(){this._bitField=this._bitField|2097152},c.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&-2097153,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},c.prototype._isRejectionUnhandled=function(){return(this._bitField&2097152)>0},c.prototype._setCarriedStackTrace=function(a){this._bitField=this._bitField|1048576,this._fulfillmentHandler0=a},c.prototype._isCarryingStackTrace=function(){return(this._bitField&1048576)>0},c.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:undefined},c.prototype._captureStackTrace=function(){return d&&(this._trace=new e(this._peekContext())),this},c.prototype._attachExtraTrace=function(a,f){if(d&&i(a)){var b=this._trace;if(b!==undefined&&f&&(b=b._parent),b!==undefined)b.attachExtraTrace(a);else if(!a.__stackCleaned__){var c=e.parseStackAndMessage(a);g.notEnumerableProp(a,'stack',c.message+'\n'+c.stack.join('\n')),g.notEnumerableProp(a,'__stackCleaned__',!0)}}},c.prototype._warn=function(d){var a=new h(d),b=this._peekContext();if(b)b.attachExtraTrace(a);else{var c=e.parseStackAndMessage(a);a.stack=c.message+'\n'+c.stack.join('\n')}e.formatAndLogError(a,'')},c.onPossiblyUnhandledRejection=function(a){k=typeof a==='function'?a:undefined},c.onUnhandledRejectionHandled=function(a){j=typeof a==='function'?a:undefined},c.longStackTraces=function(){if(f.haveItemsQueued()&&d===!1)throw new Error('cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/DT1qyG\n');d=e.isSupported(),d&&f.disableTrampolineIfNecessary()},c.hasLongStackTraces=function(){return d&&e.isSupported()},e.isSupported()||(c.longStackTraces=function(){},d=!1),function(){return d}}},{'./async.js':2,'./errors.js':13,'./util.js':38}],11:[function(d,e,f){'use strict';var a=d('./util.js'),b=a.isPrimitive,c=a.wrapsPrimitiveReceiver;e.exports=function(a){var e=function(){return this},f=function(){throw this},g=function(){},h=function(){throw undefined},d=function(a,b){return b===1?function(){throw a}:b===2?function(){return a}:void 0};a.prototype['return']=a.prototype.thenReturn=function(a){return a===undefined?this.then(g):c&&b(a)?this._then(d(a,2),undefined,undefined,undefined,undefined):this._then(e,undefined,undefined,a,undefined)},a.prototype['throw']=a.prototype.thenThrow=function(a){return a===undefined?this.then(h):c&&b(a)?this._then(d(a,1),undefined,undefined,undefined,undefined):this._then(f,undefined,undefined,a,undefined)}}},{'./util.js':38}],12:[function(b,a,c){'use strict';a.exports=function(a,c){var b=a.reduce;a.prototype.each=function(a){return b(this,a,null,c)},a.each=function(a,d){return b(a,d,null,c)}}},{}],13:[function(n,s,t){'use strict';function e(c,d){function b(e){if(!(this instanceof b))return new b(e);a(this,'message',typeof e==='string'?e:d),a(this,'name',c),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return i(b,Error),b}function h(b){if(!(this instanceof h))return new h(b);a(this,'name','OperationalError'),a(this,'message',b),this.cause=b,this.isOperational=!0,b instanceof Error?(a(this,'message',b.message),a(this,'stack',b.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}var l=n('./es5.js'),r=l.freeze,j=n('./util.js'),i=j.inherits,a=j.notEnumerableProp,m,k,o=e('Warning','warning'),p=e('CancellationError','cancellation error'),q=e('TimeoutError','timeout error'),d=e('AggregateError','aggregate error');try{m=TypeError,k=RangeError}catch(a){m=e('TypeError','type error'),k=e('RangeError','range error')}var f='join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse'.split(' ');for(var c=0;c<f.length;++c)typeof Array.prototype[f[c]]==='function'&&(d.prototype[f[c]]=Array.prototype[f[c]]);l.defineProperty(d.prototype,'length',{value:0,configurable:!1,writable:!0,enumerable:!0}),d.prototype.isOperational=!0;var g=0;d.prototype.toString=function(){var d=Array(g*4+1).join(' '),f='\n'+d+'AggregateError of:'+'\n';g++,d=Array(g*4+1).join(' ');for(var a=0;a<this.length;++a){var e=this[a]===this?'[Circular AggregateError]':this[a]+'',b=e.split('\n');for(var c=0;c<b.length;++c)b[c]=d+b[c];e=b.join('\n'),f+=e+'\n'}return g--,f},i(h,Error);var b=Error.__BluebirdErrorTypes__;b||(b=r({CancellationError:p,TimeoutError:q,OperationalError:h,RejectionError:h,AggregateError:d}),a(Error,'__BluebirdErrorTypes__',b)),s.exports={Error:Error,TypeError:m,RangeError:k,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:o}},{'./es5.js':14,'./util.js':38}],14:[function(l,i,m){var a=function(){'use strict';return this===undefined}();if(a)i.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:a,propertyIsWritable:function(b,c){var a=Object.getOwnPropertyDescriptor(b,c);return!!(!a||a.writable||a.set)}};else{var f={}.hasOwnProperty,g={}.toString,c={}.constructor.prototype,b=function(c){var a=[];for(var b in c)f.call(c,b)&&a.push(b);return a},j=function(a,b){return{value:a[b]}},k=function(a,b,c){return a[b]=c.value,a},h=function(a){return a},d=function(a){try{return Object(a).constructor.prototype}catch(a){return c}},e=function(a){try{return g.call(a)==='[object Array]'}catch(a){return!1}};i.exports={isArray:e,keys:b,names:b,defineProperty:k,getDescriptor:j,freeze:h,getPrototypeOf:d,isES5:a,propertyIsWritable:function(){return!0}}}},{}],15:[function(b,a,c){'use strict';a.exports=function(a,c){var b=a.map;a.prototype.filter=function(a,d){return b(this,a,d,c)},a.filter=function(a,d,e){return b(a,d,e,c)}}},{}],16:[function(a,b,c){'use strict';b.exports=function(b,e,f){function o(){return this}function k(){throw this}function m(a){return function(){return a}}function n(a){return function(){throw a}}function g(e,a,c){var b;return i&&j(a)?b=c?m(a):n(a):b=c?o:k,e._then(b,d,undefined,a,undefined)}function h(d){var a=this.promise,h=this.handler,i=a._isBound()?h.call(a._boundTo):h();if(i!==undefined){var c=f(i,a);if(c instanceof b)return c=c._target(),g(c,d,a.isFulfilled())}return a.isRejected()?(e.e=d,e):d}function l(c){var d=this.promise,e=this.handler,h=d._isBound()?e.call(d._boundTo,c):e(c);if(h!==undefined){var a=f(h,d);if(a instanceof b)return a=a._target(),g(a,c,!0)}return c}var c=a('./util.js'),i=c.wrapsPrimitiveReceiver,j=c.isPrimitive,d=c.thrower;b.prototype._passThroughHandler=function(a,b){if(typeof a!=='function')return this.then();var c={promise:this,handler:a};return this._then(b?h:l,b?h:undefined,undefined,c,undefined)},b.prototype.lastly=b.prototype['finally']=function(a){return this._passThroughHandler(a,!0)},b.prototype.tap=function(a){return this._passThroughHandler(a,!1)}}},{'./util.js':38}],17:[function(a,b,c){'use strict';b.exports=function(b,m,l,j){function k(k,h,a){for(var c=0;c<h.length;++c){a._pushContext();var f=d(h[c])(k);if(a._popContext(),f===e){a._pushContext();var i=b.reject(e.e);return a._popContext(),i}var g=j(f,a);if(g instanceof b)return g}return null}function c(d,e,a,f){var c=this._promise=new b(l);c._captureStackTrace(),this._stack=f,this._generatorFunction=d,this._receiver=e,this._generator=undefined,this._yieldHandlers=typeof a==='function'?[a].concat(g):g}var i=a('./errors.js'),f=i.TypeError,h=a('./util.js'),e=h.errorObj,d=h.tryCatch,g=[];c.prototype.promise=function(){return this._promise},c.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=undefined,this._next(undefined)},c.prototype._continue=function(c){if(c===e)return this._promise._rejectCallback(c.e,!1,!0);var d=c.value;if(c.done===!0)this._promise._resolveCallback(d);else{var a=j(d,this._promise);if(!(a instanceof b)&&(a=k(a,this._yieldHandlers,this._promise),a===null)){this._throw(new f('A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/4Y4pDk\n\n'.replace('%s',d)+'From coroutine:\n'+this._stack.split('\n').slice(1,-7).join('\n')));return}a._then(this._next,this._throw,undefined,this,null)}},c.prototype._throw=function(a){this._promise._attachExtraTrace(a),this._promise._pushContext();var b=d(this._generator['throw']).call(this._generator,a);this._promise._popContext(),this._continue(b)},c.prototype._next=function(b){this._promise._pushContext();var a=d(this._generator.next).call(this._generator,b);this._promise._popContext(),this._continue(a)},b.coroutine=function(a,g){if(typeof a!=='function')throw new f('generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n');var b=Object(g).yieldHandler,d=c,e=new Error().stack;return function(){var f=a.apply(this,arguments),c=new d(undefined,undefined,b,e);return c._generator=f,c._next(undefined),c.promise()}},b.coroutine.addYieldHandler=function(a){if(typeof a!=='function')throw new f('fn must be a function\n\n    See http://goo.gl/916lJJ\n');g.push(a)},b.spawn=function(d){if(typeof d!=='function')return m('generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n');var a=new c(d,this),e=a.promise();return a._run(b.spawn),e}}},{'./errors.js':13,'./util.js':38}],18:[function(a,b,c){'use strict';b.exports=function(c,d,i,j){var b=a('./util.js'),e=b.canEvaluate,f=b.tryCatch,g=b.errorObj,h,h;c.join=function(){var b=arguments.length-1,c,e;b>0&&typeof arguments[b]==='function'&&(c=arguments[b],!1);var g=arguments.length,f=new Array(g);for(var a=0;a<g;++a)f[a]=arguments[a];c&&f.pop();var e=new d(f).promise();return c!==undefined?e.spread(c):e}}},{'./util.js':38}],19:[function(a,b,c){'use strict';b.exports=function(d,l,g,n,o){function b(b,c,a,d){this.constructor$(b),this._promise._captureStackTrace(),this._callback=c,this._preservedValues=d===o?new Array(this.length()):null,this._limit=a,this._inFlight=0,this._queue=a>=1?[]:f,i.invoke(m,this,undefined)}function m(){this._init$(undefined,-2)}function h(d,e,c,f){var a=typeof c==='object'&&c!==null?c.concurrency:0;return a=typeof a==='number'&&isFinite(a)&&a>=1?a:0,new b(d,e,a,f)}var i=a('./async.js'),c=a('./util.js'),j=c.tryCatch,k=c.errorObj,e={},f=[];c.inherits(b,l),b.prototype._init=function(){},b.prototype._promiseFulfilled=function(i,a){var c=this._values,l=this.length(),h=this._preservedValues,g=this._limit;if(c[a]===e){if(c[a]=i,g>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return}else{if(g>=1&&this._inFlight>=g){c[a]=i,this._queue.push(a);return}h!==null&&(h[a]=i);var p=this._callback,m=this._promise._boundTo;this._promise._pushContext();var f=j(p).call(m,i,a,l);if(this._promise._popContext(),f===k)return this._reject(f.e);var b=n(f,this._promise);if(b instanceof d){if(b=b._target(),b._isPending())return g>=1&&this._inFlight++,c[a]=e,b._proxyPromiseArray(this,a);if(!b._isFulfilled())return this._reject(b._reason());f=b._value()}c[a]=f}var o=++this._totalResolved;o>=l&&(h!==null?this._filter(c,h):this._resolve(c))},b.prototype._drainQueue=function(){var a=this._queue,c=this._limit,d=this._values;while(a.length>0&&this._inFlight<c){if(this._isResolved())return;var b=a.pop();this._promiseFulfilled(d[b],b)}},b.prototype._filter=function(f,e){var c=e.length,b=new Array(c),d=0;for(var a=0;a<c;++a)f[a]&&(b[d++]=e[a]);b.length=d,this._resolve(b)},b.prototype.preservedValues=function(){return this._preservedValues},d.prototype.map=function(a,b){return typeof a!=='function'?g('fn must be a function\n\n    See http://goo.gl/916lJJ\n'):h(this,a,b,null).promise()},d.map=function(b,a,c,d){return typeof a!=='function'?g('fn must be a function\n\n    See http://goo.gl/916lJJ\n'):h(b,a,c,d).promise()}}},{'./async.js':2,'./util.js':38}],20:[function(a,b,c){'use strict';b.exports=function(b,e,g,f){var c=a('./util.js'),d=c.tryCatch;b.method=function(a){if(typeof a!=='function')throw new b.TypeError('fn must be a function\n\n    See http://goo.gl/916lJJ\n');return function(){var c=new b(e);c._captureStackTrace(),c._pushContext();var f=d(a).apply(this,arguments);return c._popContext(),c._resolveFromSyncValue(f),c}},b.attempt=b['try']=function(g,h,i){if(typeof g!=='function')return f('fn must be a function\n\n    See http://goo.gl/916lJJ\n');var a=new b(e);a._captureStackTrace(),a._pushContext();var j=c.isArray(h)?d(g).apply(i,h):d(g).call(i,h);return a._popContext(),a._resolveFromSyncValue(j),a},b.prototype._resolveFromSyncValue=function(a){a===c.errorObj?this._rejectCallback(a.e,!1,!0):this._resolveCallback(a,!0)}}},{'./util.js':38}],21:[function(a,b,c){'use strict';b.exports=function(f){function h(a,i){var f=this;if(!c.isArray(a))return g.call(f,a,i);var h=b(i).apply(f._boundTo,[null].concat(a));h===e&&d.throwLater(h.e)}function g(f,g){var h=this,a=h._boundTo,c=f===undefined?b(g).call(a,null):b(g).call(a,null,f);c===e&&d.throwLater(c.e)}function i(a,i){var c=this;if(!a){var h=c._target(),f=h._getCarriedStackTrace();f.cause=a,a=f}var g=b(i).call(c._boundTo,a);g===e&&d.throwLater(g.e)}var c=a('./util.js'),d=a('./async.js'),b=c.tryCatch,e=c.errorObj;f.prototype.asCallback=f.prototype.nodeify=function(b,c){if(typeof b=='function'){var a=g;c!==undefined&&Object(c).spread&&(a=h),this._then(a,i,undefined,this,b)}return this}}},{'./async.js':2,'./util.js':38}],22:[function(a,b,c){'use strict';b.exports=function(b,g){var c=a('./util.js'),d=a('./async.js'),e=c.tryCatch,f=c.errorObj;b.prototype.progressed=function(a){return this._then(undefined,undefined,a,undefined,undefined)},b.prototype._progress=function(a){if(this._isFollowingOrFulfilledOrRejected())return;this._target()._progressUnchecked(a)},b.prototype._progressHandlerAt=function(a){return a===0?this._progressHandler0:this[(a<<2)+a-5+2]},b.prototype._doProgressWith=function(g){var h=g.value,i=g.handler,d=g.promise,j=g.receiver,a=e(i).call(j,h);if(a===f){if(a.e!=null&&a.e.name!=='StopProgressPropagation'){var k=c.canAttachTrace(a.e)?a.e:new Error(c.toString(a.e));d._attachExtraTrace(k),d._progress(a.e)}}else a instanceof b?a._then(d._progress,null,null,d,undefined):d._progress(a)},b.prototype._progressUnchecked=function(h){var i=this._length(),j=this._progress;for(var a=0;a<i;a++){var e=this._progressHandlerAt(a),c=this._promiseAt(a);if(!(c instanceof b)){var f=this._receiverAt(a);typeof e==='function'?e.call(f,h,c):f instanceof g&&!f._isResolved()&&f._promiseProgressed(h,c);continue}typeof e==='function'?d.invoke(this._doProgressWith,this,{handler:e,promise:c,receiver:this._receiverAt(a),value:h}):d.invoke(j,c,h)}}}},{'./async.js':2,'./util.js':38}],23:[function(a,b,c){'use strict';b.exports=function(){function b(a){if(typeof a!=='function')throw new k('the promise constructor requires a resolver function\n\n    See http://goo.gl/EC22Yn\n');if(this.constructor!==b)throw new k('the promise constructor cannot be invoked directly\n\n    See http://goo.gl/KsIlge\n');this._bitField=0,this._fulfillmentHandler0=undefined,this._rejectionHandler0=undefined,this._progressHandler0=undefined,this._promise0=undefined,this._receiver0=undefined,this._settledValue=undefined,a!==c&&this._resolveFromResolver(a)}function j(d){var a=new b(c);a._fulfillmentHandler0=d,a._rejectionHandler0=d,a._progressHandler0=d,a._promise0=d,a._receiver0=d,a._settledValue=d}var l=function(){return new k('circular promise resolution chain\n\n    See http://goo.gl/LhFpo0\n')},s=function(){return new b.PromiseInspection(this._target())},g=function(a){return b.reject(new k(a))},e=a('./util.js'),h=a('./async.js'),i=a('./errors.js'),k=b.TypeError=i.TypeError;b.RangeError=i.RangeError,b.CancellationError=i.CancellationError,b.TimeoutError=i.TimeoutError,b.OperationalError=i.OperationalError,b.RejectionError=i.OperationalError,b.AggregateError=i.AggregateError;var c=function(){},q={},o={e:null},d=a('./thenables.js')(b,c),f=a('./promise_array.js')(b,c,d,g),n=a('./captured_trace.js')(),r=a('./debuggability.js')(b,n),w=a('./context.js')(b,n,r),u=a('./catch_filter.js')(o),t=a('./promise_resolver.js'),v=t._nodebackForPromise,p=e.errorObj,m=e.tryCatch;return b.prototype.toString=function(){return'[object Promise]'},b.prototype.caught=b.prototype['catch']=function(e){var c=arguments.length;if(c>1){var d=new Array(c-1),f=0,a;for(a=0;a<c-1;++a){var g=arguments[a];if(!(typeof g==='function'))return b.reject(new k('Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n'));d[f++]=g}d.length=f,e=arguments[a];var h=new u(d,e,this);return this._then(undefined,h.doFilter,undefined,h,undefined)}return this._then(undefined,e,undefined,undefined,undefined)},b.prototype.reflect=function(){return this._then(s,s,undefined,this,undefined)},b.prototype.then=function(a,b,d){if(r()&&arguments.length>0&&typeof a!=='function'&&typeof b!=='function'){var c='.then() only accepts functions but was passed: '+e.classString(a);arguments.length>1&&(c+=', '+e.classString(b)),this._warn(c)}return this._then(a,b,d,undefined,undefined)},b.prototype.done=function(b,c,d){var a=this._then(b,c,d,undefined,undefined);a._setIsFinal()},b.prototype.spread=function(a,b){return this.all()._then(a,b,undefined,q,undefined)},b.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},b.prototype.toJSON=function(){var a={isFulfilled:!1,isRejected:!1,fulfillmentValue:undefined,rejectionReason:undefined};return this.isFulfilled()?(a.fulfillmentValue=this.value(),a.isFulfilled=!0):this.isRejected()&&(a.rejectionReason=this.reason(),a.isRejected=!0),a},b.prototype.all=function(){return new f(this).promise()},b.prototype.error=function(a){return this.caught(e.originatesFromRejection,a)},b.is=function(a){return a instanceof b},b.fromNode=function(e){var a=new b(c),d=m(e)(v(a));return d===p&&a._rejectCallback(d.e,!0,!0),a},b.all=function(a){return new f(a).promise()},b.defer=b.pending=function(){var a=new b(c);return new t(a)},b.cast=function(f){var a=d(f);if(!(a instanceof b)){var e=a;a=new b(c),a._fulfillUnchecked(e)}return a},b.resolve=b.fulfilled=b.cast,b.reject=b.rejected=function(d){var a=new b(c);return a._captureStackTrace(),a._rejectCallback(d,!0),a},b.setScheduler=function(a){if(typeof a!=='function')throw new k('fn must be a function\n\n    See http://goo.gl/916lJJ\n');var b=h._schedule;return h._schedule=a,b},b.prototype._then=function(j,k,l,f,g){var e=g!==undefined,d=e?g:new b(c);e||(d._propagateFrom(this,5),d._captureStackTrace());var a=this._target();a!==this&&(f===undefined&&(f=this._boundTo),e||d._setIsMigrated());var i=a._addCallbacks(j,k,l,d,f);return a._isResolved()&&!a._isSettlePromisesQueued()&&h.invoke(a._settlePromiseAtPostResolution,a,i),d},b.prototype._settlePromiseAtPostResolution=function(a){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),this._settlePromiseAt(a)},b.prototype._length=function(){return this._bitField&131071},b.prototype._isFollowingOrFulfilledOrRejected=function(){return(this._bitField&939524096)>0},b.prototype._isFollowing=function(){return(this._bitField&536870912)===536870912},b.prototype._setLength=function(a){this._bitField=this._bitField&-131072|a&131071},b.prototype._setFulfilled=function(){this._bitField=this._bitField|268435456},b.prototype._setRejected=function(){this._bitField=this._bitField|134217728},b.prototype._setFollowing=function(){this._bitField=this._bitField|536870912},b.prototype._setIsFinal=function(){this._bitField=this._bitField|33554432},b.prototype._isFinal=function(){return(this._bitField&33554432)>0},b.prototype._cancellable=function(){return(this._bitField&67108864)>0},b.prototype._setCancellable=function(){this._bitField=this._bitField|67108864},b.prototype._unsetCancellable=function(){this._bitField=this._bitField&-67108865},b.prototype._setIsMigrated=function(){this._bitField=this._bitField|4194304},b.prototype._unsetIsMigrated=function(){this._bitField=this._bitField&-4194305},b.prototype._isMigrated=function(){return(this._bitField&4194304)>0},b.prototype._receiverAt=function(b){var a=b===0?this._receiver0:this[b*5-5+4];return a===undefined&&this._isBound()?this._boundTo:a},b.prototype._promiseAt=function(a){return a===0?this._promise0:this[a*5-5+3]},b.prototype._fulfillmentHandlerAt=function(a){return a===0?this._fulfillmentHandler0:this[a*5-5+0]},b.prototype._rejectionHandlerAt=function(a){return a===0?this._rejectionHandler0:this[a*5-5+1]},b.prototype._migrateCallbacks=function(a,c){var e=a._fulfillmentHandlerAt(c),f=a._rejectionHandlerAt(c),g=a._progressHandlerAt(c),d=a._promiseAt(c),h=a._receiverAt(c);d instanceof b&&d._setIsMigrated(),this._addCallbacks(e,f,g,d,h)},b.prototype._addCallbacks=function(c,d,e,g,f){var a=this._length();if(a>=131066&&(a=0,this._setLength(0)),a===0)this._promise0=g,f!==undefined&&(this._receiver0=f),typeof c==='function'&&!this._isCarryingStackTrace()&&(this._fulfillmentHandler0=c),typeof d==='function'&&(this._rejectionHandler0=d),typeof e==='function'&&(this._progressHandler0=e);else{var b=a*5-5;this[b+3]=g,this[b+4]=f,typeof c==='function'&&(this[b+0]=c),typeof d==='function'&&(this[b+1]=d),typeof e==='function'&&(this[b+2]=e)}return this._setLength(a+1),a},b.prototype._setProxyHandlers=function(c,d){var a=this._length();if(a>=131066&&(a=0,this._setLength(0)),a===0)this._promise0=d,this._receiver0=c;else{var b=a*5-5;this[b+3]=d,this[b+4]=c}this._setLength(a+1)},b.prototype._proxyPromiseArray=function(a,b){this._setProxyHandlers(a,b)},b.prototype._resolveCallback=function(f,i){if(this._isFollowingOrFulfilledOrRejected())return;if(f===this)return this._rejectCallback(l(),!1,!0);var c=d(f,this);if(!(c instanceof b))return this._fulfill(f);var g=i?5:1;this._propagateFrom(c,g);var a=c._target();if(a._isPending()){var h=this._length();for(var e=0;e<h;++e)a._migrateCallbacks(this,e);this._setFollowing(),this._setLength(0),this._setFollowee(a)}else a._isFulfilled()?this._fulfillUnchecked(a._value()):this._rejectUnchecked(a._reason(),a._getCarriedStackTrace())},b.prototype._rejectCallback=function(a,d,f){f||e.markAsOriginatingFromRejection(a);var b=e.ensureErrorObject(a),c=b===a;this._attachExtraTrace(b,d?c:!1),this._reject(a,c?undefined:b)},b.prototype._resolveFromResolver=function(d){var a=this;this._captureStackTrace(),this._pushContext();var c=!0,b=m(d)(function(b){if(a===null)return;a._resolveCallback(b),a=null},function(b){if(a===null)return;a._rejectCallback(b,c),a=null});c=!1,this._popContext(),b!==undefined&&b===p&&a!==null&&(a._rejectCallback(b.e,!0,!0),a=null)},b.prototype._settlePromiseFromHandler=function(c,d,e,b){if(b._isRejected())return;b._pushContext();var a;if(d===q&&!this._isRejected()?a=m(c).apply(this._boundTo,e):a=m(c).call(d,e),b._popContext(),a===p||a===b||a===o){var f=a===b?l():a.e;b._rejectCallback(f,!1,!0)}else b._resolveCallback(a)},b.prototype._target=function(){var a=this;while(a._isFollowing())a=a._followee();return a},b.prototype._followee=function(){return this._rejectionHandler0},b.prototype._setFollowee=function(a){this._rejectionHandler0=a},b.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=undefined)},b.prototype._propagateFrom=function(a,b){(b&1)>0&&a._cancellable()&&(this._setCancellable(),this._cancellationParent=a),(b&4)>0&&a._isBound()&&this._setBoundTo(a._boundTo)},b.prototype._fulfill=function(a){if(this._isFollowingOrFulfilledOrRejected())return;this._fulfillUnchecked(a)},b.prototype._reject=function(a,b){if(this._isFollowingOrFulfilledOrRejected())return;this._rejectUnchecked(a,b)},b.prototype._settlePromiseAt=function(c){var a=this._promiseAt(c),g=a instanceof b;if(g&&a._isMigrated())return a._unsetIsMigrated(),h.invoke(this._settlePromiseAt,this,c);var i=this._isFulfilled()?this._fulfillmentHandlerAt(c):this._rejectionHandlerAt(c),j=this._isCarryingStackTrace()?this._getCarriedStackTrace():undefined,d=this._settledValue,e=this._receiverAt(c);this._clearCallbackDataAtIndex(c),typeof i==='function'?g?this._settlePromiseFromHandler(i,e,d,a):i.call(e,d,a):e instanceof f?e._isResolved()||(this._isFulfilled()?e._promiseFulfilled(d,a):e._promiseRejected(d,a)):g&&(this._isFulfilled()?a._fulfill(d):a._reject(d,j)),c>=4&&(c&31)===4&&h.invokeLater(this._setLength,this,0)},b.prototype._clearCallbackDataAtIndex=function(b){if(b===0)this._isCarryingStackTrace()||(this._fulfillmentHandler0=undefined),this._rejectionHandler0=this._progressHandler0=this._receiver0=this._promise0=undefined;else{var a=b*5-5;this[a+3]=this[a+4]=this[a+0]=this[a+1]=this[a+2]=undefined}},b.prototype._isSettlePromisesQueued=function(){return(this._bitField&-1073741824)===-1073741824},b.prototype._setSettlePromisesQueued=function(){this._bitField=this._bitField|-1073741824},b.prototype._unsetSettlePromisesQueued=function(){this._bitField=this._bitField&1073741823},b.prototype._queueSettlePromises=function(){h.settlePromises(this),this._setSettlePromisesQueued()},b.prototype._fulfillUnchecked=function(b){if(b===this){var a=l();return this._attachExtraTrace(a),this._rejectUnchecked(a,undefined)}this._setFulfilled(),this._settledValue=b,this._cleanValues(),this._length()>0&&this._queueSettlePromises()},b.prototype._rejectUncheckedCheckError=function(a){var b=e.ensureErrorObject(a);this._rejectUnchecked(a,b===a?undefined:b)},b.prototype._rejectUnchecked=function(b,a){if(b===this){var c=l();return this._attachExtraTrace(c),this._rejectUnchecked(c)}if(this._setRejected(),this._settledValue=b,this._cleanValues(),this._isFinal()){h.throwLater(function(a){throw'stack'in a&&h.invokeFirst(n.unhandledRejection,undefined,a),a},a===undefined?b:a);return}a!==undefined&&a!==b&&this._setCarriedStackTrace(a),this._length()>0?this._queueSettlePromises():this._ensurePossibleRejectionHandled()},b.prototype._settlePromises=function(){this._unsetSettlePromisesQueued();var b=this._length();for(var a=0;a<b;a++)this._settlePromiseAt(a)},b._makeSelfResolutionError=l,a('./progress.js')(b,f),a('./method.js')(b,c,d,g),a('./bind.js')(b,c,d),a('./finally.js')(b,o,d),a('./direct_resolve.js')(b),a('./synchronous_inspection.js')(b),a('./join.js')(b,f,d,c),b.Promise=b,a('./map.js')(b,f,g,d,c),a('./cancel.js')(b),a('./using.js')(b,g,d,w),a('./generators.js')(b,g,c,d),a('./nodeify.js')(b),a('./call_get.js')(b),a('./props.js')(b,f,d,g),a('./race.js')(b,c,d,g),a('./reduce.js')(b,f,g,d,c),a('./settle.js')(b,f),a('./some.js')(b,f,g),a('./promisify.js')(b,c),a('./any.js')(b),a('./each.js')(b,c),a('./timers.js')(b,c),a('./filter.js')(b,c),e.toFastProperties(b),e.toFastProperties(b.prototype),j({a:1}),j({b:2}),j({c:3}),j(1),j(function(){}),j(undefined),j(!1),j(new b(c)),n.setBounds(h.firstLineError,e.lastLineError),b}},{'./any.js':1,'./async.js':2,'./bind.js':3,'./call_get.js':5,'./cancel.js':6,'./captured_trace.js':7,'./catch_filter.js':8,'./context.js':9,'./debuggability.js':10,'./direct_resolve.js':11,'./each.js':12,'./errors.js':13,'./filter.js':15,'./finally.js':16,'./generators.js':17,'./join.js':18,'./map.js':19,'./method.js':20,'./nodeify.js':21,'./progress.js':22,'./promise_array.js':24,'./promise_resolver.js':25,'./promisify.js':26,'./props.js':27,'./race.js':29,'./reduce.js':30,'./settle.js':32,'./some.js':33,'./synchronous_inspection.js':34,'./thenables.js':35,'./timers.js':36,'./using.js':37,'./util.js':38}],24:[function(a,b,c){'use strict';b.exports=function(c,g,e,h){function i(a){switch(a){case-2:return[];case-3:return{}}}function b(a){var b=this._promise=new c(g),d;a instanceof c&&(d=a,b._propagateFrom(d,5)),this._values=a,this._length=0,this._totalResolved=0,this._init(undefined,-2)}var f=a('./util.js'),d=f.isArray;return b.prototype.length=function(){return this._length},b.prototype.promise=function(){return this._promise},b.prototype._init=function a(o,k){var b=e(this._values,this._promise);if(b instanceof c){if(b=b._target(),this._values=b,!b._isFulfilled())if(b._isPending()){b._then(a,this._reject,undefined,this,k);return}else{this._reject(b._reason());return}if(b=b._value(),!d(b)){var m=new c.TypeError('expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n');this.__hardReject__(m);return}}else if(!d(b)){this._promise._reject(h('expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n')._reason());return}if(b.length===0){k===-5?this._resolveEmptyArray():this._resolve(i(k));return}var j=this.getActualLength(b.length);this._length=j,this._values=this.shouldCopyValues()?new Array(j):this._values;var n=this._promise;for(var g=0;g<j;++g){var l=this._isResolved(),f=e(b[g],n);f instanceof c?(f=f._target(),l?f._ignoreRejections():f._isPending()?f._proxyPromiseArray(this,g):f._isFulfilled()?this._promiseFulfilled(f._value(),g):this._promiseRejected(f._reason(),g)):l||this._promiseFulfilled(f,g)}},b.prototype._isResolved=function(){return this._values===null},b.prototype._resolve=function(a){this._values=null,this._promise._fulfill(a)},b.prototype.__hardReject__=b.prototype._reject=function(a){this._values=null,this._promise._rejectCallback(a,!1,!0)},b.prototype._promiseProgressed=function(a,b){this._promise._progress({index:b,value:a})},b.prototype._promiseFulfilled=function(b,c){this._values[c]=b;var a=++this._totalResolved;a>=this._length&&this._resolve(this._values)},b.prototype._promiseRejected=function(a,b){this._totalResolved++,this._reject(a)},b.prototype.shouldCopyValues=function(){return!0},b.prototype.getActualLength=function(a){return a},b}},{'./util.js':38}],25:[function(g,o,p){'use strict';function n(a){return a instanceof Error&&b.getPrototypeOf(a)===Error.prototype}function m(a){var d;if(n(a)){d=new l(a),d.name=a.name,d.message=a.message,d.stack=a.stack;var g=b.keys(a);for(var e=0;e<g.length;++e){var f=g[e];j.test(f)||(d[f]=a[f])}return d}return c.markAsOriginatingFromRejection(a),a}function f(a){return function(f,g){if(a===null)return;if(f){var c=m(i(f));a._attachExtraTrace(c),a._reject(c)}else if(arguments.length>2){var d=arguments.length,e=new Array(d-1);for(var b=1;b<d;++b)e[b-1]=arguments[b];a._fulfill(e)}else a._fulfill(g);a=null}}var c=g('./util.js'),i=c.maybeWrapAsError,h=g('./errors.js'),k=h.TimeoutError,l=h.OperationalError,e=c.haveGetters,b=g('./es5.js'),j=/^(?:name|message|stack|cause)$/,a;if(e?a=function(a){this.promise=a}:a=function(a){this.promise=a,this.asCallback=f(a),this.callback=this.asCallback},e){var d={get:function(){return f(this.promise)}};b.defineProperty(a.prototype,'asCallback',d),b.defineProperty(a.prototype,'callback',d)}a._nodebackForPromise=f,a.prototype.toString=function(){return'[object PromiseResolver]'},a.prototype.resolve=a.prototype.fulfill=function(b){if(!(this instanceof a))throw new TypeError('Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n');this.promise._resolveCallback(b)},a.prototype.reject=function(b){if(!(this instanceof a))throw new TypeError('Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n');this.promise._rejectCallback(b)},a.prototype.progress=function(b){if(!(this instanceof a))throw new TypeError('Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n');this.promise._progress(b)},a.prototype.cancel=function(a){this.promise.cancel(a)},a.prototype.timeout=function(){this.reject(new k('timeout'))},a.prototype.isResolved=function(){return this.promise.isResolved()},a.prototype.toJSON=function(){return this.promise.toJSON()},o.exports=a},{'./errors.js':13,'./es5.js':14,'./util.js':38}],26:[function(a,b,c){'use strict';b.exports=function(h,r){function v(a){return!o.test(a)}function i(a){try{return a.__isPromisified__===!0}catch(a){return!1}}function t(c,d,e){var a=b.getDataPropertyOrDefault(c,d+e,n);return a?i(a):!1}function u(a,h,f){for(var b=0;b<a.length;b+=2){var d=a[b];if(f.test(d)){var g=d.replace(f,'');for(var c=0;c<a.length;c+=2)if(a[c]===g)throw new e("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/iWrZbw\n".replace('%s',h))}}}function w(d,l,m,k){var h=b.inheritedDataKeys(d),e=[];for(var g=0;g<h.length;++g){var c=h[g],a=d[c],j=k===f?!0:f(c,a,d);typeof a==='function'&&!b.isNativeFunctionMethod(a)&&!i(a)&&!t(d,c,l)&&k(c,a,d,j)&&e.push(c,a)}return u(e,l,m),e}function x(c,e,j,i){function f(){var f=e;e===d&&(f=this);var b=new h(r);b._captureStackTrace();var i=typeof a==='string'&&this!==g?this[a]:c,j=k(b);try{i.apply(f,l(arguments,j))}catch(a){b._rejectCallback(p(a),!0,!0)}return b}var g=function(){return this}(),a=c;return typeof a==='string'&&(c=i),b.notEnumerableProp(f,'__isPromisified__',!0),f}function g(i,e,n,k){var m=new RegExp(q(e)+'$'),g=w(i,e,m,n);for(var f=0,l=g.length;f<l;f+=2){var a=g[f],h=g[f+1],j=a+e;i[j]=k===c?c(a,d,a,h,e):k(h,function(){return c(a,d,a,h,e)})}return b.toFastProperties(i),i}function s(a,b){return c(a,b,undefined,a)}var d={},b=a('./util.js'),k=a('./promise_resolver.js')._nodebackForPromise,l=b.withAppended,p=b.maybeWrapAsError,j=b.canEvaluate,e=a('./errors').TypeError,m='Async',n={__isPromisified__:!0},o=/^(?:length|name|arguments|caller|callee|prototype|__isPromisified__)$/,f=function(a){return b.isIdentifier(a)&&a.charAt(0)!=='_'&&a!=='constructor'},q=function(a){return a.replace(/([$])/,'\\$')},y,c=j?y:x;h.promisify=function(a,f){if(typeof a!=='function')throw new e('fn must be a function\n\n    See http://goo.gl/916lJJ\n');if(i(a))return a;var c=s(a,arguments.length<2?d:f);return b.copyDescriptors(a,c,v),c},h.promisifyAll=function(i,j){if(typeof i!=='function'&&typeof i!=='object')throw new e('the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/9ITlV0\n');j=Object(j);var a=j.suffix;typeof a!=='string'&&(a=m);var d=j.filter;typeof d!=='function'&&(d=f);var h=j.promisifier;if(typeof h!=='function'&&(h=c),!b.isIdentifier(a))throw new RangeError('suffix must be a valid identifier\n\n    See http://goo.gl/8FZo5V\n');var l=b.inheritedDataKeys(i);for(var k=0;k<l.length;++k){var n=i[l[k]];l[k]!=='constructor'&&b.isClass(n)&&(g(n.prototype,a,d,h),g(n,a,d,h))}return g(i,a,d,h)}}},{'./errors':13,'./promise_resolver.js':25,'./util.js':38}],27:[function(a,b,c){'use strict';b.exports=function(c,h,i,j){function b(f){var d=g.keys(f),b=d.length,c=new Array(b*2);for(var a=0;a<b;++a){var e=d[a];c[a]=f[e],c[a+b]=e}this.constructor$(c)}function e(e){var d,a=i(e);return f(a)?(a instanceof c?d=a._then(c.props,undefined,undefined,undefined,undefined):d=new b(a).promise(),a instanceof c&&d._propagateFrom(a,4),d):j('cannot await properties of a non-object\n\n    See http://goo.gl/OsFKC8\n')}var d=a('./util.js'),f=d.isObject,g=a('./es5.js');d.inherits(b,h),b.prototype._init=function(){this._init$(undefined,-3)},b.prototype._promiseFulfilled=function(f,g){this._values[g]=f;var c=++this._totalResolved;if(c>=this._length){var b={},d=this.length();for(var a=0,e=this.length();a<e;++a)b[this._values[a+d]]=this._values[a];this._resolve(b)}},b.prototype._promiseProgressed=function(a,b){this._promise._progress({key:this._values[b+this.length()],value:a})},b.prototype.shouldCopyValues=function(){return!1},b.prototype.getActualLength=function(a){return a>>1},c.prototype.props=function(){return e(this)},c.props=function(a){return e(a)}}},{'./es5.js':14,'./util.js':38}],28:[function(d,b,e){'use strict';function c(b,c,d,e,f){for(var a=0;a<f;++a)d[a+e]=b[a+c],b[a+c]=void 0}function a(a){this._capacity=a,this._length=0,this._front=0}a.prototype._willBeOverCapacity=function(a){return this._capacity<a},a.prototype._pushOne=function(c){var a=this.length();this._checkCapacity(a+1);var b=this._front+a&this._capacity-1;this[b]=c,this._length=a+1},a.prototype._unshiftOne=function(d){var a=this._capacity;this._checkCapacity(this.length()+1);var c=this._front,b=(c-1&a-1^a)-a;this[b]=d,this._front=b,this._length=this.length()+1},a.prototype.unshift=function(a,b,c){this._unshiftOne(c),this._unshiftOne(b),this._unshiftOne(a)},a.prototype.push=function(d,e,f){var a=this.length()+3;if(this._willBeOverCapacity(a)){this._pushOne(d),this._pushOne(e),this._pushOne(f);return}var b=this._front+a-3;this._checkCapacity(a);var c=this._capacity-1;this[b+0&c]=d,this[b+1&c]=e,this[b+2&c]=f,this._length=a},a.prototype.shift=function(){var a=this._front,b=this[a];return this[a]=undefined,this._front=a+1&this._capacity-1,this._length--,b},a.prototype.length=function(){return this._length},a.prototype._checkCapacity=function(a){this._capacity<a&&this._resizeTo(this._capacity<<1)},a.prototype._resizeTo=function(f){var a=this._capacity;this._capacity=f;var b=this._front,d=this._length,e=b+d&a-1;c(this,0,this,a,e)},b.exports=a},{}],29:[function(a,b,c){'use strict';b.exports=function(b,f,g,h){function c(c,l){var j=g(c);if(j instanceof b)return e(j);if(!d(c))return h('expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n');var a=new b(f);l!==undefined&&a._propagateFrom(l,5);var m=a._fulfill,n=a._reject;for(var i=0,o=c.length;i<o;++i){var k=c[i];if(k===undefined&&!(i in c))continue;b.cast(k)._then(m,n,undefined,a,null)}return a}var d=a('./util.js').isArray,e=function(a){return a.then(function(b){return c(b,a)})};b.race=function(a){return c(a,undefined)},b.prototype.race=function(){return c(this,undefined)}}},{'./util.js':38}],30:[function(a,b,c){'use strict';b.exports=function(d,m,l,f,k){function b(h,i,b,l){this.constructor$(h),this._promise._captureStackTrace(),this._preservedValues=l===k?[]:null,this._zerothIsAccum=b===undefined,this._gotAccum=!1,this._reducingIndex=this._zerothIsAccum?1:0,this._valuesPhase=undefined;var a=f(b,this._promise),c=!1,e=a instanceof d;e&&(a=a._target(),a._isPending()?a._proxyPromiseArray(this,-1):a._isFulfilled()?(b=a._value(),this._gotAccum=!0):(this._reject(a._reason()),c=!0)),e||this._zerothIsAccum||(this._gotAccum=!0),this._callback=i,this._accum=b,c||g.invoke(j,this,undefined)}function j(){this._init$(undefined,-5)}function i(d,a,e,f){if(typeof a!=='function')return l('fn must be a function\n\n    See http://goo.gl/916lJJ\n');var c=new b(d,a,e,f);return c.promise()}var g=a('./async.js'),c=a('./util.js'),e=c.tryCatch,h=c.errorObj;c.inherits(b,m),b.prototype._init=function(){},b.prototype._resolveEmptyArray=function(){(this._gotAccum||this._zerothIsAccum)&&this._resolve(this._preservedValues!==null?[]:this._accum)},b.prototype._promiseFulfilled=function(i,j){var r=this._values;r[j]=i;var l=this.length(),n=this._preservedValues,q=n!==null,m=this._gotAccum,b=this._valuesPhase,c;if(!b)for(b=this._valuesPhase=new Array(l),c=0;c<l;++c)b[c]=0;if(c=b[j],j===0&&this._zerothIsAccum?(this._accum=i,this._gotAccum=m=!0,b[j]=c===0?1:2):j===-1?(this._accum=i,this._gotAccum=m=!0):c===0?b[j]=1:(b[j]=2,this._accum=i),!m)return;var o=this._callback,p=this._promise._boundTo,k;for(var a=this._reducingIndex;a<l;++a){if(c=b[a],c===2){this._reducingIndex=a+1;continue}if(c!==1)return;if(i=r[a],this._promise._pushContext(),q?(n.push(i),k=e(o).call(p,i,a,l)):k=e(o).call(p,this._accum,i,a,l),this._promise._popContext(),k===h)return this._reject(k.e);var g=f(k,this._promise);if(g instanceof d){if(g=g._target(),g._isPending())return b[a]=4,g._proxyPromiseArray(this,a);if(!g._isFulfilled())return this._reject(g._reason());k=g._value()}this._reducingIndex=a+1,this._accum=k}this._resolve(q?n:this._accum)},d.prototype.reduce=function(a,b){return i(this,a,b,null)},d.reduce=function(a,b,c,d){return i(a,b,c,d)}}},{'./async.js':2,'./util.js':38}],31:[function(h,i,j){'use strict';var a,d=h('./util'),e=function(){throw new Error('No async scheduler available\n\n    See http://goo.gl/m3OTXk\n')};if(d.isNode&&typeof MutationObserver==='undefined'){var f=c.setImmediate,g=b.nextTick;a=d.isRecentNode?function(a){f.call(c,a)}:function(a){g.call(b,a)}}else typeof MutationObserver!=='undefined'?(a=function(c){var a=document.createElement('div'),b=new MutationObserver(c);return b.observe(a,{attributes:!0}),function(){a.classList.toggle('foo')}},a.isStatic=!0):typeof setImmediate!=='undefined'?a=function(a){setImmediate(a)}:typeof setTimeout!=='undefined'?a=function(a){setTimeout(a,0)}:a=e;i.exports=a},{'./util':38}],32:[function(a,b,c){'use strict';b.exports=function(c,f){function b(a){this.constructor$(a)}var d=c.PromiseInspection,e=a('./util.js');e.inherits(b,f),b.prototype._promiseResolved=function(b,c){this._values[b]=c;var a=++this._totalResolved;a>=this._length&&this._resolve(this._values)},b.prototype._promiseFulfilled=function(b,c){var a=new d;a._bitField=268435456,a._settledValue=b,this._promiseResolved(c,a)},b.prototype._promiseRejected=function(b,c){var a=new d;a._bitField=134217728,a._settledValue=b,this._promiseResolved(c,a)},c.settle=function(a){return new b(a).promise()},c.prototype.settle=function(){return new b(this).promise()}}},{'./util.js':38}],33:[function(a,b,c){'use strict';b.exports=function(c,i,j){function b(a){this.constructor$(a),this._howMany=0,this._unwrap=!1,this._initialized=!1}function e(e,a){if((a|0)!==a||a<0)return j('expecting a positive integer\n\n    See http://goo.gl/1wAmHx\n');var c=new b(e),d=c.promise();return c.setHowMany(a),c.init(),d}var d=a('./util.js'),f=a('./errors.js').RangeError,g=a('./errors.js').AggregateError,h=d.isArray;d.inherits(b,i),b.prototype._init=function(){if(!this._initialized)return;if(this._howMany===0){this._resolve([]);return}this._init$(undefined,-5);var a=h(this._values);!this._isResolved()&&a&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))},b.prototype.init=function(){this._initialized=!0,this._init()},b.prototype.setUnwrap=function(){this._unwrap=!0},b.prototype.howMany=function(){return this._howMany},b.prototype.setHowMany=function(a){this._howMany=a},b.prototype._promiseFulfilled=function(a){this._addFulfilled(a),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),this.howMany()===1&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values))},b.prototype._promiseRejected=function(c){if(this._addRejected(c),this.howMany()>this._canPossiblyFulfill()){var b=new g;for(var a=this.length();a<this._values.length;++a)b.push(this._values[a]);this._reject(b)}},b.prototype._fulfilled=function(){return this._totalResolved},b.prototype._rejected=function(){return this._values.length-this.length()},b.prototype._addRejected=function(a){this._values.push(a)},b.prototype._addFulfilled=function(a){this._values[this._totalResolved++]=a},b.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},b.prototype._getRangeError=function(b){var a='Input array must contain at least '+this._howMany+' items but contains only '+b+' items';return new f(a)},b.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},c.some=function(a,b){return e(a,b)},c.prototype.some=function(a){return e(this,a)},c._SomePromiseArray=b}},{'./errors.js':13,'./util.js':38}],34:[function(b,a,c){'use strict';a.exports=function(a){function b(a){a!==undefined?(a=a._target(),this._bitField=a._bitField,this._settledValue=a._settledValue):(this._bitField=0,this._settledValue=undefined)}b.prototype.value=function(){if(!this.isFulfilled())throw new TypeError('cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n');return this._settledValue},b.prototype.error=b.prototype.reason=function(){if(!this.isRejected())throw new TypeError('cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n');return this._settledValue},b.prototype.isFulfilled=a.prototype._isFulfilled=function(){return(this._bitField&268435456)>0},b.prototype.isRejected=a.prototype._isRejected=function(){return(this._bitField&134217728)>0},b.prototype.isPending=a.prototype._isPending=function(){return(this._bitField&402653184)===0},b.prototype.isResolved=a.prototype._isResolved=function(){return(this._bitField&402653184)>0},a.prototype.isPending=function(){return this._target()._isPending()},a.prototype.isRejected=function(){return this._target()._isRejected()},a.prototype.isFulfilled=function(){return this._target()._isFulfilled()},a.prototype.isResolved=function(){return this._target()._isResolved()},a.prototype._value=function(){return this._settledValue},a.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue},a.prototype.value=function(){var a=this._target();if(!a.isFulfilled())throw new TypeError('cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n');return a._settledValue},a.prototype.reason=function(){var a=this._target();if(!a.isRejected())throw new TypeError('cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n');return a._unsetRejectionIsUnhandled(),a._settledValue},a.PromiseInspection=b}},{}],35:[function(a,b,c){'use strict';b.exports=function(b,f){function i(e,i){if(g(e)){if(e instanceof b)return e;if(k(e)){var a=new b(f);return e._then(a._fulfillUnchecked,a._rejectUncheckedCheckError,a._progressUnchecked,a,null),a}var l=c.tryCatch(j)(e);if(l===d){i&&i._pushContext();var a=b.reject(l.e);return i&&i._popContext(),a}if(typeof l==='function')return h(e,l,i)}return e}function j(a){return a.then}function k(a){return e.call(a,'_promise0')}function h(i,n,e){function m(c){if(!a)return;i===c?a._rejectCallback(b._makeSelfResolutionError(),!1,!0):a._resolveCallback(c),a=null}function l(b){if(!a)return;a._rejectCallback(b,h,!0),a=null}function k(b){if(!a)return;typeof a._progress==='function'&&a._progress(b)}var a=new b(f),j=a;e&&e._pushContext(),a._captureStackTrace(),e&&e._popContext();var h=!0,g=c.tryCatch(n).call(i,m,l,k);return h=!1,a&&g===d&&(a._rejectCallback(g.e,!0,!0),a=null),j}var c=a('./util.js'),d=c.errorObj,g=c.isObject,e={}.hasOwnProperty;return i}},{'./util.js':38}],36:[function(a,b,c){'use strict';b.exports=function(b,h){function i(b){var a=this;return a instanceof Number&&(a=+a),clearTimeout(a),b}function j(b){var a=this;throw a instanceof Number&&(a=+a),clearTimeout(a),b}var d=a('./util.js'),e=b.TimeoutError,f=function(b,c){if(!b.isPending())return;typeof c!=='string'&&(c='operation timed out');var a=new e(c);d.markAsOriginatingFromRejection(a),b._attachExtraTrace(a),b._cancel(a)},g=function(a){return c(+this).thenReturn(a)},c=b.delay=function(c,a){if(a===undefined){a=c,c=undefined;var d=new b(h);return setTimeout(function(){d._fulfill()},a),d}return a=+a,b.resolve(c)._then(g,null,null,a,undefined)};b.prototype.delay=function(a){return c(this,a)},b.prototype.timeout=function(b,d){b=+b;var a=this.then().cancellable();a._cancellationParent=this;var c=setTimeout(function b(){f(a,d)},b);return a._then(i,j,undefined,c,undefined)}}},{'./util.js':38}],37:[function(a,b,c){'use strict';b.exports=function(b,i,e,q){function p(c){var e=c.length;for(var a=0;a<e;++a){var d=c[a];if(d.isRejected())return b.reject(d.error());c[a]=d._settledValue}return c}function h(a){setTimeout(function(){throw a},0)}function n(a){var b=e(a);return b!==a&&typeof a._isDisposable==='function'&&typeof a._getDisposer==='function'&&a._isDisposable()&&b._setDisposable(a._getDisposer()),b}function j(a,i){function c(){if(d>=g)return f.resolve();var j=n(a[d++]);if(j instanceof b&&j._isDisposable()){try{j=e(j._getDisposer().tryDispose(i),a.promise)}catch(a){return h(a)}if(j instanceof b)return j._then(c,h,null,null,null)}c()}var d=0,g=a.length,f=b.defer();return c(),f.promise}function m(b){var a=new d;return a._settledValue=b,a._bitField=268435456,j(this,a).thenReturn(b)}function l(b){var a=new d;return a._settledValue=b,a._bitField=134217728,j(this,a).thenThrow(b)}function c(a,b,c){this._data=a,this._promise=b,this._context=c}function f(a,b,c){this.constructor$(a,b,c)}function o(a){return c.isDisposer(a)?(this.resources[this.index]._setDisposable(a),a.promise()):a}var g=a('./errors.js').TypeError,k=a('./util.js').inherits,d=b.PromiseInspection;c.prototype.data=function(){return this._data},c.prototype.promise=function(){return this._promise},c.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},c.prototype.tryDispose=function(d){var b=this.resource(),a=this._context;a!==undefined&&a._pushContext();var c=b!==null?this.doDispose(b,d):null;return a!==undefined&&a._popContext(),this._promise._unsetDisposable(),this._data=null,c},c.isDisposer=function(a){return a!=null&&typeof a.resource==='function'&&typeof a.tryDispose==='function'},k(f,c),f.prototype.doDispose=function(a,c){var b=this.data();return b.call(a,a,c)},b.using=function(){var d=arguments.length;if(d<2)return i('you must pass at least 2 arguments to Promise.using');var j=arguments[d-1];if(typeof j!=='function')return i('fn must be a function\n\n    See http://goo.gl/916lJJ\n');d--;var f=new Array(d);for(var g=0;g<d;++g){var a=arguments[g];if(c.isDisposer(a)){var n=a;a=a.promise(),a._setDisposable(n)}else{var k=e(a);k instanceof b&&(a=k._then(o,null,null,{resources:f,index:g},undefined))}f[g]=a}var h=b.settle(f).then(p).then(function(b){h._pushContext();var a;try{a=j.apply(undefined,b)}finally{h._popContext()}return a})._then(m,l,undefined,f,undefined);return f.promise=h,h},b.prototype._setDisposable=function(a){this._bitField=this._bitField|262144,this._disposer=a},b.prototype._isDisposable=function(){return(this._bitField&262144)>0},b.prototype._getDisposer=function(){return this._disposer},b.prototype._unsetDisposable=function(){this._bitField=this._bitField&-262145,this._disposer=undefined},b.prototype.disposer=function(a){if(typeof a==='function')return new f(a,this,q());throw new g}}},{'./errors.js':13,'./util.js':38}],38:[function(t,J,I){'use strict';function C(){try{return n.apply(this,arguments)}catch(a){return d.e=a,d}}function s(a){return n=a,C}function e(a){return a==null||a===!0||a===!1||typeof a==='string'||typeof a==='number'}function w(a){return!e(a)}function z(a){return e(a)?new Error(f(a)):a}function A(d,e){var c=d.length,b=new Array(c+1),a;for(a=0;a<c;++a)b[a]=d[a];return b[a]=e,b}function B(c,d,e){if(!a.isES5)return{}.hasOwnProperty.call(c,d)?c[d]:undefined;var b=Object.getOwnPropertyDescriptor(c,d);return b!=null?b.get==null&&b.set==null?b.value:e:void 0}function m(b,d,f){if(e(b))return b;var c={value:f,configurable:!0,enumerable:!1,writable:!0};return a.defineProperty(b,d,c),b}function D(a){throw a}function E(c){try{if(typeof c==='function'){var b=a.names(c.prototype);if(a.isES5&&b.length>1||b.length>0&&!(b.length===1&&b[0]==='constructor')||r.test(c+''))return!0}return!1}catch(a){return!1}}function F(a){function b(){}b.prototype=a;var c=8;while(c--)new b;return a}function G(a){return h.test(a)}function H(c,d,e){var b=new Array(c);for(var a=0;a<c;++a)b[a]=d+a+e;return b}function f(a){try{return a+''}catch(a){return'[no string representation]'}}function v(a){try{m(a,'isOperational',!0)}catch(a){}}function u(a){return a==null?!1:a instanceof Error.__BluebirdErrorTypes__.OperationalError||a.isOperational===!0}function g(b){return b instanceof Error&&a.propertyIsWritable(b,'stack')}function i(a){return{}.toString.call(a)}function x(e,f,g){var d=a.names(e);for(var b=0;b<d.length;++b){var c=d[b];g(c)&&a.defineProperty(f,c,a.getDescriptor(e,c))}}function y(a){return a===a.call||a===a.toString||a===a.bind||a===a.apply}var a=t('./es5.js'),k=typeof navigator=='undefined',l=function(b){try{return b={},a.defineProperty(b,'f',{get:function(){return 3}}),b.f===3}catch(a){return!1}}(),d={e:{}},n,o=function(b,a){function c(){this.constructor=b,this.constructor$=a;for(var c in a.prototype)d.call(a.prototype,c)&&c.charAt(c.length-1)!=='$'&&(this[c+'$']=a.prototype[c])}var d={}.hasOwnProperty;return c.prototype=a.prototype,b.prototype=new c,b.prototype},p=function(){return this!=='string'}.call('string'),q=function(b,c){return a.isES5?(b=Object.prototype,c=Object.getOwnPropertyNames,function(d){var f=[],i=Object.create(null);while(d!=null&&d!==b){var j;try{j=c(d)}catch(a){return f}for(var g=0;g<j.length;++g){var e=j[g];if(i[e])continue;i[e]=!0;var h=Object.getOwnPropertyDescriptor(d,e);h!=null&&h.get==null&&h.set==null&&f.push(e)}d=a.getPrototypeOf(d)}return f}):function(c){var a=[];for(var b in c)a.push(b);return a}}(),r=/this\s*\.\s*\S+\s*=/,h=/^[a-z$_][a-z$_0-9]*$/i,j=function(){return'stack'in new Error?function(a){return g(a)?a:new Error(f(a))}:function(a){if(g(a))return a;try{throw new Error(f(a))}catch(a){return a}}}(),c={isClass:E,isIdentifier:G,inheritedDataKeys:q,getDataPropertyOrDefault:B,thrower:D,isArray:a.isArray,haveGetters:l,notEnumerableProp:m,isPrimitive:e,isObject:w,canEvaluate:k,errorObj:d,tryCatch:s,inherits:o,withAppended:A,maybeWrapAsError:z,wrapsPrimitiveReceiver:p,toFastProperties:F,filledRange:H,toString:f,canAttachTrace:g,ensureErrorObject:j,originatesFromRejection:u,markAsOriginatingFromRejection:v,classString:i,copyDescriptors:x,hasDevTools:typeof chrome!=='undefined'&&chrome&&typeof chrome.loadTimes==='function',isNode:b!==void 0&&i(b).toLowerCase()==='[object process]',isNativeFunctionMethod:y};c.isRecentNode=c.isNode&&function(a){return a=b.versions.node.split('.').map(Number),a[0]===0&&a[1]>10||a[0]>0}();try{throw new Error}catch(a){c.lastLineError=a}},{'./es5.js':14}],39:[function(g,e,h){function a(){this._events=this._events||{},this._maxListeners=this._maxListeners||undefined}function b(a){return typeof a==='function'}function f(a){return typeof a==='number'}function c(a){return typeof a==='object'&&a!==null}function d(a){return a===void 0}e.exports=a,a.EventEmitter=a,a.prototype._events=undefined,a.prototype._maxListeners=undefined,a.defaultMaxListeners=10,a.prototype.setMaxListeners=function(a){if(!f(a)||a<0||isNaN(a))throw TypeError('n must be a positive number');return this._maxListeners=a,this},a.prototype.emit=function(j){var h,e,f,g,a,i;if(this._events||(this._events={}),j==='error'&&(!this._events.error||c(this._events.error)&&!this._events.error.length)){if(h=arguments[1],h instanceof Error)throw h;throw TypeError('Uncaught, unspecified "error" event.')}if(e=this._events[j],d(e))return!1;if(b(e))switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:f=arguments.length;g=new Array(f-1);for(a=1;a<f;a++)g[a-1]=arguments[a];e.apply(this,g)}else if(c(e)){for(f=arguments.length,g=new Array(f-1),a=1;a<f;a++)g[a-1]=arguments[a];for(i=e.slice(),f=i.length,a=0;a<f;a++)i[a].apply(this,g)}return!0},a.prototype.addListener=function(e,f){var g;if(!b(f))throw TypeError('listener must be a function');if(this._events||(this._events={}),this._events.newListener&&this.emit('newListener',e,b(f.listener)?f.listener:f),this._events[e]?c(this._events[e])?this._events[e].push(f):this._events[e]=[this._events[e],f]:this._events[e]=f,c(this._events[e])&&!this._events[e].warned){var g;d(this._maxListeners)?g=a.defaultMaxListeners:g=this._maxListeners,g&&g>0&&this._events[e].length>g&&(this._events[e].warned=!0,console.error('(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.',this._events[e].length),typeof console.trace==='function'&&console.trace())}return this},a.prototype.on=a.prototype.addListener,a.prototype.once=function(e,a){function c(){this.removeListener(e,c),d||(d=!0,a.apply(this,arguments))}if(!b(a))throw TypeError('listener must be a function');var d=!1;return c.listener=a,this.on(e,c),this},a.prototype.removeListener=function(e,d){var a,g,h,f;if(!b(d))throw TypeError('listener must be a function');if(!(this._events&&this._events[e]))return this;if(a=this._events[e],h=a.length,g=-1,a===d||b(a.listener)&&a.listener===d)delete this._events[e],this._events.removeListener&&this.emit('removeListener',e,d);else if(c(a)){for(f=h;f-->0;)if(a[f]===d||a[f].listener&&a[f].listener===d){g=f;break}if(g<0)return this;a.length===1?(a.length=0,delete this._events[e]):a.splice(g,1),this._events.removeListener&&this.emit('removeListener',e,d)}return this},a.prototype.removeAllListeners=function(a){var d,c;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[a]&&delete this._events[a],this;if(arguments.length===0){for(d in this._events){if(d==='removeListener')continue;this.removeAllListeners(d)}return this.removeAllListeners('removeListener'),this._events={},this}if(c=this._events[a],b(c))this.removeListener(a,c);else while(c.length)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},a.prototype.listeners=function(a){var c;return this._events&&this._events[a]?b(this._events[a])?c=[this._events[a]]:c=this._events[a].slice():c=[],c},a.listenerCount=function(a,d){var c;return a._events&&a._events[d]?b(a._events[d])?c=1:c=a._events[d].length:c=0,c}},{}]},{},[4])(4)}),typeof window!=='undefined'&&window!==null?window.P=window.Promise:typeof self!=='undefined'&&self!==null&&(self.P=self.Promise)}),a.define('xhr-promise/node_modules/extend',function(f,g,h,i){var a=Object.prototype.hasOwnProperty,b=Object.prototype.toString,e,c=function a(c){return typeof Array.isArray==='function'?Array.isArray(c):b.call(c)==='[object Array]'},d=function c(d){'use strict';if(!d||b.call(d)!=='[object Object]')return!1;var g=a.call(d,'constructor'),h=d.constructor&&d.constructor.prototype&&a.call(d.constructor.prototype,'isPrototypeOf');if(d.constructor&&!g&&!h)return!1;var f;for(f in d);return f===e||a.call(d,f)};f.exports=function a(){'use strict';var k,h,g,f,m,l,b=arguments[0],i=1,n=arguments.length,j=!1;for(typeof b==='boolean'?(j=b,b=arguments[1]||{},i=2):(typeof b!=='object'&&typeof b!=='function'||b==null)&&(b={});i<n;++i)if(k=arguments[i],k!=null)for(h in k){if(g=b[h],f=k[h],b===f)continue;j&&f&&(d(f)||(m=c(f)))?(m?(m=!1,l=g&&c(g)?g:[]):l=g&&d(g)?g:{},b[h]=a(j,l,f)):f!==e&&(b[h]=f)}return b}}),a.define('xhr-promise/node_modules/parse-headers/parse-headers',function(e,f,g,h){var b=a('xhr-promise/node_modules/parse-headers/node_modules/trim'),c=a('xhr-promise/node_modules/parse-headers/node_modules/for-each'),d=function(a){return Object.prototype.toString.call(a)==='[object Array]'};e.exports=function(e){if(!e)return{};var a={};return c(b(e).split('\n'),function(f){var g=f.indexOf(':'),c=b(f.slice(0,g)).toLowerCase(),e=b(f.slice(g+1));a[c]===void 0?a[c]=e:d(a[c])?a[c].push(e):a[c]=[a[c],e]}),a}}),a.define('xhr-promise/node_modules/parse-headers/node_modules/trim',function(b,a,d,e){function c(a){return a.replace(/^\s*|\s*$/g,'')}a=b.exports=c,a.left=function(a){return a.replace(/^\s*/,'')},a.right=function(a){return a.replace(/\s*$/,'')}}),a.define('xhr-promise/node_modules/parse-headers/node_modules/for-each',function(h,l,k,j){function g(a,b,g){if(!d(b))throw new TypeError('iterator must be a function');arguments.length<3&&(g=this),c.call(a)==='[object Array]'?e(a,b,g):typeof a==='string'?i(a,b,g):f(a,b,g)}function e(c,e,f){for(var a=0,d=c.length;a<d;a++)b.call(c,a)&&e.call(f,c[a],a,c)}function i(b,d,e){for(var a=0,c=b.length;a<c;a++)d.call(e,b.charAt(a),a,b)}function f(a,d,e){for(var c in a)b.call(a,c)&&d.call(e,a[c],c,a)}var d=a('xhr-promise/node_modules/parse-headers/node_modules/for-each/node_modules/is-function');h.exports=g;var c=Object.prototype.toString,b=Object.prototype.hasOwnProperty}),a.define('xhr-promise/node_modules/parse-headers/node_modules/for-each/node_modules/is-function',function(b,d,e,f){function c(b){var c=a.call(b);return c==='[object Function]'||typeof b==='function'&&c!=='[object RegExp]'||typeof window!=='undefined'&&(b===window.setTimeout||b===window.alert||b===window.confirm||b===window.prompt)}b.exports=c;var a=Object.prototype.toString}),a.define('raf',function(m,p,o,n){var l=a('raf/node_modules/performance-now/lib/performance-now'),b=typeof window==='undefined'?{}:window,g=['moz','webkit'],d='AnimationFrame',e=b['request'+d],h=b['cancel'+d]||b['cancelRequest'+d];for(var f=0;f<g.length&&!e;f++)e=b[g[f]+'Request'+d],h=b[g[f]+'Cancel'+d]||b[g[f]+'CancelRequest'+d];if(!(e&&h)){var i=0,j=0,c=[],k=16.666666666666668;e=function(d){if(c.length===0){var a=l(),b=Math.max(0,k-(a-i));i=b+a,setTimeout(function(){var b=c.slice(0);c.length=0;for(var a=0;a<b.length;a++)if(!b[a].cancelled)try{b[a].callback(i)}catch(a){setTimeout(function(){throw a},0)}},Math.round(b))}return c.push({handle:++j,callback:d,cancelled:!1}),j},h=function(b){for(var a=0;a<c.length;a++)c[a].handle===b&&(c[a].cancelled=!0)}}m.exports=function(a){return e.call(b,a)},m.exports.cancel=function(){h.apply(b,arguments)}}),a.define('raf/node_modules/performance-now/lib/performance-now',function(a,c,d,e){(function(){var d,e,c;typeof performance!=='undefined'&&performance!==null&&performance.now?a.exports=function(){return performance.now()}:b!==void 0&&b!==null&&b.hrtime?(a.exports=function(){return(d()-c)/1e6},e=b.hrtime,d=function(){var a;return a=e(),a[0]*1e9+a[1]},c=d()):Date.now?(a.exports=function(){return Date.now()-c},c=Date.now()):(a.exports=function(){return new Date().getTime()-c},c=new Date().getTime())}.call(this))}),a.define('./utils/log',function(b,c,d,e){var a;a=function(){return a.DEBUG?console.log.apply(console,arguments):void 0},a.DEBUG=!1,a.debug=a,a.info=function(){return console.log.apply(console,arguments)},a.warn=function(){return console.log('WARN:'),console.log.apply(console,arguments)},a.error=function(){throw console.log('ERROR:'),console.log.apply(console,arguments),new arguments[0]},b.exports=a}),a.define('./utils/mediator',function(d,e,f,g){var b,c;c=a('./utils/shim').riot,b={},c.observable(b),d.exports=b}),a.define('./data/source',function(a,b,c,d){}),a.define('./view',function(b,c,d,e){b.exports={form:a('./view/form'),View:a('./view/view')}}),a.define('./view/form',function(t,w,v,u){var b,s,g,o,p,r,m,i,d,k,q,c,l,f,j,e,h=function(a,b){function d(){this.constructor=a}for(var c in b)n.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},n={}.hasOwnProperty;d=a('underscore/underscore'),b=a('./events'),e=a('./utils'),q=e.log,l=e.shim.riot,c=e.shim.promise,i=a('./view/view'),f=function(i){var a,b,f,g,d,c,e,h;for(e=i.split(' '),a={},b=0,g=e.length;b<g;b++)c=e[b],c.indexOf(':')>=0?(d=c.split(':'),f=d[0],h=d[1],a[f]=h):a[c]=!0;return a},p=function(){function a(d,b,c,a){this.name=d,this['default']=b!=null?b:'',this.placeholder=c!=null?c:'',a==null&&(a=''),this.hints=f(a)}return a.prototype.name='',a.prototype['default']='',a.prototype.placeholder='',a.prototype.hints=null,a}(),g=function(){function a(a,b,c){this.tag=a,this.model=b,this.validator=c}return a.prototype.tag='',a.prototype.model={},a.prototype.validator=function(){},a.prototype.obs=null,a}(),m=function(){function a(a,b){this.predicate=a,this.validatorFn=b}return a}(),o=function(){function a(a,b){this.predicate=a,this.tagName=b}return a}(),k={tagLookup:[],validatorLookup:[],defaultTagName:'form-input',errorTag:'form-error',registerValidator:function(b,a){return d.isFunction(a)?this.validatorLookup.push(new m(b,a)):void 0},registerTag:function(a,b){return this.tagLookup.push(new o(a,b))},deleteTag:function(g){var a,c,e,f,d,b;for(d=this.tagLookup,b=[],a=c=0,e=d.length;c<e;a=++c)f=d[a],f.tagName===g?b.push(this.tagLookup[a]=null):b.push(void 0);return b},deleteValidator:function(h,g){var a,c,e,f,d,b;for(d=this.validatorLookup,b=[],a=c=0,e=d.length;c<e;a=++c)f=d[a],f.validatorFn===g?b.push(this.validatorLookup[a]=null):b.push(void 0);return b},render:function(f){var h,a,b,d,e,i,j;for(d={},h=function(a){return function(j,b){var k,i,p,o,e,h,q,l,m,n,r,f;for(l=a.validatorLookup,i=0,p=l.length;i<p;i++)e=l[i],e.predicate(b)&&(f=e.validatorFn,function(a){return j.push(function(d){var e,f,g;return e=d[0],f=d[1],g=c['new'](function(a,b){return a(d)}),g.then(function(c){return a.call(b,c[0],c[1])}).then(function(a){return e[f]=a,c['new'](function(a,b){return a(d)})})})}(f));for(j.push(function(a){var b,d;return b=a[0],d=a[1],c['new'](function(a,c){return a(b[d])})}),r=function(e,g){var d,a,b;for(b=c['new'](function(a,b){return a([e,g])}),a=0,d=j.length;a<d;a++)f=j[a],b=b.then(f);return b},k=!1,m=a.tagLookup,h=0,o=m.length;h<o;h++){if(e=m[h],e==null)continue;if(e.predicate(b)){n=e.tagName,k=!0;break}}return k||(n=a.defaultTagName),q={name:b.name,value:b['default'],placeholder:b.placeholder,cfg:b},d[b.name]=new g(n,q,r)}}(this),a=e=0,i=f.length;e<i;a=++e){if(b=f[a],b==null)continue;j=[],h(j,b)}return d}},b.Input={Result:'input-result',Get:'input-get',Set:'input-set',Change:'input-change',Error:'input-error',ClearError:'input-clear-error'},r=function(d,c){function a(){return a.__super__.constructor.apply(this,arguments)}return h(a,d),a.prototype.getValue=function(a){return a.value},a.prototype.errorHtml='<div class="error-container" if="{ hasError() }">\n  <div class="error-message">{ error }</div>\n</div>',a.prototype.init=function(){return this.html+=this.errorHtml},a.prototype.events=(c={},c[''+b.Input.Set]=function(a,b){return a===this.model.name?(this.clearError(),this.model.value=b,this.update()):void 0},c[''+b.Input.Error]=function(a,b){return a===this.model.name?(this.setError(b),this.update()):void 0},c[''+b.Input.ClearError]=function(a){return a===this.model.name?(this.clearError(),this.update()):void 0},c),a.prototype.change=function(c){var a;return a=this.getValue(c.target),a!==this.model.value&&this.obs.trigger(b.Input.Change,this.model.name,a),this.model.value=a},a.prototype.hasError=function(){var a;return a=this.error,a!=null&&a.length!=null&&a.length>0},a.prototype.setError=function(a){return this.error=a},a.prototype.clearError=function(){return this.setError(null)},a.prototype.js=function(a){return this.model=a.input.model},a}(i),l.tag('control','',function(b){var a;return a=b.input,a!=null?(b.obs=a.obs,l.mount(this.root,a.tag,b)):void 0}),b.Form={SubmitSuccess:'form-submit-success',SubmitFailed:'form-submit-failed'},s=function(f,e){function a(){return a.__super__.constructor.apply(this,arguments)}return h(a,f),a.prototype.inputConfigs=null,a.prototype.events=(e={},e[''+b.Input.Get]=function(a){return this.obs.trigger(b.Input.Result,this._get(this.model,a))},e[''+b.Input.Change]=function(a,g){var c,e,f,d;return this.fullyValidated=!1,d=this._set(this.model,a,g),f=d[0],e=d[1],c=this.inputs[a],c!=null?c.validator(f,e).then(function(c){return function(d){return c.obs.trigger(b.Input.Set,a,d)}}(this))['catch'](function(c){return function(d){return q('Validation error has occured',d.stack),c.obs.trigger(b.Input.Error,a,d.message)}}(this)):void 0},e),a.prototype._submit=function(a){},a.prototype.submit=function(d){var i,j,k,a,e,f,g,h;if(d.preventDefault(),this.fullyValidated){this._submit(d);return}e=[],f=[],g=this.inputs;for(a in g)i=g[a],e.push(a),h=this._find(this.model,a),k=h[0],j=h[1],f.push(i.validator(k,j));return c.settle(f).done(function(a){return function(i){var c,f,j,g,h;for(g=!1,c=f=0,j=i.length;f<j;c=++f)h=i[c],h.isRejected()&&(g=!0,a.obs.trigger(b.Input.Error,e[c],h.reason().message));if(g){a.obs.trigger(b.Form.SubmitFailed,a.model);return}return a.fullyValidated=!0,a.obs.trigger(b.Form.SubmitSuccess,a.model),a._submit(d)}}(this))},a.prototype._get=function(e,f){var a,b,g,d,c;if(c=f.split('.'),c.length===1)return e[f];for(a=e,b=0,g=c.length;b<g;b++){if(d=c[b],a[d]==null)return void 0;a=a[d]}return a[lastName]},a.prototype._set=function(d,e,f){var a,b,c;return c=this._find(d,e),a=c[0],b=c[1],a[b]=f,[a,b]},a.prototype._find=function(f,g){var a,e,h,i,b,c;if(c=g.split('.'),c.length===1)return[f,g];for(h=c.pop(),a=f,e=0,i=c.length;e<i;e++){if(b=c[e],a[b]!=null){a=a[b];continue}d.isNumber(b)?a[b]=[]:a[b]={},a=a[b]}return[a,h]},a.prototype.js=function(){return this.initFormGroup()},a.prototype.initFormGroup=function(){var b,a,c;if(this.inputConfigs!=null){this.inputs==null?this.inputs=a=k.render(this.inputConfigs):a=this.inputs;for(c in a)b=a[c],b.obs=this.obs;return this.fullyValidated=!1,j(this.model,function(b,c){return a[b]!=null?a[b].model.value=c:void 0})}},a}(i),j=function(a,f,b){var c,e,g;if(b==null&&(b=''),d.isArray(a)||d.isObject(a)){e=[];for(c in a)g=a[c],e.push(j(g,f,b===''?c:b+'.'+c));return e}else return f(b,a)},t.exports={helpers:k,FormView:s,InputView:r,Input:g,InputConfig:p,tokenize:f}}),a.define('./events',function(a,b,c,d){a.exports={}}),a.define('./view/view',function(f,g,h,i){var d,b,e,c;b=a('underscore/underscore'),c=a('./utils'),e=c.shim.riot,d=function(){function a(){var d,f,h,g;f=Object.getPrototypeOf(this),d=f,h={};while(d!==a.prototype)d=Object.getPrototypeOf(d),f.events=b.extend({},d.events||{},f.events),b.extend(h,d||{},f);b.extend(f,h),g=this,this.init(),e.tag(this.tag,this.html,this.css,this.attrs,function(d){var m,l,a,h,f,k,j,i,e;k=Object.getPrototypeOf(d);for(a in d)e=d[a],k[a]!=null&&e==null&&(d[a]=k[a]);if(g!=null){j=Object.getPrototypeOf(g);for(a in j)e=j[a],b.isFunction(e)?function(b){return function(c){var d;return b[a]!=null?(d=b[a],b[a]=function(){return d.apply(b,arguments),c.apply(b,arguments)}):b[a]=function(){return c.apply(b,arguments)}}}(this)(e):this[a]=e}if(this.model=d.model||this.model,this.model==null&&(this.model={}),f=this.obs=d.obs,this.obs==null&&(f=this.obs={},c.shim.observable(f)),g.events!=null){i=g.events,m=function(a){return function(b,c){return f.on(b,function(){return c.apply(a,arguments)})}}(this);for(h in i)l=i[h],m(h,l)}return this.js?this.js(d):void 0})}return a.register=function(){return new this},a.prototype.tag='',a.prototype.html='',a.prototype.css='',a.prototype.attrs='',a.prototype.events=null,a.prototype.mixins=null,a.prototype.model=null,a.prototype.js=function(){},a.prototype.init=function(){},a}(),f.exports=d}),a.define('./config',function(a,b,c,d){a.exports={}}),a.define('./index',function(b,d,e,f){var c;c=a('underscore/underscore'),b.exports={data:a('./data'),utils:a('./utils'),view:a('./view'),config:a('./config'),start:function(a){return this.utils.shim.riot.mount('*')},Events:a('./events')},typeof window!=='undefined'&&window!==null&&(window.crowdcontrol=b.exports)}),a('./index')}.call(this,this))